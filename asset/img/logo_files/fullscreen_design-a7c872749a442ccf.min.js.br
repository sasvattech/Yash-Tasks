"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="c0a1f735-e1b8-56c9-b285-4cd823a83629")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[1085],{444576:(e,t,n)=>{n.d(t,{A7:()=>i,i4:()=>l,nt:()=>r});var a=n(302245),o=n(333370);let r=e=>e.library.localStyleSelection,l=(0,a.Mz)([r,(e,t)=>t],(e,t)=>e?.type===t?e:null),i=(0,a.Mz)([l,(e,t,n)=>n],(e,t)=>{if(!e)return null;let n=new Set,a=new Set;return e.folderNames.forEach(e=>{let r=t.find(t=>"STYLE_FOLDER"===t.type&&t.name===e);r&&((0,o.KU)(r).forEach(e=>{n.add(e.name)}),(0,o.dm)(r).forEach(e=>{a.add(e.node_id)}))}),{type:e.type,folderNames:n,styleIds:a}})},329159:(e,t,n)=>{let a;n.r(t),n.d(t,{DesignView:()=>mI});var o=n(411855),r=n(188507),l=n(786013),i=n(922827),s=n(966712),c=n(192437),d=n(392592),p=n(103716),m=n(818194),u=n(686046),E=n(862350),y=n(870265),_=n(288006),g=n(222903),h=n(181912),f=n(374626),v=n(915440),b=n(860601),S=n(154254),T=n(939863),N=n(393812),I=n(461837),P=n(256975),C=n(891869),A=n(136405),k=n(21584),w=n(88918),O=n(750293),x=n(349410),D=n(101505),R=n(672517),M=n(251960),L=n(456104),V=n(683694),K=n(723239),U=n(29680),F=n(335682),B=n(161325),G=n(279453),z=n(601607),Y=n(397065),W=n(147829),H=n(699857),$=n(463546),X=n(618247);let Q=(0,R.tf)(u.N);function J(){let e=(0,x.Ps)(),t=(0,F.tS)(),n=(0,N.BI)(),a=function(){let e;let t=(0,z.hr)(e=>e).getRoot(),n=t=>{for(let a of t.childrenNodes)(a.isTopLevelFrame()||"CANVAS"===a.type)&&(a.hasReadyStatus?e?e.getStatusInfo().lastUpdateUnixTimestamp<a.getStatusInfo().lastUpdateUnixTimestamp&&(e=a):e=a:("SECTION"===a.type||"CANVAS"===a.type)&&n(a))};return n(t),e?.getStatusInfo()}(),r=(0,B.wW)(a?.userId??null),l=!!a&&h.A.unix(a.lastUpdateUnixTimestamp).isAfter((0,h.A)().subtract(60,"day")),i=(0,H.U)("upsell"),c=v.Rs(G.HdA,{key:t??""},{enabled:!!t})?.data?.file?.hasPermission,d=(0,f.md)(V.LZ),p=(0,U.aV)(),u=(0,P._I)(),J=(0,P.U4)(),j=(0,f.md)(K.NT),q=(0,k.J)(),{show:Z,complete:ee,isShowing:et,uniqueId:en}=(0,L.e)({overlay:$.koo,priority:Y.N.OVERRIDING_MODAL,experiment:{check:e,predicate:e=>e,postCheck:()=>!0}},[j]);(0,o.useEffect)(()=>{Z({canShow:e=>("developer"===e||"software-development"===e)&&q&&d&&!u&&"loaded"===n.status&&!n.hasPendingRequest&&l&&J&&!p})},[Z,u,J,d,p,j,q,n,l]),(0,M.E)(en,"Enter Inspect Mode",()=>{et&&ee()});let ea=(0,w.BC)({dismissModal:ee,onRequestAccess:()=>{c&&i("handoff")}}),eo=o.useCallback(()=>{ee(),ea.hidden||ea.onClick(O.i$.Upsell)},[ee,ea]),er=o.createElement(Q,{newTab:!0,trusted:!0,trackingProperties:{trackingDescriptor:D.c.READ_THE_GUIDE},href:m.z},(0,T.tx)("dev_mode.onboarding_callout.read_the_guide")),el=o.createElement(o.Fragment,null,o.createElement("span",{className:X.XQ},o.createElement(g.O,null)),o.createElement("span",{className:S.cx.textBodyMediumStrong.$},(0,T.tx)("dev_handoff.status.mark_status_sentence_part.ready_for_dev"))),ei=o.createElement(o.Fragment,null,o.createElement("div",{className:X.DD},(0,T.tx)("dev_handoff.paywall.blocking_modal.title.dev_onboarding")),o.createElement("ul",null,o.createElement("li",{className:X.N$},(0,T.tx)("dev_handoff.paywall.blocking_modal.content.copy_code")),o.createElement("li",{className:X.N$},(0,T.tx)("dev_handoff.paywall.blocking_modal.content.track_design_changes")),o.createElement("li",{className:X.N$},(0,T.tx)("dev_handoff.paywall.blocking_modal.content.customize_plugins"))),o.createElement("div",{className:X.jg},c?(0,T.tx)("dev_handoff.paywall.blocking_modal.content.explore_for_free_with_link",{learnMoreLink:er}):(0,T.tx)("dev_handoff.paywall.blocking_modal.content.curious_to_learn_more",{learnMoreLink:er}))),es=(0,C.W)(),ec=E.hS({open:!0,onClose:b.lQ,preventUserClose:!0,recordingKey:"dev-mode-paywall-modal"});return o.createElement(W.M,{testId:"rfd-upsell-upsell",isShowing:et},o.createElement("div",{"data-editor-theme":"dev-handoff"},o.createElement(I.OM,null),o.createElement(R.fu,{name:"RFD Upsell Modal",properties:es,enabled:es?.gracePeriod!==void 0},o.createElement(y.bL,{width:392,manager:ec},o.createElement(_.vo,null,o.createElement("div",{className:X.XV},r.loading?"":(0,T.tx)("dev_handoff.upsell.user_marked_a design",{userName:r.user?.name||r.user?.handle,status:el})),o.createElement(_.nB,null,o.createElement(A.E,{imgSrc:(0,s.ck)("6d5e9cb0e9ec7fd5dd58425c5527dc8a78143a19"),content:ei,modalType:"RFD Upsell Modal",primaryButtonLabel:(0,T.tx)("dev_handoff.paywall.blocking_modal.button.request_access"),primaryButtonType:"request_access",primaryButtonOnClick:ea.hidden?void 0:eo,secondaryButtonLabel:(0,T.tx)("dev_handoff.paywall.blocking_modal.button.not_now"),secondaryButtonType:"not_now",secondaryButtonOnClick:ee})))))))}var j=n(964881),q=n(632430),Z=n(285381),ee=n(843495),et=n(441088),en=n(737499),ea=n(698993),eo=n(170960),er=n(100197),el=n(338400),ei=n(695431),es=n(402609),ec=n(720750),ed=n(293017),ep=n(931828),em=n(226055),eu=n(696673),eE=n(309798),ey=n(833629),e_=n(740280),eg=n(864114),eh=n(756159),ef=n(974342);function ev(){let e=(0,em.GS)(),{isShowing:t,complete:n,show:a}=(0,L.e)({overlay:$.N5c,priority:Y.N.SECONDARY_MODAL}),l=(0,r.wA)(),s=(0,U.aV)(),c=!!(0,eE.f)("ui_kits_intro_tooltip"),d=!!(0,eE.f)("seen_explore_ui_kits_blue_tooltip"),{hasAnyUiKit:p}=(0,eu.I7)(),m=(0,f.md)(eh.Cl),u=(0,ey.jO)(),E=(0,ef.t)(),y=F.q5()?.canEdit,_=(0,r.d4)(e=>e.leftPanel.activeTab===i.xae.LAYERS);return(o.useEffect(()=>{!y||!p||m||c||d||!u||s||E||!_||t||a()},[a,y,p,c,d,u,s,E,t,m,_]),o.useEffect(()=>{!_&&t&&n()},[_,t,n]),t)?o.createElement(e_.X,{isShowing:t,title:(0,T.tx)("rcs.ui_kits.jump_start_your_designs_with_ui_kits"),description:(0,T.tx)("rcs.ui_kits.grab_pre_built_ui",{strongAssets:o.createElement("strong",{style:{display:"contents"}},(0,T.tx)("design_systems.assets_panel.assets"))}),primaryCta:{label:(0,T.tx)("rcs.presets_baseline.try_it"),type:"button",onClick:()=>{l(ed.FP({tab:i.xae.ASSETS})),n()},ctaTrackingDescriptor:D.c.PRESETS_TRY_IT},position:e?eg.Q.UI3_EDITOR_TOP_LEFT:eg.Q.EDITOR_TOP_LEFT,trackingContextName:"UI Kits Intro Tooltip",userFlagOnShow:"ui_kits_intro_tooltip",onClose:()=>{l(ep.b({seen_explore_ui_kits_blue_tooltip:!0})),n()}}):null}var eb=n(129318),eS=n(582947),eT=n(106757),eN=n(860178),eI=n(788256),eP=n(601538),eC=n(629019),eA=n.n(eC),ek=n(776250),ew=n(320063),eO=n(646240),ex=n(752553),eD=n(864089),eR=n(799569),eM=n(135876),eL=n(47506),eV=n(340159),eK=n(777078),eU=n(373119),eF=n(106112),eB=n(187882),eG=n(545317),ez=n(239177),eY=n(666456);let eW="starting_points_templates_modal--templateOption--qYXkm",eH="starting_points_templates_modal--templateOptionTitle--DmVPR",e$="starting_points_templates_modal--verticalTemplateImage--kAzQz";var eX=n(630834),eQ=(e=>(e.DESKTOP="desktop",e.MOBILE="mobile",e.WEBSITE="website",e))(eQ||{});let eJ={x:0,y:0},ej={website:{x:0,y:1600},mobile:{x:0,y:300},desktop:{x:0,y:300}},eq={website:.1,mobile:.225,desktop:.1},eZ=e=>{let t=(0,s.Ay)().starting_points;switch(e){case"basics":return t?.figma_basics_hub_file_id;case"desktop":return t?.desktop_templates_hub_file_id;case"mobile":return t?.mobile_templates_hub_file_id;case"website":return t?.website_templates_hub_file_id}};function e0({onClose:e}){let t=(0,r.wA)(),n=o.useRef(null),[a,l]=o.useState(!1),[c,d]=o.useState(!1),[p,m]=o.useState(!1),[u,E]=o.useState(!1),[y,_]=o.useState(window.innerWidth),g=(0,eU.q)(),h=(0,F.tS)(),v=(0,r.d4)(e=>e.fileVersion),b=(0,r.d4)(e=>e.mirror.sceneGraph),S=g&&(0,eI.Qf)(b),N=!!S&&0===S.childrenGuids.length,[I]=(0,ex.IT)((0,eV.tH)({})),P=!!(0,s.kc)().starting_points_ghost_previews,{insertTemplate:C}=(0,eK.Fz)(),A=(0,ez.g)(),k=(0,eO.Xr)(eY.Yq),w=(0,eO.Xr)(eY.bj),[O,x]=o.useState(!1),M=(0,eB.GQ)(),L=(0,eG.P)();(0,ew.h)(()=>{let e=()=>{_(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),o.useEffect(()=>{E(M+50>y/2-257||y-L-50<y/2+257),m(M+50>y/2-365||y-L-50<y/2+365)},[M,L,y]);let V=o.useCallback(()=>{if(!P||"loaded"!==I.status||!I.data)return;let e=[];for(let t of Object.values(eQ)){let n=eZ(t);if(!n)return;let a=I.data[n];if(!a)return;let o={type:eF.n.HubFile,template:a};e.push(o)}Promise.all(e.map(e=>f.zl.get((0,eY.Re)({fileKey:h,fileVersion:v,template:e})))).then(()=>{x(!0)}).catch(e=>{console.error("Failed to load template buffers",e),x(!0)})},[h,v,I,P]);if(o.useEffect(()=>{"loaded"!==I.status||O||V()},[I,O,V]),o.useEffect(()=>{g&&S&&!N&&!c&&e()},[g,S,N,c,e]),!(0,s.kc)().starting_points_modal)return null;let K=async n=>{if("loaded"!==I.status)return;l(!0);let a=eZ(n);if(!a)return;let o=I.data[a];o&&(P&&"basics"!==n?await (0,eK.Zg)({insert:()=>w({selectTemplateAfterCommit:!1,moveViewportAfterCommit:!1,priority:"user-visible",editScopeType:i.zkO.USER}),template:{template:o,type:eF.n.HubFile},fileKey:h,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1}):await C({template:{template:o,type:eF.n.HubFile},userTriggered:!1,editScopeType:i.zkO.ONBOARDING,triggeredFrom:"starting-points",templateInsertionDirection:i.hKj.RIGHT}),"basics"===n?(0,eL.YQ)({id:"starting_points_basics_template_inserted"}):(0,eL.YQ)({id:"starting_points_template_inserted"}),e(),l(!1))},U=o.createElement(R.$z,{onClick:()=>K("basics"),trackingProperties:{trackingDescriptor:D.c.LEARN_THE_BASICS}},(0,T.tx)("starting_points.learn_the_basics")),B=e=>{if((0,ek.sx)("Starting Points Template Option Hover",{template:e}),!P)return;let n=eZ(e);if(!n||!I.data)return;let a=I.data[n];if(!a)return;let o={type:eF.n.HubFile,template:a},r=eq[e];window.innerWidth>1700&&(r*=1.5),(0,eK.Zg)({insert:()=>A(o,{moveViewportAfterPreview:!0,priority:"user-visible",previewManager:{nodeType:i.Z6A.CANVAS},position:eJ,viewportOptions:{position:ej[e],scale:r,duration:0}}),template:o,fileKey:h,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1,isPreview:!0})},G=()=>{P&&k()};return o.createElement(R.fu,{name:"Starting Points Modal"},o.createElement("div",{className:"starting_points_templates_modal--startingPointsTemplatesModalPositioner--R8g3u"},o.createElement(eM.x,{isLoading:a,className:"starting_points_templates_modal--loadingSpinner--UOrjg"},()=>o.createElement("div",{className:eA()({"starting_points_templates_modal--startingPointsTemplatesModal--dUQte":!0,"starting_points_templates_modal--isHidden--jVN1L":u,"starting_points_templates_modal--isCondensedView--3tVz6":p}),onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),ref:n},o.createElement("div",{className:"starting_points_templates_modal--modalInstructions--ZtdTL"},o.createElement("div",{className:"starting_points_templates_modal--modalTitle--HT3eZ"},(0,T.t)("starting_points.what_do_you_want_to_make_today")),o.createElement("div",{className:"starting_points_templates_modal--modalLearnMore--g-GWo"},(0,T.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:U}))),o.createElement("div",{className:"starting_points_templates_modal--optionContainer--mYEsG"},o.createElement(R.$z,{className:eW,onClick:()=>K("website"),onMouseEnter:()=>B("website"),onMouseLeave:G,trackingProperties:{trackingDescriptor:D.c.WEBSITE_TEMPLATES}},o.createElement("div",{className:eH},(0,T.t)("starting_points.website")),o.createElement(eD.oW,{className:e$,src:(0,s.ck)("9b8475fdab7c1ed3cd1c0d16b957d65a80840b74"),alt:"Website template"})),o.createElement(R.$z,{className:eW,onClick:()=>K("mobile"),onMouseEnter:()=>B("mobile"),onMouseLeave:G,trackingProperties:{trackingDescriptor:D.c.MOBILE_APP_TEMPLATES}},o.createElement("div",{className:eH},(0,T.t)("starting_points.mobile_app")),o.createElement(eD.oW,{className:e$,src:(0,s.ck)("b262e57bed515b9f0da45ae54fa43824d9704c14"),alt:"Mobile app template"})),o.createElement(R.$z,{className:eW,onClick:()=>K("desktop"),onMouseEnter:()=>B("desktop"),onMouseLeave:G,trackingProperties:{trackingDescriptor:D.c.DESKTOP_APP_TEMPLATES}},o.createElement("div",{className:eH},(0,T.t)("starting_points.desktop_app")),o.createElement(eD.oW,{className:"starting_points_templates_modal--desktopTemplateImage--3kplg",src:(0,s.ck)("cb2f715253dacb4e7d3fb211ff2792fc28a38832"),alt:"Desktop app template"}))),o.createElement("div",{className:"starting_points_templates_modal--modalLearnMoreFooter--pSvfX"},(0,T.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:U})),o.createElement(eR.Jn,{className:"starting_points_templates_modal--closeButton--io-14",onClick:e,innerText:"close",svg:eX.default})))))}let e1=(0,eS.r1)("dismissed_starting_points_templates_modal");function e2(){let e=(0,r.wA)(),t=!!(0,s.kc)().starting_points_modal,n=(0,x.GM)(),a=(0,eb.QL)(eP.E_.key)===eP.E_.value,l=(0,U.aV)(),i=(0,r.d4)(e=>e.mirror.sceneGraph),c=!eI.Qf(i)?.childrenNodes?.length,d=(0,F.q5)(),p=(0,eN.TA)(),m=d?.creatorId===p,u=(0,f.md)(K.Fy),E=(0,f.md)(eT.UQ),y=!(0,eE.f)("not_gen_0"),_=(0,em.GS)(),g=(0,f.md)(e1),h=(0,s.Ay)().starting_points,{show:v,isShowing:b,complete:S}=(0,L.e)({overlay:$.EYw,priority:Y.N.OVERRIDING_MODAL+1,experiment:{check:n,predicate:e=>e,postCheck:(e,t)=>!t}},[u,g]);return(o.useEffect(()=>{t&&m&&!l&&c&&!b&&(a?v():y&&E&&_&&h&&v({canShow:e=>!e}))},[t,m,l,c,b,a,y,E,_,h,v]),b)?o.createElement(e0,{onClose:()=>{g.data||e(ep.b({dismissed_starting_points_templates_modal:!0})),S()}}):null}var e4=n(612776),e8=n(835691),e3=n(612803),e5=n(276868),e7=n(791730),e6=n(276377);function e9(){let{isShowing:e,complete:t,show:n,uniqueId:a}=(0,L.e)({overlay:$.l_p,priority:Y.N.SECONDARY_MODAL}),l=(0,r.wA)(),s=(0,U.aV)(),c=(0,F.q5)(),d=(0,eN.iZ)(),p=(0,e4.te)(),m=!!(0,eE.f)(e5.bo),u="ui3_onboarding_was_shown_in_current_session"===(0,e8.zl)(e3.U).currentState,E="no_figma_basics_onboarding_was_shown_in_current_session"===(0,e8.zl)(e7.j).currentState,y=(0,f.md)(eh.Cl),_=(0,ey.jO)(),g=c?.canEdit,h=(0,r.d4)(e=>e.leftPanel.activeTab===i.xae.LAYERS);if((0,M.E)(a,["Reset Visual Assets Tooltips",e5.io],()=>{d&&c&&l(ep.b(e6.g))}),(0,o.useEffect)(()=>{!p()||!g||y||m||u||E||!_||s||!h||e||n()},[n,p,g,m,_,s,u,E,e,y,h]),(0,o.useEffect)(()=>{!h&&e&&t()},[h,e,t]),!e)return null;let v=o.createElement("strong",{style:{display:"contents"}},(0,T.tx)("design_systems.assets_panel.assets"));return o.createElement(e_.X,{isShowing:e,title:(0,T.tx)("rcs.visual_assets.elevate_your_designs"),description:(0,T.tx)("rcs.visual_assets.grab_visual_assets",{strongAssets:v}),primaryCta:{label:(0,T.tx)("rcs.presets_baseline.try_it"),type:"button",onClick:()=>{l(ed.FP({tab:i.xae.ASSETS})),t()},ctaTrackingDescriptor:D.c.PRESETS_TRY_IT},trackingContextName:"Visual Assets Intro Tooltip",userFlagOnShow:e5.bo,position:eg.Q.UI3_EDITOR_TOP_LEFT,onClose:t})}var te=n(298455),tt=n(394828),tn=n(340514),ta=n(353166),to=n(433195);let tr=(0,eS.r1)(to.WX),tl=(0,eS.r1)(to.b6),ti=!1;function ts(){let e=(0,r.wA)(),t=(0,f.md)(V.wg),n=(0,U.aV)(),a=(0,f.md)(K.mp),l=(0,P._I)(),i=(0,em.GS)(),c=(0,f.md)(tl),d=(0,f.md)(tr),{uniqueId:p,show:m,complete:u,isShowing:E}=(0,L.e)({overlay:$.kc4,priority:Y.N.SECONDARY_MODAL},[d,c,a]),y=(0,H.U)("modal"),_=o.useCallback(()=>{!n&&!ti&&t&&l&&(0!==(te.UN().getCurrentPage()?.childrenGuids.length||0)&&m({canShow:(e,t,n)=>!e&&!t&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),ti=!0)},[m,l,t,n]);function g(){e(ep.b({[to.WX]:!0})),u()}o.useEffect(()=>{i||_()},[_,i]),(0,M.E)(p,(0,ta.w)("design"),()=>{_()}),o.useEffect(()=>{"loaded"===d.status&&d.data&&u()},[d,u]),(0,M.E)(p,"Enter Inspect Mode",()=>{E&&g()});let h=(0,em.GS)()?eP.ON:eP.JN;return o.createElement(tn.rq,{isShowing:E,trackingContextName:to.WX,onClose:g,targetKey:h,title:(0,T.tx)("dev_handoff.annotations_introduction_overlay.title"),media:o.createElement(tt.y,{src:(0,s.ck)("5b9addc96424c11577a1ec91e1bbadcd786fe343"),alt:(0,T.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,T.tx)("dev_handoff.annotations_introduction_overlay.description"),primaryCta:{label:(0,T.tx)("dev_handoff.annotations_introduction_overlay.primary_cta"),type:"button",onClick:function(){y("handoff")},ctaTrackingDescriptor:D.c.SHOW_ME}})}var tc=n(502665);let td=(0,eS.r1)(to.b6),tp=(0,eS.r1)(to.WX),tm=!1,tu=!1;function tE(){let e=(0,r.wA)(),t=(0,U.aV)(),n=(0,f.md)(K.mp),a=(0,f.md)(tc.N),l=(0,er.J2)(i.Ez5.annotationObserver().annotationInfoByTlf),c=f.md(F.yV)?.creatorId,d=(0,f.md)(td),p=(0,f.md)(tp),{uniqueId:m,show:u,complete:E,isShowing:y}=(0,L.e)({overlay:$.kc4,priority:Y.N.SECONDARY_MODAL},[d,p,n,a]),_=(0,H.U)("modal"),g=l.size>0;function h(){e(ep.b({[to.b6]:!0})),E()}o.useEffect(()=>{t&&(tu=!0),!t&&!tm&&tu&&g&&(u({canShow:(e,t,n,a)=>!e&&!t&&c!==a&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),tm=!0)},[g,t,c,u]),o.useEffect(()=>{"loaded"===d.status&&d.data&&E()},[d,E]),(0,M.E)(m,"Enter Inspect Mode",()=>{y&&h()});let v=(0,em.GS)()?eP.ON:eP.JN;return o.createElement(tn.rq,{isShowing:y,trackingContextName:to.b6,onClose:h,targetKey:v,title:(0,T.tx)("dev_handoff.annotations_upsell_overlay.title"),media:o.createElement(tt.y,{src:(0,s.ck)("e84a2faeb510847abd7bfb9c15a74ef974bb4c13"),alt:(0,T.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,T.tx)("dev_handoff.annotations_upsell_overlay.description"),primaryCta:{label:(0,T.tx)("dev_handoff.annotations_upsell_overlay.primary_cta"),type:"button",onClick:function(){_("handoff")},ctaTrackingDescriptor:D.c.OPEN_DEV_MODE},secondaryCta:{label:(0,T.tx)("dev_handoff.annotations_upsell_overlay.secondary_cta"),type:"button",onClick:E,ctaTrackingDescriptor:D.c.NOT_NOW}})}var ty=n(152811),t_=n(821910),tg=n(602628),th=n(269568),tf=n(395096),tv=n(91408),tb=n(189430),tS=n(572206),tT=n(343887),tN=n(974563),tI=n(256296),tP=n(139689),tC=n(263159);let tA=(0,o.memo)(function(e){return(0,tC.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,tC.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M10.003 7.375A5.5 5.5 0 0 1 16.61 9.5H14a.5.5 0 0 0 0 1h3.5a.5.5 0 0 0 .5-.5V6.5a.5.5 0 0 0-1 0v1.847a6.5 6.5 0 1 0-.128 8.456.5.5 0 1 0-.75-.662 5.5 5.5 0 1 1-6.119-8.766",clipRule:"evenodd"})})});var tk=n(755020),tw=n(631437),tO=n(73950),tx=n(163023),tD=n(371591),tR=n(934533),tM=n(215932),tL=n(38329);function tV(e,t,n){tL.D.dispatch(d.F.enqueue({message:e,type:n,icon:t,timeoutOverride:3e3}))}function tK(e){let t=(0,tO.r8)();if(!t||!e)return"";let n=t.getRuleById(e);return n?.name??""}var tU=n(828650);function tF(){let e=(0,f.md)(tM.m7);return(0,o.useMemo)(()=>(function(e){let t=(0,tO.r8)();if(!t)return{};let n={};for(let a of e.values())for(let e of a.values()){let a=t.getRuleById(e.ruleId);if(!a)continue;let o=JSON.stringify(e.detectionContext,Object.keys(e.detectionContext).sort()),r=`${a.id}-${o}`,l=n[r];l?l.push(e):n[r]=[e]}return n})(e),[e])}function tB(){let e=(0,f.md)(tM.m7);return(0,o.useMemo)(()=>Array.from(e.values()).reduce((e,t)=>e+t.size,0),[e])}function tG(){let e=(0,f.md)(tM.Xu);return(0,s.kc)().aip_flower_garden&&e}function tz(){let e=(0,eO.Xr)(tM.Bc);return{selectGroup:(0,o.useCallback)(t=>{e({view:tU.N.VIOLATIONS,selectedViolationGroup:t})},[e]),returnToGroupList:(0,o.useCallback)(()=>{e({view:tU.N.GROUPS,selectedViolationGroup:null})},[e])}}var tY=n(370903),tW=n(995382);function tH({shouldDisplay:e}){return e?o.createElement("div",{className:S.cx.p12.flex.justifyCenter.$},(0,T.tx)("design_linter.penalty_box.no_violations")):null}function t$(){return o.createElement("div",{onPointerUp:e=>e.stopPropagation(),role:"button"},o.createElement(tT.K,{onClick:()=>{i.Ez5?.uiState().showDesignLinter.set(!1)},"aria-label":(0,T.t)("general.close")},o.createElement(tP.A,null)))}function tX(){let e=(0,tO.r8)();return o.createElement("div",{onPointerUp:e=>e.stopPropagation(),role:"button"},o.createElement(tT.K,{onClick:()=>{e?.runDetectionOnMaybeSelectionOrPage()},"aria-label":(0,T.t)("design_linter.penalty_box.refresh_button_aria")},o.createElement(tA,null)))}function tQ(){let e=tB(),t=tG(),{isModalEnabled:n,toggleDesignLintModal:a}=function(){let[e,t]=(0,f.fp)(tM.Xu);return{isModalEnabled:e,toggleDesignLintModal:(0,o.useCallback)(()=>{t(e=>!e)},[t])}}();return o.createElement("div",{className:S.cx.p8.pl16.cursorDefault.selectNone.if(t,S.cx.pr0.wFull.pl8).if(!t,S.cx.bb1.colorBorder.bSolid).$},o.createElement("div",{className:S.cx.flex.flexRow.justifyBetween.itemsCenter.$},o.createElement("div",{className:S.cx.flex.textBodyMediumStrong.$},o.createElement("span",{className:S.cx.mr2.$},(0,T.tx)("design_linter.penalty_box.title")),o.createElement("span",null,e?`(${e})`:"")),o.createElement("div",{className:S.cx.flex.gap4.$},o.createElement(tN.d,{label:o.createElement(tI.J,null,""),checked:n,onChange:a}),o.createElement(tX,null),t?null:o.createElement(t$,null))),t?null:o.createElement(tJ,null))}function tJ(){let e=tG(),t=(0,f.md)(tM.fY),n=(0,te.UN)(),a=t[0]??"",r=1===t.length?n.get(a)?.name??"":(0,T.tx)("design_linter.penalty_box.multiple_targets");return o.createElement("div",{className:S.cx.flex.mt8.gap4.itemsCenter.if(e,S.cx.bb1.colorBorder.bSolid.p8.pl16.pt4).$},o.createElement(tD.Bf,{guid:a}),o.createElement("div",{className:S.cx.textBodyMedium.colorTextSecondary.truncate.$,"data-tooltip":r,"data-tooltip-type":"text"},r))}function tj({onNavigateBack:e,title:t}){let n=tG();return o.createElement("div",{className:S.cx.bb1.colorBorder.bSolid.$},o.createElement("div",{className:S.cx.p8.flex.itemsCenter.justifyBetween.$,onPointerUp:e,role:"button",tabIndex:0},o.createElement("div",{className:S.cx.flex.itemsCenter.$},o.createElement(tk.C,null),o.createElement("span",{className:S.cx.textBodyMediumStrong.$},t)),n?null:o.createElement(t$,null)))}function tq({onNext:e,onPrev:t,title:n,disabled:a}){let r=tG();return o.createElement("div",{className:S.cx.flex.flexRow.itemsCenter.p8.if(r,S.cx.flexRowReverse.justifyEnd.gap8).if(!r,S.cx.justifyBetween.pl16).$},o.createElement("div",{className:S.cx.flex.gap8.itemsCenter.$},o.createElement("div",null,n),o.createElement(tZ,null)),o.createElement("div",{className:S.cx.flex.flexRow.$},o.createElement(tT.K,{onClick:e=>{e.currentTarget.blur(),t()},disabled:a,"aria-label":(0,T.t)("general.previous")},o.createElement(tx.B,{svg:tW.A,style:r?{transform:"rotate(-90deg"}:{}})),o.createElement(tT.K,{onClick:t=>{t.currentTarget.blur(),e()},disabled:a,"aria-label":(0,T.t)("general.next")},o.createElement(tx.B,{svg:tY.A,style:r?{transform:"rotate(-90deg"}:{}}))))}function tZ(){let e=tF(),{selectedViolationGroup:t}=(0,f.md)(tM.Bc),n=(0,o.useCallback)(()=>{if(!i.Egt)return;let n=(t?e[t]??[]:[]).map(e=>e.guid);i.Egt.replaceSelection(n,!0)},[e,t]);return o.createElement("div",{onPointerUp:e=>e.stopPropagation(),role:"button"},o.createElement(tT.K,{onClick:n,"aria-label":(0,T.t)("design_linter.penalty_box.select_all_button_aria")},o.createElement(tw.A,null)))}var t0=n(342691),t1=n(340818),t2=n(568214),t4=n(694598),t8=n(886133),t3=n(83909),t5=n(356390),t7=n(334877),t6=n(750029),t9=n(83783);function ne(){let e=(0,F.q5)(),t=tB(),n=Object.entries(function(){let e=(0,f.md)(tM.m7);return(0,o.useMemo)(()=>{let t={};for(let n of e.values())for(let e of n.values()){let n=t[e.ruleId];n?n.push(e):t[e.ruleId]=[e]}return t},[e])}()).map(([e,t])=>({rule:e,count:t.length})),[a,r]=(0,o.useState)(0),l=(0,te.UN)().getCurrentPage();if((0,ew.h)(()=>{if(!l)return;let e=0;(0,t9.hV)(l,()=>{e++}),r(e)}),!l||!e)return null;let i=e._name??"File",s=l.name;return o.createElement("div",{className:S.cx.px16.mt4.$},o.createElement("span",{className:S.cx.textHeadingMedium.block.$},"Debug view"," "),o.createElement("span",{className:S.cx.textBodyMedium.block.$},`${i} - ${s}`," "),o.createElement("span",{className:S.cx.textBodyMedium.block.$},`Total layers: ${a}`," "),o.createElement("span",{className:S.cx.textBodyMedium.block.$},`Total violations: ${t}`," "),o.createElement("span",{className:S.cx.textHeadingSmall.block.pt8.$},"Violations per rule"),o.createElement("ol",null,n.map(({rule:e,count:t})=>o.createElement("span",{key:e,className:S.cx.textBodyMedium.block.$},`${e}: ${t}`))))}var nt=n(463033),nn=n(45623),na=n(493323),no=n(775664),nr=n(205135);let nl="design_linter_panel--chit--aOnAd paint_panels--chit--twQEy";function ni({violation:e,onGetFix:t,onFix:n}){let[a,r]=(0,o.useState)(void 0);return(0,o.useEffect)(()=>{(async()=>{try{if(e){r(void 0);let n=await t(e);r(n)}}catch(e){console.error("Error fetching fix: ",e)}})()},[e,t]),o.createElement("div",{className:S.cx.bb1.colorBorder.bSolid.$},o.createElement("div",{className:S.cx.pt8.pb8.$},o.createElement("div",{className:S.cx.flex.itemsCenter.h24.bRadius4.colorBgSecondary.p4.mx16.my4.$},o.createElement(nd,{violation:e})),o.createElement("div",{className:S.cx.flex.itemsCenter.h24.bRadius4.colorBgSecondary.p4.mx16.mt4.mb8.$},o.createElement(ns,{fix:a})),o.createElement("div",{className:S.cx.flex.justifyEnd.mr16.$},o.createElement(nt.$n,{variant:"primary",disabled:!a?.valid,onClick:()=>n(e)},(0,T.tx)("design_linter.penalty_box.fix")))))}function ns({fix:e}){if(!e)return o.createElement(nu,null);if(!e.valid||!e.fixContext)return o.createElement(nm,null);let{ruleId:t,guid:n,fixContext:a}=e,r=te.UN()?.get(n);return r&&t===t4.C.REQUIRE_COLOR_TOKENS?o.createElement(nc,{node:r,context:a}):null}function nc({node:e,context:t}){if(!("colorVar"in t))return null;let n=t.colorVar,a=e.resolveVariable(n.node_id);if(!a||a.resolvedType!==i.rXF.COLOR)return null;let r=a.value;return r?o.createElement(o.Fragment,null,o.createElement("div",{className:nl},o.createElement(t6.J,{color:r,opacity:1})),o.createElement("span",{className:S.cx.colorTextDisabled.ml4.$},n.name)):null}function nd({violation:e}){let{ruleId:t,detectionContext:n}=e;return t===t4.C.REQUIRE_COLOR_TOKENS?o.createElement(np,{context:n}):null}function np({context:e}){if(!e||!("color"in e))return null;let t=e.color;if(!t)return null;let n=(0,t2.tK)(t);return n?o.createElement(o.Fragment,null,o.createElement("div",{className:nl},o.createElement(t6.J,{color:n,opacity:1})),o.createElement(nr.AN,{disabled:!0,formatter:no.TI,property:n,onChange:b.lQ,noLeftBorder:!0})):null}function nm(){return o.createElement("div",{className:S.cx.flex.itemsCenter.$},o.createElement(nn.Z,null),o.createElement("div",null,(0,T.t)("design_linter.penalty_box.no_fix_available")))}function nu(){return o.createElement("div",{className:S.cx.flex.itemsCenter.$},o.createElement(na.kt,{className:S.cx.flex.ml2.mr8.$,size:"small",shouldMatchTextColor:!0}),(0,T.t)("design_linter.penalty_box.loading_fix"))}function nE(){return(0,s.kc)().aip_flower_garden?o.createElement(ny,null):null}function ny(){let e=(0,eO.Xr)(tM.Bc);return(0,ew.h)(()=>()=>{e({view:tU.N.GROUPS,selectedViolationGroup:null})}),o.createElement("div",{className:"design_linter_panel--displayContents--uRenD"},o.createElement("div",{className:S.cx.flex.flexColumn.wFull.hFull.overflowHidden.overflowYScroll.cursorDefault.$},o.createElement(n_,null),(0,s.kc)().aip_flower_garden_debug&&o.createElement(ne,null)))}function n_(){let e=(0,f.md)(tO.vo)===tO.td.DETECTING,t=tF(),n=(0,f.md)(tM.Bc);if(e)return o.createElement("div",{className:S.cx.flex.mt12.justifyCenter.$},o.createElement(t8.y$,null));let{view:a,selectedViolationGroup:r}=n,l=r?t[r]??[]:[];return a!==tU.N.GROUPS&&r&&l.length?a===tU.N.VIOLATIONS?o.createElement(nv,{violations:l}):null:o.createElement(ng,{groupedViolations:t})}function ng({groupedViolations:e}){let t=tG(),n=(0,tO.r8)();if(!n)return null;let a=Object.entries(e);return o.createElement(o.Fragment,null,t?o.createElement(tJ,null):o.createElement(tQ,null),a.map(([e,t])=>{if(!t.length)return null;let a=t[0],r=a?.ruleId,l=r?n.getRuleById(r):null;return l?o.createElement(nh,{key:e,groupId:e,violationList:t,rule:l}):null}),o.createElement(tH,{shouldDisplay:!a.length}))}function nh({groupId:e,violationList:t,rule:n}){let{selectGroup:a}=tz(),[r,l]=(0,o.useState)(!1),i=t[0];return i?o.createElement("div",{className:S.cx.p16.pr8.flex.justifyBetween.itemsCenter.bb1.colorBorder.bSolid.if(r,S.cx.colorBgHover).$,onPointerUp:()=>a(e),role:"button",tabIndex:0,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1)},o.createElement("div",{className:S.cx.flex.flexColumn.$},o.createElement("div",{className:S.cx.textBodyMediumStrong.pb2.$},n.name,o.createElement("span",{className:S.cx.pl4.textBodyMedium.colorTextSecondary.$},`(${t.length})`)),o.createElement(nf,{rule:n,context:i.detectionContext})),o.createElement(t0.a,{style:{"--color-icon":"var(--color-icon-tertiary)"}})):null}function nf({rule:e,context:t}){if(e.id===t4.C.REQUIRE_COLOR_TOKENS){if(!("color"in t))return null;let e=(0,t2.tK)(t.color);return o.createElement("div",{className:S.cx.flex.itemsCenter.$},e?o.createElement("div",{className:nl},o.createElement(t6.J,{color:e,opacity:1})):null,o.createElement("div",{className:S.cx.textBodyMedium.colorTextSecondary.ml4.$},t.color.toUpperCase().replace("#","")))}return null}function nv({violations:e}){let{returnToGroupList:t}=tz(),n=tG(),[a,r]=(0,o.useState)(0),l=(0,o.useCallback)(()=>{e.length>1||t()},[e,t]),i=function(){let e=(0,tO.r8)();return(0,o.useCallback)(async t=>{if(e)try{return await e.getFix(t)}catch(e){tV("Error getting fix for violation!",tR.zX.EXCLAMATION,"error");return}},[e])}(),s=function(e){let t=(0,tO.r8)(),[n,a]=(0,f.fp)(tM.m7);return(0,o.useCallback)(async o=>{if(t)try{if(await t.fixSingleViolation(o)){let t=new Map(n),r=t.get(o.guid);r&&(r.delete(o.ruleId),0===r.size?t.delete(o.guid):t.set(o.guid,r)),a(t),e?.()}else tV((0,T.t)("design_linter.penalty_box.fix_failed_bell"),tR.zX.EXCLAMATION,"error")}catch(e){tV((0,T.t)("design_linter.penalty_box.fix_failed_bell"),tR.zX.EXCLAMATION,"error")}},[t,n,a,e])}(l),c=(0,o.useCallback)((e,t)=>{t5.Y5.triggerAction("goto-layer",{args:{nodeId:e}}),r(t)},[]),d=(0,o.useCallback)(()=>{let t=(a+1)%e.length;c(e[t].guid,t)},[a,e,c]),p=(0,o.useCallback)(()=>{let t=(a-1+e.length)%e.length;c(e[t].guid,t)},[a,c,e]);(0,o.useEffect)(()=>{r(0);let t=e[0];t&&c(t.guid,0)},[e,c]);let m=e[a];return o.createElement(o.Fragment,null,n?null:o.createElement(tj,{onNavigateBack:t,title:tK(e[0]?.ruleId)}),m?o.createElement(ni,{violation:m,onGetFix:i,onFix:s}):o.createElement(tH,{shouldDisplay:!0}),o.createElement(tq,{onNext:d,onPrev:p,title:(0,T.tx)("design_linter.penalty_box.layer_of_layers",{current:a+1,total:e.length}),disabled:e.length<=1}),n?null:o.createElement(nb,null))}function nb(){let e=(0,U.p8)("isReadOnly"),t=(0,U.p8)("currentPage"),[n,a]=(0,o.useState)(null),l=(0,r.d4)(e=>e.versionHistory),i=(0,eB.GQ)(),s=(0,o.useCallback)(t=>{e||(a(t),ee.hq(t))},[e]),c=(0,o.useCallback)((t,o,r)=>{e||(n&&t&&(t1.l7.user("set-node-name",()=>ee.i(n,o||"")),t5.Y5.commit(),t3.wt.reportEditActionIf(o!==r,"rename-node")),a(null))},[e,n]);return(0,o.useEffect)(()=>{let e=({nodeId:e})=>{s(e)};return t5.Y5.fromFullscreen.on("startRenamingNode",e),()=>{t5.Y5.fromFullscreen.removeListener("startRenamingNode",e)}},[s]),o.createElement(t7.X,{hasPending:!1,isReadOnly:e,currentPage:t,width:i,renamingGuid:n,startRenaming:s,stopRenaming:c,thumbnailGuid:null,versionHistory:l})}let nS="16px",nT=(0,tv.jz)(nS);function nN(){let e=(0,er.J2)(i.Ez5.uiState().showDesignLinter),t=tG();return(0,s.kc)().aip_flower_garden&&e&&t?o.createElement(nI,null):null}function nI(){let e=tg.ox(),t=function(){let e=(0,eB.GQ)(),t=(0,o.useMemo)(()=>new tS.Mi(e+(0,tv.jz)(nS),(0,tv.jz)(nS)),[e]),[{windowInnerHeight:n}]=(0,tf.A)((0,tb.l)(),300,{equalityFn:t_.c2});return{initialPosition:t,maxHeight:n-2*nT,minHeight:304,minWidth:284,initialHeight:378,initialWidth:284}}();return!function(e){let t=(0,f.md)(tM.Bc),n=(0,o.useRef)();(0,o.useEffect)(()=>{t.view===tU.N.GROUPS?n.current&&e.setSize(n.current):t.view===tU.N.VIOLATIONS&&(n.current=new tS.Mi(e.size.x,e.size.y),e.setSize(new tS.Mi(284,200)))},[t,e])}(e),o.createElement(th._L,{defaultWidth:t.initialWidth,defaultHeight:t.initialHeight,defaultPosition:{left:t.initialPosition.x,top:t.initialPosition.y},maxHeight:t.maxHeight,manager:e,onClose:({source:e})=>{"outside"!==e&&i.Ez5?.uiState().showDesignLinter.set(!1)}},o.createElement(_.vo,null,o.createElement(_.Y9,null,o.createElement(nP,null)),o.createElement(_.nB,{padding:0,scrolling:"none"},o.createElement(nE,null))))}function nP(){let e=(0,f.md)(tM.Bc),{returnToGroupList:t}=tz(),n=tF(),{selectedViolationGroup:a,view:r}=e,l=a?n[a]??[]:[];return r===tU.N.GROUPS?o.createElement(tQ,null):o.createElement(tj,{title:tK(l[0]?.ruleId),onNavigateBack:t})}var nC=n(363668),nA=n(987051),nk=n(344076),nw=n(54900),nO=n(812245),nx=n(641072);function nD({children:e}){return o.createElement(nx.G.Provider,{value:{loggerEventName:"design_navigate"}},e)}var nR=n(30637),nM=n(138369),nL=n(835036),nV=n(809831),nK=n(818),nU=n(617453),nF=n(213190),nB=n(336599),nG=n(428467),nz=n(939562),nY=n(239671),nW=n(7860),nH=n(716622),n$=n(243742),nX=n(506599),nQ=n(697551),nJ=n(914905),nj=n(759096),nq=n(270296),nZ=n(3360),n0=n(69814),n1=n(776621),n2=n(316081),n4=n(215122),n8=n(331596),n3=n(848661),n5=n(618056),n7=n(279145),n6=n(291251),n9=n(140593),ae=n(543509),at=n(177131),an=n(297666),aa=n(358145),ao=n(886653),ar=n(153234),al=n(437304),ai=n(286640),as=n(763658),ac=n(738269),ad=n(395281),ap=n(452246),am=n(906899),au=n(798099),aE=n(416095),ay=n(237929),a_=n(444576),ag=n(945020),ah=n(173454),af=n(922358),av=n(602029),ab=n(7959),aS=n(109388),aT=n(75395),aN=n(463420),aI=n(96796),aP=n(397863),aC=n(617691),aA=n(46481),ak=n(498606),aw=n(498750),aO=n(255942),ax=n(837746);let aD="styles--contextMenu--C-hVT",aR="styles--caret--DZmzh",aM="styles--rowSelectedExpanded--MGvUV",aL="styles--rowSelectedSecondaryLightBlue--S-zy- draggable_list--rowSelectedSecondary--yOI1g raw_components--rowSelectedSecondary---U7Us raw_components--rowSelected--M2Eip";function aV({childLeft:e,childRight:t,deleteSelectedItems:n,forceShowHoverBorder:a,hideStylePreview:r,index:l,inspectStyleSelected:i,isDragging:s,isEditable:c,isRenaming:d,isCollapsed:p=!0,isLastChildOfSelection:m=!1,isFirstChildOfSelection:u=!1,isFolder:E,level:y,name:_,nameRef:g,onContextMenu:h,onCreateFolder:f,onDoubleClick:v,onHoverChange:b,onMouseDown:S,onMouseMove:T,recordingKey:N,rowRef:I,secondaryName:P,selected:C,selectedSecondary:A,stopRenamingItem:k,tooltipData:w}){let O=o.useRef(null),[x,D]=o.useState(_),[R,M]=o.useState(!1),L=(0,em.GS)(),V=o.useCallback(e=>{if(e){let t=aS.findDOMNode(e);t&&t.select()}},[]);o.useEffect(()=>{D(_)},[_]);let K=o.useCallback(e=>{""===e.trim()?(k(l,_),D(_)):k(l,e)},[l,_,k]),U=(0,ar.AF)((0,ar.Pt)(N,"text-input"),"change",o.useCallback(e=>{D(e.currentTarget.value)},[D])),F=(0,ar.v_)((0,ar.Pt)(N,"text-input"),"keydown",e=>{e.keyCode===aw.Uz.ESCAPE?(k(l,_),D(_)):e.keyCode===aw.Uz.ENTER&&K(e.currentTarget.value)},{recordMetadata:e=>({inputValue:e.currentTarget.value}),playbackMetadata:e=>({currentTarget:{value:e.inputValue}})}),B=(0,ar.v_)(N,"keydown",e=>{c&&!d&&(e.keyCode===aw.Uz.BACKSPACE||e.keyCode===aw.Uz.DELETE)?n():c&&!d&&e.keyCode===aw.Uz.G&&(0,aw.Fo)(e)?(f(),e.preventDefault()):!d&&e.nativeEvent&&t5.Y5.forwardKeyboardEvent(e.nativeEvent)}),G=o.useCallback(()=>{K(x)},[K,x]),z=(0,ar.rf)(N,"contextmenu",e=>{h(e)}),Y=(0,ar.rf)(N,"mousemove",e=>{T(e)},{recordMetadata:e=>({bounds:e.currentTarget.getBoundingClientRect(),pageX:e.pageX,pageY:e.pageY}),playbackMetadata:e=>({currentTarget:{getBoundingClientRect:()=>e.bounds},pageX:e.pageX,pageY:e.pageY})}),W=(0,ar.rf)(N,"mousedown",e=>{S(e),r()}),H=(0,ar.rf)(N,"mouseenter",o.useCallback(()=>{M(!0),b?.(!0)},[M,b])),$=o.useCallback(()=>{M(!1),b?.(!1)},[M,b]),X=(0,ar.rf)(N,"dblclick",o.useCallback(e=>{v(e)},[v])),Q=Math.min((y-1)*3,18),J=ax.jNX-4-Q,j=J-(L?7:5),q=R&&!d||i?j:J,Z=C||A,ee=eA()({[aM]:!p&&Z,"styles--folderSecondarySelected--SL0JY":A||C&&!u,[aL]:A&&!L}),et=eA()({[aL]:Z,[aM]:!m&&Z}),en=eA()("styles--rowWithBorder--bphZ-",{[ee]:E,[et]:!E,"styles--rowWithHover--RWNMH":!Z&&(a||R&&!s)}),ea=o.createElement("div",{className:d?"styles--rowContentsRenaming--oDTtO styles--rowContents--37JBy":"styles--rowContents--37JBy",key:_,style:L?{width:"100%"}:{gridColumnEnd:`span ${q}`}},d?o.createElement(ab.ks,{autoCapitalize:"off",autoCorrect:"off",autoFocus:!0,className:"styles--input--LbjR0",onBlur:G,onChange:U,onKeyDown:F,ref:V,spellCheck:!1,value:x}):o.createElement(o.Fragment,null,o.createElement("div",{className:"styles--name--KWZ8d ellipsis--ellipsis--Tjyfa",ref:g,...w},_),P&&o.createElement("div",{className:"styles--textStyle--DiUv4"},P)));return o.createElement(av.e,{className:en,dragging:s,hideGrabber:!0,onContextMenu:z,onKeyDown:B,onMouseDown:W,onMouseEnter:H,onMouseLeave:$,onMouseMove:Y,onDoubleClick:X,ref:(0,aO.A)(O,I),selected:C,selectedSecondary:!1,tabIndex:0},Q>0&&o.createElement("span",{style:{gridColumnEnd:`span ${Q}`}}),o.createElement("div",{className:"styles--childLeftContainer--Hu61K",style:L?{gridColumnEnd:`span ${q}`}:void 0},e,L&&ea),!L&&ea,t)}var aK=n(949207),aU=n(432023),aF=n(501191),aB=n(660164);function aG({deleteSelectedItems:e,folder:t,folderNameToNestUnder:n,hideStylePreview:a,index:l,isCollapsed:i,isDragging:s,isEditable:c,isRenaming:d,isTemporarilyExpanded:p,isFirstChildOfSelection:m,level:u,onContextMenu:E,onCreateFolder:y,onMouseDown:_,onMouseMove:g,onRenameItem:h,recordingKey:f,selected:v,selectedSecondary:b,stopRenamingItem:S,temporarilyExpandFolder:N,toggleFolder:I}){let P=(0,r.wA)(),[C,A]=o.useState(!1),k=o.useRef(null),w=o.useRef(null),O=C&&!d&&c,x=o.useCallback(()=>{I(!i)},[i,I]),D=o.useCallback(e=>{e.target!==w.current&&t.styleTypeSection&&h(t.name,!1,t.styleTypeSection)},[t.name,t.styleTypeSection,h]);o.useEffect(()=>{if(C&&s&&i){let e=setTimeout(()=>{N(t.name)},1e3);return()=>clearTimeout(e)}},[C,s,i,N,t]);let R=o.useCallback(()=>{let e=(0,aC.Zk)(t.styleTypeSection),n=k.current?.getBoundingClientRect();e&&n&&P(am.Zs({rowLeft:n.left,rowTop:n.top,styleType:t.styleTypeSection,styleNameInputPrefix:`${t.name}/`,inheritStyleKeyField:e}))},[k,t.name,t.styleTypeSection,P]);return o.createElement(aV,{deleteSelectedItems:e,forceShowHoverBorder:n===t.name,hideStylePreview:a,index:l,isDragging:s,isEditable:c,isRenaming:d,isCollapsed:i,isFolder:!0,isFirstChildOfSelection:m,level:u,name:(0,ay.kH)(t.name),onContextMenu:E,onCreateFolder:y,onDoubleClick:D,onHoverChange:A,onMouseDown:_,onMouseMove:g,onRenameItem:h,recordingKey:f,selected:v,selectedSecondary:b,stopRenamingItem:S,rowRef:e=>{e&&(k.current=aS.findDOMNode(e))},childLeft:o.createElement(aT.E,{onClick:x,className:"styles--caretContainer--4-dqw",ref:w},o.createElement(aA.U,{svg:i&&!p?aU.A:aK.A,className:aR},i&&!p?o.createElement(aN.k,{className:aR}):o.createElement(aI.O,{className:aR}))),childRight:O&&o.createElement(ab.$4,null,o.createElement(tT.K,{recordingKey:ar.Pt(f,"addButton"),"aria-label":(0,T.t)("design_systems.styles.tooltips.create"),onClick:R,htmlAttributes:{"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("design_systems.styles.tooltips.create")}},o.createElement(aA.U,{svg:aF.A,fallbackSvg:aB.A,children:o.createElement(aP.x,null)})))})}var az=n(196367),aY=n(221768),aW=n(378905),aH=n(44892),a$=n(137906),aX=n(720384),aQ=n(162502);function aJ({deleteSelectedItems:e,hideStylePreview:t,index:n,isDragging:a,isEditable:l,isRenaming:i,isLastChildOfSelection:s,level:c,onContextMenu:d,onCreateFolder:p,onInspectStyle:m,onMouseDown:u,onMouseMove:E,onRenameItem:y,recordingKey:_,selected:g,selectedSecondary:h,stopRenamingItem:f,dsStyle:v,stylePreviewShown:b,updateContextMenuStyleRef:S,updateSelection:N,updateFocusRowRef:I}){let[P,C]=o.useState(!1),A=(0,r.wA)(),k=o.useRef(null),w=o.useRef(null),O=(0,em.GS)(),x=o.useCallback(()=>{l&&y(v.node_id,!0,v.style_type)},[y,v.node_id,v.style_type,l]),D=b.isShown&&!b.isCreating&&b.style.node_id===v.node_id&&(0,aW.EF)(b.style,v),R=P&&!i||D,M=o.useCallback(function(){let e=w.current;if(e){let t=e.getBoundingClientRect();D?A(am.sw()):(A(am.rk({style:v,rowTop:t.top,rowLeft:t.left})),m(v),N({type:v.style_type,folderNames:new Set,styleIds:new Set(v.node_id)}))}A(ed.XE())},[A,m,N,v,D]),L=o.useCallback(e=>{(2===e.button||e.ctrlKey)&&S(w.current),u(e),D&&M()},[M,u,D,S]),V=k.current,K=!!V&&V.offsetWidth<V.scrollWidth,U=o.useMemo(()=>!a&&v.description&&K?{"data-tooltip-type":ak.Ib.SPECIAL,"data-tooltip":aX.Z,"data-tooltip-style-name":(0,ay.kH)(v.name),"data-tooltip-style-description":v.description,"data-tooltip-max-width":ax.jNX*(0,tv.hG)(ax.dGl)}:null,[K,a,v.name,v.description]),F="TEXT"===v.style_type&&v.meta?.style_thumbnail?v.meta.style_thumbnail:null;return o.createElement(aV,{deleteSelectedItems:e,hideStylePreview:t,index:n,inspectStyleSelected:D,isDragging:a,isEditable:l,isRenaming:i,isFolder:!1,isLastChildOfSelection:s,level:c,name:(0,ay.kH)(v.name),nameRef:k,onContextMenu:d,onCreateFolder:p,onDoubleClick:x,onHoverChange:C,onMouseDown:L,onMouseMove:E,onRenameItem:y,recordingKey:_,rowRef:e=>{if(e){let t=aS.findDOMNode(e);I&&I(t),w.current=t}},secondaryName:F&&(0,aH.P$)(F),selected:g,selectedSecondary:h,stopRenamingItem:f,tooltipData:U,childLeft:o.createElement(o.Fragment,null,o.createElement(a$.zi,{dsStyle:v,disableTooltip:!0}),g&&"FILL"===v.style_type&&o.createElement("div",{className:"styles--selectedRing--UniEc"})),childRight:R&&o.createElement(ab.$4,null,o.createElement("div",{style:{gridColumnEnd:"span 1"}}),O?o.createElement(az.d,{recordingKey:ar.Pt(_,"customButton"),toggled:D,onClick:M,htmlAttributes:{"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":l?(0,T.t)("design_systems.styles.edit_style"):(0,T.t)("design_systems.styles.view_style"),onMouseDown:au.dG},children:o.createElement(aA.U,{svg:aQ.A},o.createElement(aY.A,null)),"aria-label":l?(0,T.t)("design_systems.styles.edit_style"):(0,T.t)("design_systems.styles.view_style")}):o.createElement(ab.YW,{className:g?"styles--showOnSelectedRowHover--Lcf7e styles--showOnRowHover--OUqRT":"styles--showOnRowHover--OUqRT",recordingKey:ar.Pt(_,"customButton"),"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":l?(0,T.t)("design_systems.styles.edit_style"):(0,T.t)("design_systems.styles.view_style"),selected:D,onMouseDown:au.dG,onClick:M},o.createElement(aA.U,{svg:aQ.A},o.createElement(aY.A,null))))})}function aj({styleType:e,children:t}){let n=!(0,U.p8)("isReadOnly");return o.createElement("div",{className:"styles--styleTypeSection--jPjTq component_tiles--section--qMua7"},n?o.createElement(aq,{styleType:e,recordingKey:`style-section-header-${e}`}):o.createElement("div",{className:"styles--styleTypeSectionHeader--224lA component_tiles--sectionHeader--eEC6d raw_components--panelTitle--VAQQA"},(0,aE.QT)(e)),t)}function aq({styleType:e,recordingKey:t}){let[n,a]=o.useState(!1),l=(0,r.wA)(),i=o.useRef(null),s=o.useCallback(()=>{let t=(0,aC.Zk)(e),n=i.current?.getBoundingClientRect();t&&n&&l(am.Zs({rowLeft:n.left,rowTop:n.top,styleType:e,inheritStyleKeyField:t}))},[i,e,l]);return o.createElement("div",{className:"styles--styleTypeSectionRow--wVTIO",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),ref:i},o.createElement(ab.JU,{className:"styles--styleTypeSectionRowLabel--PrKm-"},(0,aE.QT)(e)),o.createElement("div",{style:{visibility:n?"visible":"hidden"}},o.createElement(tT.K,{recordingKey:ar.Pt(t,"addButton"),"aria-label":(0,T.t)("design_systems.styles.tooltips.create_style_from_section",{kind:(0,aE.XV)(e).toLowerCase()}),onClick:s,htmlAttributes:{"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("design_systems.styles.tooltips.create_style_from_section",{kind:(0,aE.XV)(e).toLowerCase()})}},o.createElement(aA.U,{svg:aF.A,fallbackSvg:aB.A,children:o.createElement(aP.x,null)}))))}aj.displayName="StyleTypeSection";var aZ=n(268537),a0=n(318812),a1=n(333370);let a2=aZ.ms,a4=aZ.c$,a8=aZ.wv,a3="styles-by-type-context-menu",a5=.75*(0,tv.hG)(ax.uj0);function a7({styleRowRef:e,onEditStyle:t,onRenameItem:n,onCreateFolder:a,onDeleteItems:l,onCutItems:i,onPasteItems:s,styleType:c}){let d=(0,a0.Um)(),p=(0,r.d4)(e=>e.library.localStyleSelection),m=o.useMemo(()=>p&&p.type===c&&d?.type===a3?(0,a1.QA)(p,d.data.uiList):[],[p,d,c]),u=o.useMemo(()=>(0,a1.Ug)(m).map(e=>e.node_id),[m]),E=u.length;return d&&u.length?o.createElement(a6,{styleRowRef:e,selectedItems:m,numStyles:E,dropdownShown:d,onEditStyle:t,onRenameItem:n,onCreateFolder:a,onDeleteItems:l,onCutItems:i,onPasteItems:s}):o.createElement("div",null)}function a6({styleRowRef:e,selectedItems:t,numStyles:n,dropdownShown:a,onEditStyle:l,onRenameItem:s,onCreateFolder:c,onDeleteItems:d,onCutItems:p,onPasteItems:m}){let u=(0,r.wA)();o.useEffect(()=>(i.glU.computePastableStyleCount(),()=>{i.glU.clearPastableStyleCount()}),[]);let E=(0,r.d4)(e=>e.mirror.appModel.pastableStyleCount),y=!!F.q5()?.canEdit,_=o.useCallback(()=>{if(!t.length||t[0].type!==ah.PW.STYLE)return;let n=t[0];if(e){let t=e.getBoundingClientRect();u(am.rk({style:n,rowTop:t.top,rowLeft:t.left})),u(ed.XE())}l(n)},[u,t,l,e]),g=o.useCallback(()=>{if(!t.length||t[0].type===ah.PW.STYLE)return;let e=t[0];s(e.name,!1,e.styleTypeSection)},[s,t]);if(-1===E)return o.createElement("div",null);if(!y)return n>1?o.createElement("div",null):o.createElement(a2,{style:a.data.position,className:aD},o.createElement(a4,{recordingKey:"edit-style-option",onClick:_},(0,T.tx)("design_systems.styles.view_style")));let h=1===n&&(t[0].type===ah.PW.STYLE?o.createElement(a4,{recordingKey:"edit-style-option",onClick:_},(0,T.tx)("design_systems.styles.edit_style")):o.createElement(a4,{recordingKey:"rename-folder-option",onClick:g},(0,T.tx)("design_systems.styles.rename_folder")));return o.createElement(a2,{style:a.data.position,className:aD},o.createElement(a4,{recordingKey:"create-folder-option",onClick:c},(0,T.tx)("design_systems.styles.add_new_folder")),h,o.createElement(a4,{recordingKey:"delete-style-option",onClick:d},(0,T.tx)("design_systems.styles.delete_styles",{numStyles:n})),o.createElement(a8,null),o.createElement(a4,{recordingKey:"cut-style-option",onClick:p},(0,T.tx)("design_systems.styles.cut_styles",{numStyles:n})),!!E&&o.createElement(a4,{recordingKey:"paste-style-option",onClick:m},(0,T.tx)("design_systems.styles.paste_styles",{numStyles:E})))}var a9=n(927457),oe=n(710752),ot=n(582288),on=n(884909),oa=n(304173),oo=n(405206),or=n(298543),ol=n(184027),oi=n(608974),os=n(257812),oc=n(319431),od=n(914110);let op="local-style-creation-dropdown";function om(){let e=(0,r.wA)(),t=(0,o.useContext)(ol.lk),n=!(0,U.p8)("isReadOnly"),a=o.useRef(null),l=o.useRef(null),i=a.current,s=(0,a0.Um)(),c=s?.type===op,d=s?.data?.targetRect,p="localStyleHeader",m=0===(0,nj.Bs)().length,u=(0,r.d4)(e=>e.stylePreviewShown.isShown&&e.stylePreviewShown.isCreating),E=o.useMemo(()=>d||(c&&i?i.getBoundingClientRect():null),[d,i,c]),y=()=>{e(ac.oB())},_=()=>{e(ac.j7({type:op}))},g=t=>{t.stopPropagation(),e(am.YG());let n=a.current;c?y():n&&((0,ek.sx)("editor-local-styles-dropdown-show"),_())},h=e=>{y();let n=(0,aC.Zk)(e),a=l.current?.getBoundingClientRect();n&&a&&t({styleType:e,inheritStyleKeyField:n,rowLeft:a.left,rowTop:a.top})},f=m&&!c&&!u;return o.createElement(ab.fI,{className:f?"styles--panelHeaderRowFaded--pfgKz styles--panelHeaderRow--Kxqgo styles--styleTypeSectionRow--wVTIO draggable_list--panelHeaderRowFaded--kETRR":"styles--panelHeaderRow--Kxqgo styles--styleTypeSectionRow--wVTIO",forwardedRef:l},o.createElement(ab.xZ,{className:"styles--panelTitleText--v7gXm draggable_list--panelTitleText--SwKez",onMouseDown:e=>f&&g(e),onClick:e=>e.stopPropagation()},(0,T.tx)("design_systems.styles.local_styles")),n&&o.createElement(o.Fragment,null,o.createElement(ab.K0,{ref:a,onMouseDown:g,onClick:e=>e.stopPropagation(),className:c?"styles--stylesHeaderButtonHighlight--WTeWy raw_components--iconButtonSelected--bJibL raw_components--_iconButton---ybo6":"styles--stylesHeaderButton--jhpA5 draggable_list--addButton--D0q--","data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("design_systems.create_style.create_style"),recordingKey:ar.Pt(p,"addButton")},o.createElement(aA.U,{svg:aF.A,fallbackSvg:aB.A},o.createElement(a9.e,null))),c&&E&&o.createElement(or.Cf,{targetRect:E,minWidth:128,disableDropdownScrollContainer:!0,propagateCloseClick:!0},aE.og.map(e=>{let{icon:t,label:n}=function(e){switch(e){case"TEXT":return{icon:o.createElement(aA.U,{svg:od.A},o.createElement(oe.e,null)),label:(0,T.t)("design_systems.styles.dropdown.text")};case"FILL":return{icon:o.createElement(aA.U,{svg:os.A},o.createElement(ot.G,null)),label:(0,T.t)("design_systems.styles.dropdown.fill")};case"GRID":return{icon:o.createElement(aA.U,{svg:oc.A},o.createElement(on.E,null)),label:(0,T.t)("design_systems.styles.dropdown.grid")};case"EFFECT":return{icon:o.createElement(aA.U,{svg:oi.A},o.createElement(oa.n,null)),label:(0,T.t)("design_systems.styles.dropdown.effect")};default:throw(0,n9.j)(e),Error(`Invalid style type: ${e}`)}}(e),a=t=>{t.stopPropagation(),h(e)};return o.createElement(aZ.c$,{key:e,className:"styles--createStyleDropdownRow--7iCXQ",onClick:a,onPointerUp:a,recordingKey:ar.Pt(p,`dropdown-option-${e}`)},o.createElement(oo.Nu,null,t),n)}))))}let ou="collapsed-style-folders";function oE({scrollContainer:e,recordingKey:t}){let n=(0,nj.Bs)(),a=(0,U.p8)("isReadOnly");return 0===n.length&&a?null:o.createElement(as.k,{name:"local_styles_panel"},o.createElement(ab.Zk,null,o.createElement(oy,{scrollContainer:e,recordingKey:t})))}function oy({scrollContainer:e,recordingKey:t}){let n=(0,r.wA)(),a=(0,r.d4)(e=>e.stylePreviewShown),l=(0,r.d4)(e=>e.mirror.appModel.activeCanvasEditModeType),s=(0,r.d4)(e=>e.mirror.appModel.currentTool),c=o.useRef(null),d=(0,nj.Bs)(),p=(0,r.d4)(e=>e.library.localStyleSelection),[m,u]=o.useState(null),[E,y]=o.useState(null),_=o.useRef(null),[g,h]=o.useState(!1),f=l===i.m1T.GRADIENT||l===i.m1T.RASTER||s===i.NLJ.DROPPER_COLOR;o.useEffect(()=>{let e=()=>{!f&&(n(ad.Bn(null)),a.isShown&&(n(am.sw()),i.glU.selectStyle(at.n3.INVALID,at.IA.INVALID)))},t=(0,au.ft)();return t?window.addEventListener("pointerdown",e):window.addEventListener("mousedown",e),()=>{t?window.removeEventListener("pointerdown",e):window.removeEventListener("mousedown",e)}},[n,a.isShown,f]);let{stylesByType:v,foldersAndStylesByType:b}=o.useMemo(()=>{let e=(0,aE.Kw)(d),t=new Map;return aE.og.map(n=>{let a=e.get(n);if(a){(0,aE.LX)(a);let e=(0,a1.lM)(a,n),o=(0,a1.l0)(e);t.set(n,o)}}),{stylesByType:e,foldersAndStylesByType:t}},[d]),S=o.useCallback(e=>{(0,n9.KF)(null!=e.content_hash,"style does not have a hash"),i.glU.selectStyleByGuid(e.node_id),n(ad.ay({isRenaming:!1})),(0,ek.sx)("Style Inspected",{styleType:e.style_type,from:"styleListClick"})},[n]),T=o.useCallback((e,t,n)=>{u(t?e:null),y(t?null:{name:e,styleTypeSection:n})},[]),N=o.useCallback(e=>{if(!e){n(ad.Bn(null));return}let t=new Set;e.styleIds.forEach(n=>{let a=d.find(e=>e.type===ah.PW.STYLE&&e.node_id===n);if(!a)return;let o=(0,ay.In)(a.name);e.folderNames.has(o)||t.add(n)});let a={type:e.type,folderNames:e.folderNames,styleIds:t};n(ad.Bn(a))},[n,d]),I=o.useCallback((e,t,n)=>{if(!p)return;let a=e[t],o=(e,t)=>{let a=(0,ay.ke)(e.name),o=null!=t?t:a.length-1;a[o]=n;let r=(0,a1.Pc)(a.join("/"));t1.l7.user("rename-style",()=>i.glU.renameNode(e.node_id,r))};if(a.name!==n){if(a.type===ah.PW.STYLE)o(a);else{(0,a1.mx)(t,e).forEach(t=>{let n=e[t];n.type===ah.PW.STYLE&&o(n,a.level-1)});let r=new Set(p.folderNames);r.delete(a.name);let l=(0,ay.In)(a.name)+"/"+n;r.add(l),N({type:p.type,folderNames:r,styleIds:p.styleIds})}}t5.Y5.triggerAction("commit"),u(null),y(null)},[p,N]),P=o.useCallback((e,t)=>{t.preventDefault(),t.stopPropagation(),n(ac.j7({type:a3,data:{uiList:e,position:{top:t.clientY,left:Math.min(t.clientX,window.innerWidth-a5)}}}))},[n]),C=o.useCallback(e=>{_.current=e},[]),A=o.useCallback(()=>{h(!0)},[]),k=o.useCallback(()=>{h(!1)},[]);return o.createElement("div",{className:"styles--localStylesPanel--T4Gqs",ref:c},o.createElement(om,null),aE.og.map(n=>{let a=v.get(n);if(!a)return;let r=b.get(n);if(r)return o.createElement(o_,{key:n,recordingKey:ar.Pt(t,`style-section-${n}`),styleType:n,storedStyleList:a,styleList:r,updateSelection:N,isDragging:g,onDragStart:A,onDragEnd:k,onInspectStyle:S,onContextMenu:P,updateContextMenuStyleRef:C,renamingStyleID:m,renamingFolder:E,onRenameItem:T,stopRenamingItem:I,styleRowRef:_.current,onEditStyle:S,scrollContainer:e})}))}function o_({styleType:e,storedStyleList:t,styleList:n,renamingStyleID:a,renamingFolder:l,onRenameItem:s,stopRenamingItem:c,onDragStart:d,onDragEnd:p,onInspectStyle:m,onContextMenu:u,updateContextMenuStyleRef:E,updateSelection:y,styleRowRef:_,scrollContainer:g,recordingKey:h}){let f=(0,F.q5)(),v=!(0,U.p8)("isReadOnly"),b=(0,r.wA)(),S=(0,r.d4)(e=>e.stylePreviewShown),N=(0,em.GS)(),I=(0,r.d4)(t=>(0,a_.i4)(t,e)),P=(0,r.d4)(t=>(0,a_.A7)(t,e,n)),[C,A]=o.useState(()=>{if(ai.x4&&f){let t=JSON.parse(ai.x4.getItem(ou)||"{}");if(f.key in t){let n=t[f.key];if(e in n)return new Set(n[e])}else t[f.key]={},ai.x4.setItem(ou,JSON.stringify(t))}return new Set(n.filter(e=>"STYLE_FOLDER"===e.type).map(e=>e.name))}),[k,w]=o.useState([]),[O,x]=o.useState(null),[D,R]=o.useState(null),M=o.useMemo(()=>(0,an.s)(()=>{b(ap.GT({styleType:e}))},200),[b,e]);o.useEffect(()=>{M()},[M,n]);let L=(0,aa.ZC)(C);o.useEffect(()=>{if(!L||!ai.x4||!f||(0,al._f)(L,C))return;let t=JSON.parse(ai.x4.getItem(ou)||"{}"),n=t[f.key];n&&(n[e]=[...C],ai.x4.setItem(ou,JSON.stringify(t)))},[C,f,L,e]);let V=o.useCallback(e=>!!e&&"STYLE_FOLDER"===e.type,[]),K=o.useCallback((e,t)=>{let a=new Set(e),o=[];n.forEach((e,t)=>{if(a.has(e)&&(o.push(t),"STYLE_FOLDER"===e.type)){let e=(0,a1.mx)(t,n);o.push(...e)}});let r=new Set(o),l=t?n.indexOf(t):n.length,i=[...(0,ae.y1)(l).filter(e=>!r.has(e)),...o,...(0,ae.y1)(l,n.length).filter(e=>!r.has(e))],s=new Map;return i.forEach((e,t)=>{e!==t&&s.set(e,t)}),s},[n]),B=o.useCallback(()=>{S.isShown&&(b(am.sw()),b(ed.XE()),i.glU.selectStyle(at.n3.INVALID,at.IA.INVALID))},[b,S.isShown]),G=o.useMemo(()=>{if(!O)return null;if("in"===O.type){let e=n[O.index];return e?{folderNameToNestUnder:e.name,dividerStyles:{display:"none"}}:null}if(null==O.index||null==D||!I)return null;let e=(0,a1.QA)(I,n),t=e[0],a=null,o=null;if(0===O.index?o=n[O.index]:O.index===n.length?a=n[O.index-1]:(a=n[O.index-1],o=n[O.index]),a?.type==="STYLE_FOLDER"&&C.has(a.name)&&-1===k.indexOf(a.name))return{folderNameToNestUnder:a.name,dividerStyles:{display:"none"}};if(a?.type===ah.PW.STYLE){let e=(0,ay.In)(a.name).split("/");for(let n=0;n<e.length;n++){let a=e.slice(0,n+1).join("/");if(C.has(a)&&-1===k.indexOf(a)){if("STYLE_FOLDER"!==t.type)return{folderNameToNestUnder:a,dividerStyles:{display:"none"}};return{folderNameToNestUnder:(0,ay.In)(a),dividerStyles:{marginLeft:24*Math.min((0,ay.ke)(a).length,8)-8}}}}}let r=0,l=null,i=a?(0,a1.rM)(a):0,s=o?(0,a1.rM)(o):0;if(i<=s)r=s,l=a?a.type===ah.PW.STYLE?(0,ay.In)(a.name):a.name:"";else if((0,n9.KF)(null!=a,"Dragging after an item that doesn't exist"),t.type===ah.PW.STYLE||D>=.5)r=i,l=(0,ay.In)(a.name);else{let e=Math.floor(D/.5*(0,a1.rM)(a));e=Math.max(s-1,e),l=(0,ay.ke)((0,ay.In)(a.name)).slice(0,e).join("/"),r=e+1}let c={marginLeft:24*Math.min(r,8)-8};return a&&e.includes(a)||!(0,a1.Md)(a,t,o)?{folderNameToNestUnder:null,dividerStyles:c}:{folderNameToNestUnder:l,dividerStyles:c}},[C,D,I,O,n,k]),z=o.useCallback((a,o,r,l)=>{if(!t||!o&&!r||!G)return;let i=G.folderNameToNestUnder;if(null===i)return;let s=[],c=[];a.forEach(e=>{(0,a1.Md)(o,e,r,i)&&("STYLE_FOLDER"===e.type?c.push(e):s.push(e))});let d=s.concat(c);if(!d.length)return;let p=t1.l7.user("reorder-styles",()=>(0,a1.VB)(d,o,r,i,n,t,l||!1)),m=new Set,u=new Set;d.forEach(e=>{let t=(0,a1.t_)(e),n=p?.get(t);n&&("STYLE_FOLDER"===e.type?m.add(n):u.add(t))}),y({type:e,folderNames:m,styleIds:u});let E=new Set;return C.forEach(e=>{if(i.startsWith(e))return;let t=p?.get(e);t?E.add(t):E.add(e)}),A(E),B(),l||t5.Y5.triggerAction("commit"),K(d,r)},[y,C,G,K,B,t,n,e]),Y=o.useCallback((e,t)=>{if("STYLE_FOLDER"!==t.type)return;let a=n.indexOf(t),o=(0,a1.dm)(t).filter(e=>(0,ay.In)(e.name)===t.name);if(!o.length)return z(e,t,n[a+1]);{let t=o[o.length-1],a=n.indexOf(t);return z(e,t,n[a+1])}},[z,n]),W=(0,ao.xx)((e,t)=>{let a=new Map,o=t.map(e=>e.type===ah.PW.STYLE?e.node_id:e.name);return e.forEach(e=>{let r=o.indexOf(e);-1!==r&&(0,a1.mx)(r,n).forEach(e=>{let n=t[e],o="STYLE_FOLDER"===n.type?n.name:n.node_id,r=a.get(o);r||(r=0),a.set(o,r+1)})}),a}),H=o.useCallback(()=>{if(!I)return;let t=(0,a1.QA)(I,n);if(0===t.length)return;let a=t[0],o=n.indexOf(a),r=o,l=o+1;if(a.type===ah.PW.STYLE&&n[l]&&n[l].type===ah.PW.STYLE){let e=(0,a1.rM)(a);for(let t=o+1;t<n.length;t++){let a=n[t];if("STYLE_FOLDER"===a.type&&a.level===e||(0,a1.rM)(a)<e){r=t-1,l=t;break}t===n.length-1&&(r=t,l=t+1)}}z(t,n[r],n[l],!0);let c=(0,ay.In)(a.name),d=N?(0,T.t)("design_systems.create_style.new_folder"):(0,T.t)("design_systems.create_style.untitled_folder");c&&(d=`${c}/${d}`);let p=(e,t)=>{if(e.type===ah.PW.STYLE){let n=d+"/"+t+(0,ay.kH)(e.name);t1.l7.user("rename-style",()=>{i.glU.renameNode(e.node_id,n)})}else{let n=t+(0,ay.kH)(e.name)+"/";e.styles.forEach(e=>{p(e,n)}),e.subfolders.forEach(e=>{p(e,n)})}};t.forEach(e=>{p(e,"")}),y({type:e,folderNames:new Set([d]),styleIds:new Set}),s(d,!1,e)},[y,z,N,I,s,n,e]),$=o.useCallback((e,t)=>{let a=n[e];"STYLE_FOLDER"===a.type&&A(e=>{let n=new Set(e);return t?n.add(a.name):n.delete(a.name),n})},[n]),X=o.useCallback((e,t)=>{A(a=>{let o=new Set(a),r=n[e];if("STYLE_FOLDER"===r.type){let e=(0,ay.In)(r.name),n=""===e?t:e+"/"+t;C.has(r.name)&&(C.delete(r.name),C.add(n)),(0,a1.KU)(r).forEach(e=>{if(C.has(e.name)){let t=e.name.replace(r.name,"");C.add(n+t),C.delete(e.name)}})}return o}),c(n,e,t)},[c,C,n]),Q=o.useCallback(e=>{u(n,e)},[u,n]),J=o.useCallback((e,t,n)=>{let a=t>.5?1:Math.round(1e3*t)/1e3;x({index:e,type:n?"in":"before"}),R(a)},[]),j=o.useCallback(()=>{A(e=>t1.l7.user("delete-styles",()=>{let t=new Set(e);return(I?(0,a1.QA)(I,n):[]).forEach(e=>{"STYLE_FOLDER"===e.type?((0,a1.a2)(e,f?.key||null),C.delete(e.name),(0,a1.KU)(e).forEach(e=>C.delete(e.name))):(0,a1.Nr)(e,f?.key||null)}),t})),t5.Y5.triggerAction("commit"),S.isShown&&(b(am.sw()),b(ed.XE()),i.glU.selectStyle(at.n3.INVALID,at.IA.INVALID)),y(null)},[S.isShown,y,I,n,f?.key,C,b]),q=o.useMemo(()=>{let e=I?(0,a1.QA)(I,n):[];return(0,a1.Ug)(e).map(e=>e.node_id)},[I,n]),Z=o.useCallback(()=>{t1.l7.user("cut-styles",()=>i.glU.cutStyles(q))},[q]),ee=o.useCallback((e,t)=>{t===ag.zy.PASTE?t1.l7.user("paste-styles",()=>i.glU.pasteStyles()):e.shouldPropagate=!0},[]);o.useEffect(()=>{if(!I)return;let e=e=>{e.target&&("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)||Z()};return document.addEventListener("cut",e),()=>{document.removeEventListener("cut",e)}},[Z,I]);let et=o.useCallback(()=>{i.glU.pasteStyles()},[]),en=o.useCallback(e=>{w(t=>[...t,e])},[]),ea=o.useCallback(()=>{d()},[d]),eo=ar.rf(h,"ondragend",o.useCallback(()=>{x(null),R(null),w([]),p()},[p])),er=(0,aa.ZC)(I);o.useEffect(()=>{er!==I&&I&&A(e=>{let n=new Set(e);for(let e of I.styleIds.values()){let a=t.find(t=>t.node_id===e);if(!a)continue;let o=(0,ay.ke)(a.name);for(let e=0;e<o.length;e++){let t=o.slice(0,e).join("/");n.delete(t)}}return n})},[I,er,t]);let el=o.useRef(null),ei=o.useCallback(e=>{el.current=e},[el]),es=o.useMemo(()=>I?(0,a1.h$)(I,n):[],[I,n]),ec=o.useMemo(()=>P?(0,a1.h$)(P,n):[],[P,n]),ep=o.useMemo(()=>[...es,...ec].sort((e,t)=>e-t),[es,ec]),eu=o.useCallback((e,t,r,i,c,d)=>{let p="STYLE_FOLDER"===e.type?e.name:e.node_id,u=!1,_=!1;for(let t of k)if("STYLE_FOLDER"===e.type){if(e.name===t){_=!0;break}e.name.startsWith(t)&&(u=!0)}else if((0,ay.In)(e.name)===t){u=!0;break}if(!_&&!u&&W(C,n).has(p))return null;let g=ep&&ep[ep.length-1]===t,h=ep&&ep[0]===t;if(e.type===ah.PW.STYLE){let n=(0,a1.rM)(e),l=null!=a&&a===e.node_id;return o.createElement(aJ,{hideStylePreview:B,recordingKey:`style-row-${t}`,index:t,key:e.node_id,isDragging:i,dsStyle:e,selected:r,selectedSecondary:P?.styleIds.has(e.node_id)||!1,level:n,stylePreviewShown:S,onContextMenu:Q,updateContextMenuStyleRef:E,updateFocusRowRef:r?ei:null,onMouseDown:c,onMouseMove:d,onInspectStyle:m,updateSelection:y,isEditable:v,deleteSelectedItems:j,isRenaming:l,onRenameItem:s,stopRenamingItem:X,onCreateFolder:H,isLastChildOfSelection:g})}{let n=null!=l&&l.name===e.name&&l.styleTypeSection===e.styleTypeSection,a=G?.folderNameToNestUnder||null;return o.createElement(aG,{recordingKey:`folder-section-${e.styleTypeSection}-row-${t}`,key:t,index:t,isDragging:i,folder:e,selected:r,selectedSecondary:P?.folderNames.has(e.name)||!1,isCollapsed:C.has(e.name),temporarilyExpandFolder:en,isTemporarilyExpanded:_,isRenaming:n,folderNameToNestUnder:a,onRenameItem:s,stopRenamingItem:X,level:e.level,toggleFolder:e=>$(t,e),onContextMenu:Q,onCreateFolder:H,onMouseDown:c,onMouseMove:d,isEditable:v,deleteSelectedItems:j,hideStylePreview:B,isFirstChildOfSelection:h})}},[y,ep,C,j,G?.folderNameToNestUnder,W,B,Q,H,m,s,l,a,P?.folderNames,P?.styleIds,X,n,S,en,k,$,E,v,ei]),eE=o.useCallback(t=>{let a=new Set,o=new Set;t.forEach(e=>{let t=n[e];"STYLE_FOLDER"===t.type?a.add(t.name):o.add(t.node_id)}),y({type:e,folderNames:a,styleIds:o})},[y,n,e]),ey=o.useRef(),e_=o.useRef();return o.useEffect(()=>{ey.current&&es.length?(ey.current(),el.current&&!el.current.contains(document.activeElement)&&el.current.focus()):e_.current&&!es.length&&(e_.current(),el.current=null)},[ey,es,el]),o.createElement(af.vL,{name:"StyleDraggableList",handleClipboard:ee,focusFunctionRef:ey,blurFunctionRef:e_},o.createElement(aj,{styleType:e},o.createElement(og,{recordingKey:"style-draggable-list",listItems:n,onInsertItemsIn:Y,canInsertItemsIn:V,onInsertItemsBetweenValues:z,onDrag:J,onDragStart:ea,onDragEnd:eo,insertDividerStyle:G?.dividerStyles,selectedIndices:es,updateSelection:eE,renderListItem:eu,scrollContainer:g,isDragDisabled:!v}),o.createElement(a7,{styleRowRef:_,onDeleteItems:j,onCutItems:Z,onPasteItems:et,onRenameItem:s,onEditStyle:m,onCreateFolder:H,styleType:e})))}class og extends av.q{}var oh=n(520285),of=n(70575),ov=n(181320),ob=n(804846),oS=n(33136),oT=n(166635);function oN(e){let t=(0,oS.t)();return e.readOnly?o.createElement(oT.lc,{...e}):t.nodesAreAllInsideStacks&&"AUTO"===t.stackPositioning?null:o.createElement(ab.Zk,null,o.createElement(ab.fI,null,o.createElement(ab.xw,{extended:!0},(0,T.tx)("fullscreen.properties_panel.constraints_panel.constraints"))),o.createElement(oT.lc,{...e}))}function oI(e){return o.createElement(as.k,{name:"constraints_panel"},o.createElement(oN,{...e}))}var oP=n(233711),oC=n(78479),oA=n(905060),ok=n(841446),ow=n(80479),oO=n(876797),ox=n(750693),oD=n(307905),oR=n(459674),oM=n(443830),oL=n(412342),oV=n(390965),oK=n(754276),oU=n(581138),oF=n(939791);function oB({recordingKey:e,numSelected:t}){let n=(0,em.GS)(),a=t??1,r=()=>{i.glU.upgradeToLatestVectorOperationVersion()},l=(0,T.tx)("fullscreen.properties_panel.vector_operation.update_text",{numNodes:a}),s=(0,T.tx)("fullscreen.properties_panel.vector_operation.update_button",{numNodes:a});return o.createElement(ab.Zk,null,o.createElement("p",{className:S.cx.pl16.pr16.mb12.font11.$},l),n?o.createElement(oF.Ad,{label:null,input:o.createElement(nt.$n,{variant:"secondary",onClick:r,recordingKey:ar.Pt(e,"updateBoolean")},s)}):o.createElement(oU.z,{onClick:r,recordingKey:ar.Pt(e,"updateBooleanUI2")},s))}var oG=n(520581),oz=n(869156),oY=n(635736);function oW(e){return e.modalShown?.type===oY.ye.type||e.modalShown?.prevModal?.type===oY.ye.type}function oH(){let e=(0,oY.mB)(),t=(0,o.useCallback)(()=>{e()},[e]),n=(0,r.d4)(oW),a=0===(0,oz.Rb)().length&&!n;return o.createElement(as.k,{name:"local_variables_panel"},o.createElement(ab.Zk,null,o.createElement(ab.fI,{className:a?"local_variables_panel--localVariablesPanelRowFaded--atToe local_variables_panel--localVariablesPanelRow--zR8nJ draggable_list--panelHeaderRowFaded--kETRR":"local_variables_panel--localVariablesPanelRow--zR8nJ"},o.createElement(ab.xZ,{className:"local_variables_panel--titleText--7rdD7 draggable_list--panelTitleText--SwKez",onClick:t,"data-onboarding-key":"local-variables-panel-title"},(0,T.tx)("variables.local_variables_panel.local_variables_title")),o.createElement(oG.E,{name:"variables_modal_button"},o.createElement(az.d,{onClick:t,recordingKey:(0,ar.Pt)("localVariablesPanel","variablesModalButton"),toggled:n,"aria-label":(0,T.t)("variables.local_variables_panel.open_variables_button_tooltip"),htmlAttributes:{"data-tooltip":(0,T.t)("variables.local_variables_panel.open_variables_button_tooltip"),"data-tooltip-type":ak.Ib.TEXT}},o.createElement(aA.U,{svg:aQ.A},o.createElement(aY.A,null)))))))}var o$=n(460043);function oX({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:c,localPlugins:d,modalShown:p,openFile:m,orgEntity:u,pickerInStyleCreationShown:E,pickerShown:y,publishedPlugins:_,saveAsState:g,sceneGraphSelection:h,scrollContainer:v,selectedStyleProperties:b,selectionPaints:S,selectionProperties:T,shownPanels:N,strokePanelMode:I,strokePanelTerminalPointCount:P,stylePickerListLayout:C,stylePickerShown:A}){let k=(0,r.wA)(),w=(0,f.md)(nJ.b);return o.createElement(n0.i,null,0===Object.keys(h).length&&o.createElement(of.Mw,{panelName:of.ON.DESIGN}),(0,nq.d6)(N)&&o.createElement(oh.AV,{recordingKey:"alignPanel"}),o.createElement(n2.VF,{isVisible:N[i.ibQ.TRANSFORM_ITEM]},()=>o.createElement(oK.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:w,pickerShown:y,openFileKey:m?.key||null,canEditConstraints:(0,nq.GG)(N),onlyShowXYInputsRow:w===nj.GR.DEFAULT_SIMPLIFIED||(l().areOnlyResponsiveSetsSelected??!1)})),o.createElement(n2.VF,{isVisible:(0,nq.jP)(T)},()=>o.createElement(oB,{key:"vectorOperation",recordingKey:"vectorOperationPanel",numSelected:T.numSelected})),o.createElement(nj.F$,{isVisible:N[i.ibQ.SCALE_ITEM]}),o.createElement(oP.Q,{selection:h,shownPanels:N,scaleShouldHideOtherPanels:(0,nq.NR)(N)}),o.createElement(n2.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(oV.r,{key:"template"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(o$.$,{key:"templateProperties",recordingKey:"templatePropsPanel"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.COMPONENT_ITEM]},()=>o.createElement(ob.cu,{key:"component",recordingKey:"componentPanel"})),o.createElement(n2.VF,{isVisible:(0,nq.tV)(N,T.stateGroupSelectionInfo)},()=>o.createElement(n6.BS,{key:"componentProperties",recordingKey:"propsPanel"})),o.createElement(n2.VF,{isVisible:(0,nq.M0)(N)},()=>o.createElement(oA._,{key:"instance",recordingKey:"instancePanel"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.VECTOR_ITEM]},()=>o.createElement(oK.Ss,{key:"vector-transform",recordingKey:"vectorTransformPanel",isUI3:!1,x:l().x,y:l().y,cornerRadius:l().cornerRadius,handleMirroring:l().handleMirroring,dispatch:k,dropdownShown:a})),o.createElement(n2.VF,{isVisible:(0,nq.zp)(N,T,b,!1)},()=>o.createElement(oL.Vy,{key:"stack",onlyShowResizingRow:!1,onlyStacksSelected:!!N[i.ibQ.STACK_ITEM],recordingKey:"stackPanel"})),o.createElement(n2.VF,{isVisible:(0,nq.GG)(N)},()=>o.createElement(oI,{key:"constraints",openFileKey:m?.key||null,dropdownShown:a,recordingKey:"constraintsPanel"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.MASK_ITEM]},()=>o.createElement(oO.B,{key:"mask",maskType:T.maskType,dispatch:k,dropdownShown:a,recordingKey:"maskPanel"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.GRIDS_ITEM]},()=>o.createElement(nj.tC,{key:"grids",selectionProperties:T})),o.createElement(n2.VF,{isVisible:N[i.ibQ.LAYER_ITEM]},()=>o.createElement(ow.s,{key:"layer",blendMode:T.blendMode,opacity:T.opacity,visible:T.visible,variableConsumptionInfo:T.variableConsumptionInfo,recordingKey:"layerPanel"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.TYPE_ITEM]},()=>o.createElement(nj.gc,{key:"type",selectionProperties:T})),o.createElement(n2.VF,{isVisible:N[i.ibQ.CANVAS_ITEM]},()=>o.createElement(ov.v,{key:"canvas-background",backgroundColor:T.backgroundColor,backgroundEnabled:T.backgroundEnabled,backgroundOpacity:T.backgroundOpacity,exportBackgroundDisabled:T.exportBackgroundDisabled,dispatch:k,dropdownShown:a,modalShown:p,editModeType:t.activeCanvasEditModeType,pickerShown:y,currentTool:t.currentTool,colorFormat:n,library:c,openFile:m,recordingKey:"canvasBackgroundPanel",currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:n5.rC,sceneGraphSelection:h,selectedStyleProperties:b,hasExports:!!T.exportSettings&&(0,n3._W)(T.exportSettings,[]).length>0})),o.createElement(n2.VF,{isVisible:N[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>o.createElement(oD.C,{key:"remove-group-fill-stroke"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.FILL_ITEM]},()=>o.createElement(nj.B8,{key:"fill",selectionProperties:T,variableScopes:(0,oM.og)(T)})),o.createElement(n2.VF,{isVisible:N[i.ibQ.STROKE_ITEM]},()=>o.createElement(ox.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:A,strokePanelMode:I,strokePanelTerminalPointCount:P,strokePaints:T.strokePaints,borderSharedWeight:T.borderSharedWeight,strokeWeight:T.strokeWeight,strokeAlign:T.strokeAlign,strokeCap:T.strokeCap,strokeJoin:T.strokeJoin,miterLimitAngle:T.miterLimitAngle,connectorLineStyle:T.connectorLineStyle,leftEndCap:T.leftEndCap,rightEndCap:T.rightEndCap,maxStrokeWeight:T.maxStrokeWeight,dashPattern:T.dashPattern,dashCap:T.dashCap,terminalCap:T.terminalCap,arcRadius:T.arcRadius,arcSweep:T.arcSweep,numSelectedByType:T.numSelectedByType,dispatch:k,dropdownShown:a,modalShown:p,pickerShown:y,pickerInStyleCreationShown:E,stylePickerListLayout:C,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:n5.Em,inheritStyleKey:T.inheritFillStyleKeyForStroke||null,inheritStyleID:T.styleIdForStrokeFill||null,library:c,sceneGraphSelection:h,selectedStyleProperties:b,openFile:m,isPanelBodyCollapsedAtom:null})),o.createElement(n2.VF,{isVisible:(0,nq.fI)(N,(0,nq.NR)(N),S)},()=>o.createElement(ox.UA,{key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:S,dispatch:k,dropdownShown:a,sceneGraphSelection:h,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:y,stylePickerListLayout:C,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:n5.rC,library:c,openFile:m,isUI3:!1})),o.createElement(n2.VF,{isVisible:N[i.ibQ.EFFECTS_ITEM]},()=>o.createElement(nj.w5,{key:"effects",selectionProperties:T})),o.createElement(n2.VF,{isVisible:(0,nq.ji)(N,t,h)},()=>o.createElement(oH,{key:"local-variables"})),o.createElement(n2.VF,{isVisible:(0,nq.ww)(N,h)},()=>o.createElement(oE,{key:"local-styles",recordingKey:"local-styles",scrollContainer:v})),o.createElement(n2.VF,{isVisible:(0,nq.P1)(N,m)},()=>o.createElement(oC.LI,{key:"export",recordingKey:"exportsPanel",openFile:m,singleNodeName:oC.LI.singleNodeNameFrom(T),numSelected:T.numSelected,exportSettings:T.exportSettings,sceneGraphSelection:h,isSelectionRenamable:oC.LI.isSelectionRenamable(Object.keys(h)),currentPage:(0,n7.Nf)(t),dispatch:k,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:y,saveAsState:g,panelWidth:nq.iP})),o.createElement(n2.VF,{isVisible:!(0,nq.NR)(N)},()=>o.createElement(oR.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:d,publishedPlugins:_,allSavedPlugins:e.plugins,orgEntity:u,dispatch:k,openFileKey:m?.key||null,editorType:m?.editorType?(0,nY.wN)(m.editorType):null,numSelected:l().numSelected??0})),(0,s.kc)().jsx_debugging&&o.createElement(ok.A,null))}var oQ=n(814466),oJ=n(807835);function oj({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:c,localPlugins:d,modalShown:p,openFile:m,orgEntity:u,pickerInStyleCreationShown:E,pickerShown:y,publishedPlugins:_,saveAsState:g,sceneGraphSelection:h,scrollContainer:v,selectedStyleProperties:b,selectionPaints:S,selectionProperties:T,shownPanels:N,strokePanelMode:I,strokePanelTerminalPointCount:P,stylePickerListLayout:C,stylePickerShown:A}){let k=(0,r.wA)(),w=(0,f.md)(nJ.b),O=(0,oM.qh)(T);return o.createElement(n0.i,null,0===Object.keys(h).length&&o.createElement(of.Mw,{panelName:of.ON.DESIGN}),o.createElement(oJ._i,{recordingKey:"toolbarView",shouldShowComponentPropertiesPanel:(0,nq.tV)(N,T.stateGroupSelectionInfo),shouldShowInstancePanel:(0,nq.M0)(N),shouldShowVectorOperationPanel:(0,nq.jP)(T)}),o.createElement(n2.VF,{isVisible:(0,nq.jP)(T)},()=>o.createElement(oB,{key:"vectorOperation",recordingKey:"vectorOperationPanel",numSelected:T.numSelected})),o.createElement(n2.VF,{isVisible:(0,nq.tV)(N,T.stateGroupSelectionInfo)},()=>o.createElement(n6.BS,{key:"componentProperties",recordingKey:"propsPanel"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.COMPONENT_ITEM]},()=>o.createElement(ob.cu,{key:"component",recordingKey:"componentPanel"})),o.createElement(n2.VF,{isVisible:(0,nq.M0)(N)},()=>o.createElement(oA._,{key:"instance",recordingKey:"instancePanel"})),o.createElement(n2.VF,{isVisible:(0,nq.d6)(N)||N[i.ibQ.TRANSFORM_ITEM]},()=>o.createElement(oK.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:w,pickerShown:y,openFileKey:m?.key||null,canEditConstraints:(0,nq.GG)(N),onlyShowXYInputsRow:w===nj.GR.DEFAULT_SIMPLIFIED||(l().areOnlyResponsiveSetsSelected??!1)})),o.createElement(n2.VF,{isVisible:(0,nq.zp)(N,T,b,!0)},()=>o.createElement(oL.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:w===nj.GR.DEFAULT_SIMPLIFIED,onlyStacksSelected:!!N[i.ibQ.STACK_ITEM]})),o.createElement(nj.F$,{isVisible:N[i.ibQ.SCALE_ITEM]}),o.createElement(oP.Q,{selection:h,shownPanels:N,scaleShouldHideOtherPanels:(0,nq.NR)(N)}),o.createElement(n2.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(oV.r,{key:"template"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(o$.$,{key:"templateProperties",recordingKey:"templatePropsPanel"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.VECTOR_ITEM]},()=>o.createElement(oK.Ss,{isUI3:!0,key:"vector-transform",recordingKey:"vectorTransformPanel",x:T.x,y:T.y,cornerRadius:T.cornerRadius,handleMirroring:T.handleMirroring,dispatch:k,dropdownShown:a})),o.createElement(n2.VF,{isVisible:N[i.ibQ.MASK_ITEM]},()=>o.createElement(oO.B,{key:"mask",recordingKey:"maskPanel",maskType:l().maskType,dispatch:k,dropdownShown:a})),o.createElement(n2.VF,{isVisible:N[i.ibQ.LAYER_ITEM]},()=>o.createElement(oQ.X,{recordingKey:"appearancePanel"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.TYPE_ITEM]},()=>o.createElement(nj.gc,{key:"type",selectionProperties:T})),o.createElement(n2.VF,{isVisible:N[i.ibQ.CANVAS_ITEM]},()=>o.createElement(ov.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:T.backgroundColor,backgroundEnabled:T.backgroundEnabled,backgroundOpacity:T.backgroundOpacity,exportBackgroundDisabled:T.exportBackgroundDisabled,dispatch:k,dropdownShown:a,modalShown:p,editModeType:t.activeCanvasEditModeType,pickerShown:y,currentTool:t.currentTool,colorFormat:n,library:c,openFile:m,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:n5.rC,sceneGraphSelection:h,selectedStyleProperties:b,hasExports:!!T.exportSettings&&(0,n3._W)(T.exportSettings,[]).length>0})),o.createElement(n2.VF,{isVisible:N[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>o.createElement(oD.C,{key:"remove-group-fill-stroke"})),o.createElement(n2.VF,{isVisible:N[i.ibQ.FILL_ITEM]},()=>o.createElement(nj.B8,{key:"fill",selectionProperties:T,variableScopes:O})),o.createElement(n2.VF,{isVisible:N[i.ibQ.STROKE_ITEM]},()=>o.createElement(ox.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:A,strokePanelMode:I,strokePanelTerminalPointCount:P,strokePaints:T.strokePaints,borderSharedWeight:T.borderSharedWeight,strokeWeight:T.strokeWeight,strokeAlign:T.strokeAlign,strokeCap:T.strokeCap,strokeJoin:T.strokeJoin,miterLimitAngle:T.miterLimitAngle,connectorLineStyle:T.connectorLineStyle,leftEndCap:T.leftEndCap,rightEndCap:T.rightEndCap,maxStrokeWeight:T.maxStrokeWeight,dashPattern:T.dashPattern,dashCap:T.dashCap,terminalCap:T.terminalCap,arcRadius:T.arcRadius,arcSweep:T.arcSweep,numSelectedByType:T.numSelectedByType,dispatch:k,dropdownShown:a,modalShown:p,pickerShown:y,pickerInStyleCreationShown:E,stylePickerListLayout:C,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:n5.Em,inheritStyleKey:T.inheritFillStyleKeyForStroke||null,inheritStyleID:T.styleIdForStrokeFill||null,library:c,sceneGraphSelection:h,selectedStyleProperties:b,openFile:m,isPanelBodyCollapsedAtom:null})),o.createElement(n2.VF,{isVisible:N[i.ibQ.EFFECTS_ITEM]},()=>o.createElement(nj.w5,{key:"effects",selectionProperties:T})),o.createElement(n2.VF,{isVisible:(0,nq.fI)(N,(0,nq.NR)(N),S)},()=>o.createElement(ox.UA,{isUI3:!0,key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:S,dispatch:k,dropdownShown:a,sceneGraphSelection:h,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:y,stylePickerListLayout:C,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:n5.rC,library:c,openFile:m})),o.createElement(n2.VF,{isVisible:(0,nq.ji)(N,t,h)},()=>o.createElement(oH,{key:"local-variables"})),o.createElement(n2.VF,{isVisible:(0,nq.ww)(N,h)},()=>o.createElement(oE,{key:"local-styles",recordingKey:"local-styles",scrollContainer:v})),o.createElement(n2.VF,{isVisible:N[i.ibQ.GRIDS_ITEM]},()=>o.createElement(nj.tC,{key:"grids",selectionProperties:T})),o.createElement(n2.VF,{isVisible:(0,nq.P1)(N,m)},()=>o.createElement(oC.LI,{key:"export",recordingKey:"exportsPanel",openFile:m,singleNodeName:oC.LI.singleNodeNameFrom(T),numSelected:T.numSelected,exportSettings:T.exportSettings,isSelectionRenamable:oC.LI.isSelectionRenamable(Object.keys(h)),sceneGraphSelection:h,currentPage:(0,n7.Nf)(t),dispatch:k,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:y,saveAsState:g,panelWidth:nq.iP})),o.createElement(n2.VF,{isVisible:!(0,nq.NR)(N)},()=>o.createElement(oR.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:d,publishedPlugins:_,allSavedPlugins:e.plugins,orgEntity:u,dispatch:k,openFileKey:m?.key||null,editorType:m?.editorType?(0,nY.wN)(m.editorType):null,numSelected:l().numSelected??0})),(0,s.kc)().jsx_debugging&&o.createElement(ok.A,null))}function oq(e){let t=(0,r.wA)(),n=(0,em.GS)(),a=(0,eN.iZ)(),l=(0,er.J2)((0,nU.UK)().expandedFramePresetType);return(((0,nZ.Im)(e.shownPanels)||Object.keys(e.shownPanels).every(t=>!e.shownPanels[parseInt(t)]))&&!window.figmaPerfTesting&&!(0,nR.Lg)()&&!(0,nR.nl)()&&(0,n1.x1)("PropertiesPanel","Rendering design tab with no shownPropertiesPanels",{isEmpty:(0,nZ.Im)(e.shownPanels),shouldRenderInspectTab:(0,nq.S4)(e.appModel,a)}),e.shownPanels[i.ibQ.FRAME_PRESETS])?o.createElement(n0.i,null,o.createElement(n2.VF,{isVisible:!0},()=>o.createElement(n4.nl,{key:"frame-presets",recordingKey:"framePresetPanel",dispatch:t,expandedFramePresetType:l}))):e.shownPanels[i.ibQ.PENCIL_TOOL]?o.createElement(n0.i,null,o.createElement(n2.VF,{isVisible:!0},()=>o.createElement(n8.q,{key:"pencilToolPanel",recordingKey:"pencilToolPanel",id:"pencilToolPanel",openFile:e.openFile}))):n?o.createElement(oj,{...e}):o.createElement(oX,{...e})}var oZ=n(268853),o0=n(435225);function o1({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:s,localPlugins:c,modalShown:d,openFile:p,orgEntity:m,pickerInStyleCreationShown:u,pickerShown:E,publishedPlugins:y,saveAsState:_,sceneGraphSelection:g,selectedStyleProperties:h,selectionPaints:v,selectionProperties:b,shownPanels:S,strokePanelMode:T,strokePanelTerminalPointCount:N,stylePickerListLayout:I,stylePickerShown:P}){let C=(0,r.wA)(),[A,k]=(0,f.fp)(nJ.b);return o.createElement(n0.i,null,(0,nq.d6)(S)&&o.createElement(oh.AV,{recordingKey:"alignPanel"}),o.createElement(n2.VF,{isVisible:!0},()=>o.createElement(oK.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:A,pickerShown:E,openFileKey:p?.key||null,canEditConstraints:!1,onlyShowXYInputsRow:!1})),o.createElement(nj.F$,{isVisible:S[i.ibQ.SCALE_ITEM]}),o.createElement(n2.VF,{isVisible:!(0,nq.NR)(S)},()=>o.createElement(oA._,{key:"instance",recordingKey:"instancePanel"})),o.createElement(n2.VF,{isVisible:(0,nq.GG)(S)},()=>o.createElement(oI,{key:"constraints",recordingKey:"constraintsPanel",openFileKey:p?.key||null,dropdownShown:a})),o.createElement(n2.VF,{isVisible:S[i.ibQ.LAYER_ITEM]},()=>o.createElement(ow.s,{key:"layer",recordingKey:"layerPanel",blendMode:b.blendMode,opacity:b.opacity,visible:b.visible,variableConsumptionInfo:b.variableConsumptionInfo})),A===nj.GR.DEFAULT_SIMPLIFIED&&o.createElement(o0.Y,{onExpand:()=>k(nj.GR.OVERRIDDEN_EXPANDED)}),A===nj.GR.OVERRIDDEN_EXPANDED&&o.createElement(o.Fragment,null,o.createElement(oP.Q,{selection:g,shownPanels:S,scaleShouldHideOtherPanels:(0,nq.NR)(S)}),o.createElement(n2.VF,{isVisible:S[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(oV.r,{key:"template"})),o.createElement(n2.VF,{isVisible:S[i.ibQ.COMPONENT_ITEM]},()=>o.createElement(ob.cu,{key:"component",recordingKey:"componentPanel"})),o.createElement(n2.VF,{isVisible:S[i.ibQ.VECTOR_ITEM]},()=>o.createElement(oK.Ss,{key:"vector-transform",recordingKey:"vectorTransformPanel",x:b.x,y:b.y,cornerRadius:b.cornerRadius,handleMirroring:b.handleMirroring,dispatch:C,dropdownShown:a,isUI3:!1})),o.createElement(n2.VF,{isVisible:(0,nq.zp)(S,b,h,!1)},()=>o.createElement(oL.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:!1,onlyStacksSelected:!!S[i.ibQ.STACK_ITEM]})),o.createElement(n2.VF,{isVisible:S[i.ibQ.MASK_ITEM]},()=>o.createElement(oO.B,{key:"mask",recordingKey:"maskPanel",maskType:l().maskType,dispatch:C,dropdownShown:a})),o.createElement(n2.VF,{isVisible:S[i.ibQ.GRIDS_ITEM]},()=>o.createElement(nj.tC,{key:"grids",selectionProperties:b})),o.createElement(n2.VF,{isVisible:S[i.ibQ.TYPE_ITEM]},()=>o.createElement(nj.gc,{key:"type",selectionProperties:b})),o.createElement(n2.VF,{isVisible:S[i.ibQ.CANVAS_ITEM]},()=>o.createElement(ov.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:b.backgroundColor,backgroundEnabled:b.backgroundEnabled,backgroundOpacity:b.backgroundOpacity,exportBackgroundDisabled:b.exportBackgroundDisabled,dispatch:C,dropdownShown:a,modalShown:d,editModeType:t.activeCanvasEditModeType,pickerShown:E,currentTool:t.currentTool,colorFormat:n,library:s,openFile:p,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:n5.rC,sceneGraphSelection:g,selectedStyleProperties:h,hasExports:!!b.exportSettings&&(0,n3._W)(b.exportSettings,[]).length>0})),o.createElement(n2.VF,{isVisible:S[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>o.createElement(oD.C,{key:"remove-group-fill-stroke"})),o.createElement(n2.VF,{isVisible:S[i.ibQ.FILL_ITEM]},()=>o.createElement(nj.B8,{key:"fill",selectionProperties:b,variableScopes:(0,oM.og)(b)})),o.createElement(n2.VF,{isVisible:S[i.ibQ.STROKE_ITEM]},()=>o.createElement(ox.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:P,strokePanelMode:T,strokePanelTerminalPointCount:N,strokePaints:b.strokePaints,borderSharedWeight:b.borderSharedWeight,strokeWeight:b.strokeWeight,strokeAlign:b.strokeAlign,strokeCap:b.strokeCap,strokeJoin:b.strokeJoin,miterLimitAngle:b.miterLimitAngle,connectorLineStyle:b.connectorLineStyle,leftEndCap:b.leftEndCap,rightEndCap:b.rightEndCap,maxStrokeWeight:b.maxStrokeWeight,dashPattern:b.dashPattern,dashCap:b.dashCap,terminalCap:b.terminalCap,arcRadius:b.arcRadius,arcSweep:b.arcSweep,numSelectedByType:b.numSelectedByType,dispatch:C,dropdownShown:a,modalShown:d,pickerShown:E,pickerInStyleCreationShown:u,stylePickerListLayout:I,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:n5.Em,inheritStyleKey:b.inheritFillStyleKeyForStroke||null,inheritStyleID:b.styleIdForStrokeFill||null,library:s,sceneGraphSelection:g,selectedStyleProperties:h,openFile:p,isPanelBodyCollapsedAtom:null})),o.createElement(n2.VF,{isVisible:!0},()=>o.createElement(ox.UA,{key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:v,dispatch:C,dropdownShown:a,sceneGraphSelection:g,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:E,stylePickerListLayout:I,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:n5.rC,library:s,openFile:p,isUI3:!1})),o.createElement(n2.VF,{isVisible:S[i.ibQ.EFFECTS_ITEM]},()=>o.createElement(nj.w5,{key:"effects",selectionProperties:b})),o.createElement(n2.VF,{isVisible:!(0,nq.NR)(S)},()=>o.createElement(oR.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:y,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,nY.wN)(p.editorType):null,numSelected:l().numSelected??0}))),o.createElement(n2.VF,{isVisible:(0,nq.P1)(S,p)},()=>o.createElement(oC.LI,{key:"export",recordingKey:"exportsPanel",openFile:p,singleNodeName:oC.LI.singleNodeNameFrom(b),numSelected:b.numSelected,exportSettings:b.exportSettings,sceneGraphSelection:g,currentPage:(0,n7.Nf)(t),isSelectionRenamable:oC.LI.isSelectionRenamable(Object.keys(g)),dispatch:C,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:E,saveAsState:_,panelWidth:nq.iP})),o.createElement(n2.VF,{isVisible:!(0,nq.NR)(S)},()=>o.createElement(oR.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:y,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,nY.wN)(p.editorType):null,numSelected:l().numSelected??0})))}function o2({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:s,localPlugins:c,modalShown:d,openFile:p,orgEntity:m,pickerInStyleCreationShown:u,pickerShown:E,publishedPlugins:y,saveAsState:_,sceneGraphSelection:g,selectedStyleProperties:h,selectionPaints:v,selectionProperties:b,shownPanels:S,strokePanelMode:T,strokePanelTerminalPointCount:N,stylePickerListLayout:I,stylePickerShown:P}){let C=(0,r.wA)(),[A,k]=(0,f.fp)(nJ.b);return o.createElement(n0.i,null,0===Object.keys(g).length&&o.createElement(of.Mw,{panelName:of.ON.DESIGN}),o.createElement(oJ._i,{recordingKey:"toolbarView",shouldShowComponentPropertiesPanel:(0,nq.tV)(S,b.stateGroupSelectionInfo),shouldShowInstancePanel:(0,nq.M0)(S)}),o.createElement(n2.VF,{isVisible:!(0,nq.NR)(S)},()=>o.createElement(oA._,{key:"instance",recordingKey:"instancePanel"})),o.createElement(n2.VF,{isVisible:!0},()=>o.createElement(oK.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:A,pickerShown:E,openFileKey:p?.key||null,canEditConstraints:(0,nq.GG)(S),onlyShowXYInputsRow:A===nj.GR.DEFAULT_SIMPLIFIED||(l().areOnlyResponsiveSetsSelected??!1)})),o.createElement(n2.VF,{isVisible:(0,nq.zp)(S,b,h,!0)},()=>o.createElement(oL.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:A===nj.GR.DEFAULT_SIMPLIFIED,onlyStacksSelected:!!S[i.ibQ.STACK_ITEM]})),o.createElement(nj.F$,{isVisible:S[i.ibQ.SCALE_ITEM]}),A===nj.GR.DEFAULT_SIMPLIFIED&&o.createElement(o0.Y,{onExpand:()=>k(nj.GR.OVERRIDDEN_EXPANDED)}),A===nj.GR.OVERRIDDEN_EXPANDED&&o.createElement(o.Fragment,null,o.createElement(n2.VF,{isVisible:S[i.ibQ.LAYER_ITEM]},()=>o.createElement(oQ.X,{recordingKey:"appearancePanel"})),o.createElement(oP.Q,{selection:g,shownPanels:S,scaleShouldHideOtherPanels:(0,nq.NR)(S)}),o.createElement(n2.VF,{isVisible:S[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(oV.r,{key:"template"})),o.createElement(n2.VF,{isVisible:S[i.ibQ.COMPONENT_ITEM]},()=>o.createElement(ob.cu,{key:"component",recordingKey:"componentPanel"})),o.createElement(n2.VF,{isVisible:S[i.ibQ.VECTOR_ITEM]},()=>o.createElement(oK.Ss,{isUI3:!0,key:"vector-transform",recordingKey:"vectorTransformPanel",x:b.x,y:b.y,cornerRadius:b.cornerRadius,handleMirroring:b.handleMirroring,dispatch:C,dropdownShown:a})),o.createElement(n2.VF,{isVisible:S[i.ibQ.MASK_ITEM]},()=>o.createElement(oO.B,{key:"mask",recordingKey:"maskPanel",maskType:l().maskType,dispatch:C,dropdownShown:a})),o.createElement(n2.VF,{isVisible:S[i.ibQ.TYPE_ITEM]},()=>o.createElement(nj.gc,{key:"type",selectionProperties:b})),o.createElement(n2.VF,{isVisible:S[i.ibQ.CANVAS_ITEM]},()=>o.createElement(ov.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:b.backgroundColor,backgroundEnabled:b.backgroundEnabled,backgroundOpacity:b.backgroundOpacity,exportBackgroundDisabled:b.exportBackgroundDisabled,dispatch:C,dropdownShown:a,modalShown:d,editModeType:t.activeCanvasEditModeType,pickerShown:E,currentTool:t.currentTool,colorFormat:n,library:s,openFile:p,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:n5.rC,sceneGraphSelection:g,selectedStyleProperties:h,hasExports:!!b.exportSettings&&(0,n3._W)(b.exportSettings,[]).length>0})),o.createElement(n2.VF,{isVisible:S[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>o.createElement(oD.C,{key:"remove-group-fill-stroke"})),o.createElement(n2.VF,{isVisible:S[i.ibQ.FILL_ITEM]},()=>o.createElement(nj.B8,{key:"fill",selectionProperties:b,variableScopes:(0,oM.og)(b)})),o.createElement(n2.VF,{isVisible:S[i.ibQ.STROKE_ITEM]},()=>o.createElement(ox.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:P,strokePanelMode:T,strokePanelTerminalPointCount:N,strokePaints:b.strokePaints,borderSharedWeight:b.borderSharedWeight,strokeWeight:b.strokeWeight,strokeAlign:b.strokeAlign,strokeCap:b.strokeCap,strokeJoin:b.strokeJoin,miterLimitAngle:b.miterLimitAngle,connectorLineStyle:b.connectorLineStyle,leftEndCap:b.leftEndCap,rightEndCap:b.rightEndCap,maxStrokeWeight:b.maxStrokeWeight,dashPattern:b.dashPattern,dashCap:b.dashCap,terminalCap:b.terminalCap,arcRadius:b.arcRadius,arcSweep:b.arcSweep,numSelectedByType:b.numSelectedByType,dispatch:C,dropdownShown:a,modalShown:d,pickerShown:E,pickerInStyleCreationShown:u,stylePickerListLayout:I,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:n5.Em,inheritStyleKey:b.inheritFillStyleKeyForStroke||null,inheritStyleID:b.styleIdForStrokeFill||null,library:s,sceneGraphSelection:g,selectedStyleProperties:h,openFile:p,isPanelBodyCollapsedAtom:null})),o.createElement(n2.VF,{isVisible:S[i.ibQ.EFFECTS_ITEM]},()=>o.createElement(nj.w5,{key:"effects",selectionProperties:b})),o.createElement(n2.VF,{isVisible:(0,nq.fI)(S,(0,nq.NR)(S),v)},()=>o.createElement(ox.UA,{isUI3:!0,key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:v,dispatch:C,dropdownShown:a,sceneGraphSelection:g,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:E,stylePickerListLayout:I,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:n5.rC,library:s,openFile:p})),o.createElement(n2.VF,{isVisible:S[i.ibQ.GRIDS_ITEM]},()=>o.createElement(nj.tC,{key:"grids",selectionProperties:b})),o.createElement(n2.VF,{isVisible:(0,nq.P1)(S,p)},()=>o.createElement(oC.LI,{key:"export",recordingKey:"exportsPanel",openFile:p,singleNodeName:oC.LI.singleNodeNameFrom(b),isSelectionRenamable:oC.LI.isSelectionRenamable(Object.keys(g)),numSelected:b.numSelected,exportSettings:b.exportSettings,sceneGraphSelection:g,currentPage:(0,n7.Nf)(t),dispatch:C,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:E,saveAsState:_,panelWidth:nq.iP})),o.createElement(n2.VF,{isVisible:!(0,nq.NR)(S)},()=>o.createElement(oR.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:y,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,nY.wN)(p.editorType):null,numSelected:l().numSelected??0}))),o.createElement(n2.VF,{isVisible:!(0,nq.NR)(S)},()=>o.createElement(oR.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:y,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,nY.wN)(p.editorType):null,numSelected:l().numSelected??0})))}function o4(e){let t=(0,em.GS)();if((0,nZ.Im)(e.shownPanels)||Object.keys(e.shownPanels).every(t=>!e.shownPanels[parseInt(t)])){let e=Error("Rendering simplified design tab with no shownPropertiesPanels");(0,n1.$D)(oZ.e.EDITOR_USABILITY,e)}return t?o.createElement(o2,{...e}):o.createElement(o1,{...e})}function o8({scrollContainer:e,...t}){let n=(0,f.md)(nJ.b),a=(0,nQ.Yo)(),r=()=>(0,nq.RB)(t.selectedStyleProperties)?t.selectedStyleProperties:t.selectionProperties;return n===nj.GR.DEFAULT_EXPANDED?o.createElement(oq,{...t,getContextualSelectionProperties:r,orgEntity:a,scrollContainer:e}):o.createElement(o4,{...t,getContextualSelectionProperties:r,orgEntity:a})}var o3=n(507956);function o5({appModel:e,dropdownShown:t,pickerShown:n,saveAsState:a,sceneGraphSelection:l,selectedStyleProperties:i,selectionProperties:s}){let c=(0,r.wA)(),d=(0,F.q5)(),p=(0,n7.Nf)(e),m=(0,o3.ks)(),u=e.isReadOnly&&!m,E=(0,nq.RB)(i)?i:s;return o.createElement(n2.VF,{isVisible:!0},()=>o.createElement(oC.LI,{key:"export",title:u?(0,T.t)("fullscreen.properties_panel.export"):(0,T.t)("fullscreen.properties_panel.presets"),standalone:!0,openFile:d,singleNodeName:oC.LI.singleNodeNameFrom(E),isSelectionRenamable:oC.LI.isSelectionRenamable(Object.keys(l)),numSelected:E.numSelected,exportSettings:E.exportSettings,sceneGraphSelection:l,currentPage:p,dispatch:c,dropdownShown:t,currentSelectedProperty:e.currentSelectedProperty,pickerShown:n,recordingKey:"exportsPanel",saveAsState:a,panelWidth:nq.iP}))}var o7=n(126590),o6=n(143678),o9=n(889449),re=n(853497);function rt({selectionProperties:e,scrollContainer:t}){let n=(0,F.q5)(),a=(0,U.KH)(),r=!e.prototypeStartingPointsInfo||e.prototypeStartingPointsInfo?.length>0,l=0===Object.keys(a).length,i=n?.canEdit,s=o.createElement(n2.VF,{isVisible:l&&!i&&r},()=>o.createElement(re.A,{viewOnly:!0})),c=o.createElement(n2.VF,{isVisible:l},()=>o.createElement(oE,{key:"code-local-styles",recordingKey:"code-local-styles",scrollContainer:t}));return o.createElement(R.fu,{name:o6.e0.CODE_PANEL},o.createElement(n0.i,null,o.createElement(of.Mw,{panelName:of.ON.INSPECT}),o.createElement(o9.U,{key:"inspection-properties-panel",recordingKey:"inspectionPanel",flowPanel:s,localStylesPanel:c})))}var rn=n(698338),ra=n(57860),ro=n(326331),rr=n(977750),rl=n(189904),ri=n(523047),rs=n(335601),rc=n(743282),rd=n(239349),rp=n(662275),rm=n(218973),ru=n(158950),rE=n(60088),ry=n(343559),r_=n(561598),rg=n(822397),rh=n(198868),rf=n(802926),rv=n(269900),rb=n(429308),rS=n(90115);async function rT(e,t){let n=await (0,r_.vd)(e),a=await (0,r_.vd)(t),o=(await rS.Ay.design.getTextImageEmbeds({model:"clip-huge-shared",input:{images:[n,a]}})).encoded_images;if(!o||2!==o.length)throw Error("Expected two embedding vectors in the response");let r=o[0],l=o[1];if(!r||!l)throw Error("Embedding vectors must not be undefined");return(0,rb.Lb)(r,l)}async function rN(e,t){e(d.F.clearAll());let n=te.UN().getCurrentPage()?.childrenNodes.filter(e=>"SECTION"===e.type&&1===e.childrenNodes.length);if(!n||0===n.length){e(d.F.enqueue({message:(0,T.t)("living_designs.eval.error"),error:!0}));return}let a=t1.l7.ai(r_.p1,()=>{let e=(0,te.UN)().createNode("CANVAS");return e.name=`Eval - ${new Date().toLocaleString()}`,e});await (0,te.UN)().setCurrentPageAsync(a.guid);let o=t.evaluationRuns,r=o*n.length;e(d.F.enqueue({type:"living-designs-evals",message:(0,T.t)("living_designs.eval.progress",{completed:0,total:r}),timeoutOverride:1/0}));try{let a=0,l=n.flatMap((e,t)=>Array.from({length:o}).map((n,a)=>{var r;let l=t*o+a;return r=(e.absoluteRenderBounds.w+(l>0?40:0))*l,t1.l7.ai(r_.p1,()=>{let t=e.clone(),n=(0,te.UN)().get(t);n.relativeTransform={...n.relativeTransform,m02:r};let a=e.clone(),o=(0,te.UN)().get(a);o.relativeTransform={...o.relativeTransform,m02:r},o.name="Output: "+e.name,o.y=e.y+e.size.y+40,o.size={x:o.size.x,y:3*o.size.y},o.childrenNodes[0].removeSelfAndChildren();let l=n.childrenNodes[0];if(!l)throw Error("Failed to clone node");return{nodeToEval:l,inputSection:n,outputSection:o}})})),i=(0,rh.D)();i.viewport.scrollAndZoomIntoView(l.flatMap(({inputSection:e,outputSection:t})=>[e,t].map(e=>i.getNodeById(e.guid)).filter(e=>null!==e)));let s=l.map(async({nodeToEval:n,outputSection:o})=>{let l=await rI(n,o,t);return a++,e(d.F.enqueue({type:"living-designs-evals",message:(0,T.t)("living_designs.eval.progress",{completed:a,total:r}),timeoutOverride:1/0})),l}),c=(await Promise.all(s)).map(({metrics:e})=>e),p=function(e){let t=e.reduce((e,t)=>e+t.imageToImageSimilarity,0)/e.length,n=e.length,a=e.filter(e=>e.error).length;return{avgImageToImageSimilarity:t,numTestCases:n,numFailures:a,failureRate:a/n}}(c),m=l[0]?.inputSection;if(!m)throw Error("No sections were prepared for evaluation.");t1.l7.ai(r_.p1,()=>(function(e,t){let n=e.clone(),a=(0,te.UN)().get(n);a.childrenNodes[0].removeSelfAndChildren(),a.relativeTransform={...a.relativeTransform,m02:e.absoluteRenderBounds.w},a.name="Aggregate Metrics",a.x=e.x-e.size.x-40,a.y=e.y;let o=(0,te.UN)().createNode("TEXT");o.spliceCharacters(0,0,`Aggregate Metrics: ${JSON.stringify(t,(e,t)=>"number"!=typeof t||Number.isInteger(t)?t:t.toFixed(3),2)}`,"BEFORE"),o.x=0,o.size.x=a.size.x,o.y=10,a.appendChild(o),o.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],o.fontSize=40})(m,p)),e(d.F.enqueue({type:"living-designs-evals",message:(0,T.t)("living_designs.eval.finished")}))}catch(t){a.removeSelfAndChildren(),e(d.F.enqueue({type:"living-designs-evals",message:(0,T.t)("living_designs.eval.error"),error:!0}))}}async function rI(e,t,n){!function e(t){for(let n of t.childrenNodes)e(n);t.annotations.length>0&&((0,r_.Ww)(t,{...(0,r_.u6)(t),messages:t.annotations.map(e=>({id:(0,rc.g)(),createdAt:Date.now(),content:e.label}))}),t.annotations.splice(0,t.annotations.length))}(e);let a=e.size,o={x:t.size.x/2-a.x/2,y:40},r=f.zl.get(rg.Zl).serializer,{html:l,styles:i}=await (0,r_.li)(e,r,(0,rg.Lf)(e).map(e=>e.nodeId));if("sites"===r&&l){let n=await (0,rf.Is)(l),r=await (0,rf.zG)(n);rP({name:"HTML",imageSet:(await (0,rv.l)({code:r,width:e.size.x??0,height:e.size.y??0,props:{},styleOverride:i})).imageSet,sources:[{code:l,language:"TYPESCRIPT"},{code:i,language:"CSS"}],position:o,size:a,outputSection:t})}let{generatedCode:s,nodesWithProps:c,errorMessage:d}=await (0,rg.kX)(e,{initialBackoffDelay:n.evalBackoffDelay});if(!s||!c)return t1.l7.ai(r_.p1,()=>{let e=(0,te.UN)().createNode("FRAME");e.size=a,e.x=o.x,e.y=o.y,t.appendChild(e);let n=(0,te.UN)().createNode("TEXT");n.spliceCharacters(0,0,d??(0,T.t)("living_designs.eval.error"),"BEFORE"),n.size=e.size,n.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],e.fills=[{type:"SOLID",color:{r:1,g:0,b:0,a:1}}],e.appendChild(n)}),{outputSection:t,metrics:{imageToImageSimilarity:0,error:!0}};let p=await (0,rf.Is)(s),m=await (0,rf.zG)(p),u=await (0,rv.l)({code:m,width:e.size.x??0,height:e.size.y??0,props:(0,rg.IL)((0,te.UN)(),c),styleOverride:i}),E=await rP({name:"Generated",imageSet:u.imageSet,sources:[{code:s,language:"TYPESCRIPT"},{code:i,language:"CSS"}],position:o,size:a,outputSection:t}),y=await rT(e,E);return t1.l7.ai(r_.p1,()=>{let e=(0,te.UN)().createNode("TEXT");e.spliceCharacters(0,0,`Image-Image Similarity: ${y.toFixed(2)}`,"BEFORE"),e.x=0,e.size.x=E.size.x,e.y=10,t.appendChild(e),e.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],e.fontSize=40}),{outputSection:t,metrics:{imageToImageSimilarity:y,error:!1}}}async function rP({name:e,imageSet:t,sources:n,position:a,size:o,outputSection:r}){let l=[],i=20,s=t1.l7.ai(r_.p1,()=>{let s=(0,te.UN)().createNode("FRAME");s.size=o,s.x=i,s.y=a.y,s.insertImageInFillPaint(t),s.name=e,i+=o.x+40;let c=(r.size.x-i)/n.length-40;for(let t of n){let n=(0,te.UN)().createNode("FRAME");n.name=e+" Code",n.size={x:c,y:o.y},n.x=i,n.y=a.y,n.frameMaskDisabled=!1,r.appendChild(n);let d=(0,te.UN)().createNode("CODE_BLOCK");l.push([d.guid,t]),n.appendChild(d),r.appendChild(s),i+=c+40}return s}),c=(0,rh.D)();for(let[e,t]of l){await c.loadFontAsync({family:"Source Code Pro",style:"Medium"});let n=c.getNodeById(e);n.code=t.code,n.codeLanguage=t.language}return a.y+=o.y+40,s}var rC=n(602354),rA=n(940319);async function rk(e){let t=(0,rh.D)(),n=new Map,a=RegExp("url\\(['\"]?(.+?)['\"]?\\)","g");for(let o of e.matchAll(a)){let e;let a=o[1];if(!a)continue;try{e=new URL(a)}catch(e){continue}let r=new URLSearchParams(e.hash.slice(1)).get("filename");if(!r||!r.endsWith(".png"))continue;let l=r.slice(0,-4),i=t.getImageByHash(l);if(!i)continue;let s=await i.getBytesAsync();if(!s)continue;let c=new Blob([s],{type:"image/png"}),d=await function(e){return new Promise((t,n)=>{let a=new FileReader;a.onloadend=()=>{let e=a.result;if("string"==typeof e){t(e);return}n(Error("Failed to convert blob to base64"))},a.onerror=n,a.readAsDataURL(e)})}(c);n.set(o.index,d)}return e.replace(a,(e,t,a)=>e.replace(t,n.get(a)??t))??e}var rw=n(237870),rO=n(32067),rx=n(547583),rD=n(746806),rR=n(711490),rM=n(502601),rL=n(908604),rV=n(20484);let rK="LivingDesignsModal",rU=(0,rw.Ju)(function({initialSize:e}){let t=(0,r.wA)(),[n,a]=(0,o.useState)(0),l=(0,rV.ts)(e,rB),[i,s]=rC.tU.useTabs({preview:!0,code:!0,debug:!0});if(!l)return null;let{width:c,setWidth:d,height:p,setHeight:m,minWidth:u,minHeight:E,position:y,setPosition:_}=l,g=o.createElement(rC.tU.TabStrip,{manager:s},o.createElement(rC.tU.Tab,{...i.preview},(0,T.t)("living_designs.modal.tabs.preview")),o.createElement(rC.tU.Tab,{...i.code},(0,T.t)("living_designs.modal.tabs.code")),o.createElement(rC.tU.Tab,{...i.debug},(0,T.t)("living_designs.modal.tabs.debug"))),h=o.createElement(tT.K,{onClick:()=>a(e=>e+1),"aria-label":(0,T.t)("living_designs.modal.refresh")},o.createElement(rA._,null));return o.createElement(rM.Q,null,o.createElement(rG.Provider,{value:{tabPropsMap:i,tabManager:s}},o.createElement(rD.BL,{customButton:h,title:g,position:y,allowResizeHeight:!0,allowResizeWidth:!0,dragHeaderOnly:!0,fullFrame:!0,height:p,width:c,minWidth:u,minHeight:E,setWidth:d,setHeight:m,setPosition:_,onClose:()=>{t((0,rp.ES)({type:rK}))},overflowHidden:!0},o.createElement(rY,{key:n,size:{x:c,y:p}}))))},rK),rF={x:400,y:400},rB={x:260,y:80},rG=o.createContext(void 0),rz=()=>{let e=o.useContext(rG);if(!e)throw Error("usePreviewContext must be used within a PreviewContext.Provider");return e};function rY({size:e}){let{isResizing:t,isDragging:n}=o.useContext(rR.O);return o.createElement(rH,{disablePointerEvents:t||n,size:e})}var rW=(e=>(e.None="none",e.Generating="generating",e.Bundling="bundling",e.Ready="ready",e.Error="error",e))(rW||{});function rH({disablePointerEvents:e,size:t}){let n=(0,rO.VW)(),a=(0,r_.L4)(),r=(0,r_.Jp)(),l=(0,aa.PD)(r),i=n?.guid?r:l,[s,c]=(0,f.fp)((0,rg.R)(a?.guid||"")),[d,p]=(0,o.useState)(null),[m,u]=(0,o.useState)(""),{tabPropsMap:E}=rz(),y=(0,z.Fk)(rg.IL,i?.generation?.nodesWithProps||[]);(0,o.useEffect)(()=>{let e=i?.generation;if(!e||"idle"!==s.status){p(null),u("");return}!async function(){let t=Promise.all([rk(e.code),rk(e.styles)]),[n,a]=await t,o=await (0,rf.Is)(n);p(await (0,rf.zG)(o)),u(a)}()},[i?.generation,s]);let _="idle"===s.status&&i?.generation?.code?d?"ready":"bundling":"loading"===s.status?"generating":"none";return o.createElement("div",{className:S.cx.wFull.hFull.relative.$},o.createElement(rC.tU.TabPanel,{...E.preview},o.createElement("div",{className:S.cx.absolute.top0.right0.bottom0.left0.$},"none"===_&&o.createElement("div",{className:S.cx.flex.hFull.wFull.itemsCenter.justifyCenter.$},(0,T.t)("living_designs.preview.no_design")),"generating"===_&&o.createElement("div",{className:S.cx.flex.hFull.wFull.itemsCenter.justifyCenter.flexColumn.$},o.createElement("div",null,(0,T.t)("living_designs.preview.generating")),o.createElement(ra.k,null)),"bundling"===_&&o.createElement("div",{className:S.cx.flex.hFull.wFull.itemsCenter.justifyCenter.flexColumn.$},o.createElement("div",null,(0,T.t)("living_designs.preview.bundling")),o.createElement(ra.k,null)),"ready"===_&&o.createElement(rL.e,{disablePointerEvents:e,code:d,props:y,styles:m,size:{x:t.x,y:t.y},withReset:!0,onError:e=>c({status:"idle",errorMessage:e.message}),scaleLinearly:!0}),"idle"===s.status&&s.errorMessage&&o.createElement("div",{className:S.cx.absolute.left0.right0.bottom0.h24.flex.justifyBetween.itemsCenter.bt1.bSolid.colorBorder.p12.colorBgDanger.colorTextOndanger.$},(0,T.t)("living_designs.preview.error",{error:s.errorMessage||"Unknown"})))),o.createElement(rC.tU.TabPanel,{...E.code},o.createElement("textarea",{readOnly:!0,className:S.cx.absolute.top0.right0.bottom0.left0.$,value:i?.generation?.code||"No code available"})),o.createElement(rC.tU.TabPanel,{...E.debug},o.createElement("div",{className:S.cx.absolute.top0.right0.bottom0.left0.overflowYScroll.$},o.createElement(rx.p,{data:i?.generation}))))}var r$=n(140686),rX=n(973149),rQ=n(499777),rJ=n(420186),rj=n(72875),rq=n(538697),rZ=n(994481);let r0=new rX.KD({}),r1=e=>e.replace(/([A-Z])/g," $1").toLowerCase().replace(/^./,e=>e.toUpperCase()).trim();function r2({prop:e,onChange:t}){switch(e.type){case"number":return o.createElement(r4,{prop:e,onChange:t});case"color":return o.createElement(r8,{prop:e,onChange:t});case"string":return o.createElement(r3,{prop:e,onChange:t});case"enum":return o.createElement(r5,{prop:e,onChange:t});case"boolean":return o.createElement(r7,{prop:e,onChange:t});default:return null}}function r4({prop:e,onChange:t}){let n=(0,r.wA)();return o.createElement(rZ.cS,{label:r1(e.name),input:o.createElement(rm.j5,{value:e.value??e.defaultValue??0,onValueChange:e=>t(e),formatter:r0,dispatch:n,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":r1(e.name)})})}function r8({prop:e,onChange:t}){let n=(0,r.wA)(),a=(0,rQ.Xo)(),l=o.useRef(null),i=(0,t2.H0)(e.value??e.defaultValue??"#ffffff")||{r:1,g:1,b:1,a:1},s={type:"SOLID",color:i,opacity:i.a?i.a:1};return o.createElement("div",null,a?.id===`living-design-prop-${e.name}-color-picker`&&o.createElement(rj.h3,{disabledVariableIds:new Set,initialPosition:new tS.Mi(a.initialX,a.initialY),color:i,boundVariable:null,onChange:e=>t((0,t2.YU)(e)),onClose:()=>n(ed.XE())}),o.createElement(rZ.cS,{label:r1(e.name),input:o.createElement("div",{className:"living_designs_props--colorValueContainer--nPsog paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t",ref:l},o.createElement(ox.y7,{paint:s,onChange:e=>{let n=e.color;n&&(void 0!==e.opacity&&(n.a=e.opacity),t((0,t2.YU)(n)))},togglePicker:()=>{if(!l.current)return;let{x:t,y:a}=(0,rJ.cn)(l.current);n(ed.u1({id:`living-design-prop-${e.name}-color-picker`,initialX:t,initialY:a}))}}))}))}function r3({prop:e,onChange:t}){return o.createElement(rZ.cS,{label:r1(e.name),input:o.createElement(ab.ks,{value:e.value??e.defaultValue??"",onChange:e=>t(e.currentTarget.value)})})}function r5({prop:e,onChange:t}){let n=(0,r.wA)(),a=(0,a0.Um)();return o.createElement(rZ.cS,{label:r1(e.name),input:o.createElement(rq.l6,{property:e.value??e.defaultValue??"",onChange:e=>t(e),id:`living-design-prop-${e.name}`,dispatch:n,dropdownShown:a,formatter:{format:e=>e}},e.options?.map(e=>o.createElement(rq.c$,{key:e,value:e},e)))})}function r7({prop:e,onChange:t}){return o.createElement(rZ.cS,{label:r1(e.name),input:o.createElement(r$.S,{checked:e.value??e.defaultValue??!1,onChange:e=>t(e),label:o.createElement(tI.h,null,r1(e.name))})})}var r6=n(320986),r9=n(289298);function le(e,t){return t.map(t=>({displayText:t,callback(){f.zl.set(rg.f3,{provider:e,modelId:t})}}))}let lt=[{displayText:"Anthropic",children:le("anthropic",["claude-3-5-sonnet-20240620","claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-5-sonnet-20241022","claude-3-haiku-20240307"])},{displayText:"OpenAI",children:le("openai",["ft:gpt-4o-2024-08-06:figma-development::A95wrEFE:ckpt-step-732","gpt-3.5-turbo","gpt-3.5-turbo-0301","gpt-3.5-turbo-0613","gpt-3.5-turbo-1106","gpt-3.5-turbo-0125","gpt-3.5-turbo-16k","gpt-3.5-turbo-16k-0613","gpt-4","gpt-4-0314","gpt-4-0613","gpt-4-32k","gpt-4-32k-0314","gpt-4-32k-0613","gpt-4-1106-preview","gpt-4-vision-preview","gpt-4-turbo-2024-04-09","gpt-4o-2024-05-13","gpt-4o-2024-08-06","gpt-4o-mini-2024-07-18","o1-preview-2024-09-12","o1-mini-2024-09-12"])}];function ln(){let{toggleDropdown:e,dropdownTargetRef:t,Dropdown:n,isDropdownShown:a}=(0,rE.B)(),r=(0,f.md)(rg.f3);return o.createElement(o.Fragment,null,a&&o.createElement(n,{items:lt,showPoint:!0,lean:"left"}),o.createElement("div",{ref:t},o.createElement(aT.E,{className:S.cx.wFull.flex.alignCenter.justifyBetween.cursorPointer.b1.colorBorder.bRadius4.$,onClick:e},o.createElement("span",{className:S.cx.p4.$},null==r?"Pick a model":r.modelId),o.createElement(aA.U,{svg:r9.A},o.createElement(ro.r,null)))))}function la(){let e=(0,rd.VW)(),t=(0,r_.L4)(),n=(0,r_.Vq)(),[a,l]=o.useState(""),i=(0,r.wA)(),s=(0,f.md)((0,rg.R)(t?.guid||""));if(!e||!n)return o.createElement(ll,null);let c=()=>{a.length&&(l(""),(0,r_.Ww)(e,e=>{let t=Date.now();return{...e,messages:[...e.messages||[],{id:(0,rc.g)(),createdAt:t,content:a}]}}),t5.Y5.triggerAction("commit"),(0,rg.kX)(e,{openPreview:d}))},d=()=>{let e={x:Math.max(t?.size.x||rF.x,rB.x),y:Math.max(t?.size.y||rF.y,rB.y)};i((0,rp.ES)({type:rK})),i((0,rp.to)({type:rU,data:{initialSize:e}}))},p=(t,n)=>{(0,r_.Ww)(e,e=>{if(!e.props)return e;let a=e.props.map(e=>{if(e.name!==t)return e;try{return rn.Ts.parse({...e,value:n})}catch(t){return console.error(`Invalid value for prop "${e.name}":`,t.errors),e}});return{...e,props:a}})};return o.createElement(o.Fragment,null,o.createElement(ab.Zk,null,o.createElement(ry.r,{titleTx:o.createElement("span",null,(0,T.t)("living_designs.properties_panel.title")),icon:o.createElement(rr.O,{onClick:d})}),o.createElement("div",{className:S.cx.flex.flexColumn.gap12.$},o.createElement("div",{className:S.cx.flex.flexColumn.gap8.$},!!n.messages?.length&&o.createElement("div",{className:S.cx.flex.flexColumn.$},n.messages.map((e,t)=>o.createElement(lo,{key:e.id,message:e,artwork:0===t?o.createElement(rl.N,null):o.createElement("div",{className:S.cx.w16.h16.flex.justifyCenter.$},o.createElement("span",{className:S.cx.textBodyMedium.colorTextSecondary.$},(0,T.t)("living_designs.properties_panel.interactions.version_number",{number:t}))),variant:0===t?"primary":"secondary"}))),o.createElement(oF.Ad,{label:void 0,input:o.createElement("div",{className:S.cx.flex.gap8.$},o.createElement(lr,{value:a,placeholder:(0,T.t)("living_designs.properties_panel.description_input.placeholder"),handleChange:l,handleSubmit:c}),o.createElement(nt.$n,{onClick:c,disabled:!a.length||"loading"===s.status,"aria-label":(0,T.t)("living_designs.properties_panel.interactions.add_button.label")},"loading"===s.status?o.createElement(ra.k,null):o.createElement(ri.W,null))),appendedClassName:"living_designs_panel--textareaRow--V8RnZ"}),o.createElement(oF.Ad,{label:"Model ID",input:o.createElement(ln,null)})),n.props&&!!n.props.length&&o.createElement("div",{className:S.cx.flex.flexColumn.gap12.$},o.createElement("span",{className:S.cx.textBodyMediumStrong.px16.$},(0,T.t)("living_designs.properties_panel.properties_header")),n.props.map(e=>o.createElement("div",{key:e.name,className:S.cx.$},o.createElement(r2,{prop:e,onChange:t=>p(e.name,t)})))))),o.createElement(ll,null),e.guid===t?.guid&&o.createElement(ab.Zk,{className:r6.rq},o.createElement(oU.z,{onClick:()=>(0,r_.T9)(t),disabled:"loading"===s.status},(0,T.t)("living_designs.properties_panel.settings.reset_button"))))}function lo({message:e,artwork:t,variant:n="primary"}){return o.createElement("div",{className:S.cx.flex.px16.py4.gap8.$},t&&o.createElement("div",{style:{"--color-icon":"var(--color-icon-assistive)"}},t),o.createElement("div",null,o.createElement("span",{className:S.cx.textBodyMedium.case([["primary"===n,S.cx.colorText],["secondary"===n,S.cx.colorTextSecondary]]).$},e.content)))}function lr({value:e,placeholder:t,handleChange:n,minHeight:a,handleSubmit:r,disabled:l}){let{inputRef:i,inputProps:{onChange:s,onFocus:c,onMouseUp:d,onMouseLeave:p,onKeyUp:m}}=(0,rs.X)({onChange:function(e){n(e.target.value)}});return o.createElement(ru.v,{ref:e=>{e?.textarea&&(i.current=e.textarea)},value:e,placeholder:t,onChange:s,onFocus:c,onMouseUp:d,onMouseLeave:p,onKeyUp:m,minHeight:a,submit:r,bypassModifiers:!0,preventSubmitOnBlur:!0,disabled:l})}function ll(){let[e,t]=(0,f.fp)(rg.Zl),n=(0,r.wA)(),a=n=>{t({...e,serializer:n})};return o.createElement(ab.Zk,null,o.createElement(ry.r,{titleTx:o.createElement("span",null,(0,T.t)("living_designs.properties_panel.settings.header"))}),o.createElement(oF.Ad,{label:(0,T.t)("living_designs.properties_panel.settings.serializer_dropdown"),input:o.createElement("div",{className:S.cx.flex.flexColumn.gap4.$},o.createElement("select",{value:e.serializer,onChange:e=>a(e.target.value),className:`${S.cx.p8.$}`},[{label:"Hybrid",serializer:"hybrid"},{label:"Sites",serializer:"sites"},{label:"Sparse Tree Enrichment",serializer:"ste"}].map(({label:e,serializer:t})=>o.createElement("option",{key:e,value:t},e)))),alwaysShowLabel:!0}),o.createElement(oF.Ad,{label:(0,T.t)("living_designs.properties_panel.settings.eval_runs"),input:o.createElement(rm.Ht,{value:e.evaluationRuns,onValueChange:n=>{t({...e,evaluationRuns:n})},dispatch:n,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("living_designs.properties_panel.settings.eval_runs"),min:1,max:5}),alwaysShowLabel:!0}),o.createElement(oF.Ad,{label:(0,T.t)("living_designs.properties_panel.settings.backoff_delay"),input:o.createElement(rm.Ht,{value:e.evalBackoffDelay,onValueChange:n=>{t({...e,evalBackoffDelay:n})},dispatch:n,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("living_designs.properties_panel.settings.backoff_delay"),min:0,max:6e4}),alwaysShowLabel:!0}),o.createElement(oU.z,{onClick:()=>rN(n,e)},(0,T.t)("living_designs.properties_panel.settings.create_evals_button")))}function li(){return o.createElement(n0.i,null,o.createElement(la,null))}var ls=n(806787),lc=n(234587),ld=n(572304),lp=n(94500),lm=n(832637),lu=n(742311),lE=n(259927);class ly extends ar.o6{render(){return o.createElement(ab.Zk,null,o.createElement(ab.fI,null,o.createElement(ab.xw,null,(0,T.tx)("proto.menu.background"))),o.createElement(l_,{...this.props}))}}function l_(e){let t=o.useRef(null),n=o.useRef(null),a=(0,em.GS)(),{dispatch:r,pickerShown:l,prototypeBackgroundColor:i}=e,s=o.useCallback(()=>{let e=a?aS.findDOMNode(n.current):aS.findDOMNode(t.current);if(l&&l.id===lE.$T)r(ed.XE());else if(e&&e instanceof HTMLElement){let t=(0,rJ.cn)(e);r(ed.u1({id:lE.$T,initialX:t.x,initialY:t.y}))}},[r,l,a]),c=o.useCallback((e,t)=>{r((0,lp._P)({name:"Prototype Background Modified"})),t5.Y5.updateSelectionProperties({prototypeBackgroundColor:e},{shouldCommit:t})},[r]),d=(0,n3._W)(i,{r:0,g:0,b:0,a:1}),p=o.createElement("div",{className:"prototype_background_panel--colorValueContainer--CEbzl paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t"},o.createElement(t6.J,{onClick:s,color:d,opacity:d.a,recordingKey:ar.Pt(e,"chit"),className:"prototype_background_panel--chit--F--d0 paint_panels--chit--twQEy"}),o.createElement(nr.AN,{className:"prototype_background_panel--color--e5Pc8 paint_panels--colorInput--nSz13",noLeftBorder:!0,formatter:no.TI,property:d,onChange:c,recordingKey:ar.Pt(e,"colorInput"),noBorderOnFocus:!0}));return o.createElement(o.Fragment,null,a?o.createElement(rZ.TN,{ref:n},p):o.createElement(ab.fI,{ref:t,className:"prototype_background_panel--colorRow--MtNeY"},p),l&&l.id===lE.$T&&o.createElement(rj.h3,{disabledVariableIds:new Set,initialPosition:new tS.Mi(l.initialX??0,l.initialY??0),color:d,boundVariable:null,onChange:c,recordingKey:ar.Pt(e,"colorPicker")}))}ly.displayName="PrototypeBackgroundPanel";var lg=n(992271),lh=n(276660),lf=n(371435),lv=n(834447);let lb="prototype_device_panel--deviceSelect--wnOgI",lS="prototype_device_panel--deviceOption--rvW-q",lT="prototype_device_panel--inactiveLabel--UEKyk prototype_device_panel--activeLabel--l162n",lN="prototype_device_panel--labelInactive--pv4Sf",lI="prototype_device_panel--deviceDropdownChevron--kq9TV",lP="prototype_device_panel--deviceDropdownInput--AxG9E";var lC=n(537545),lA=n(64111);class lk extends lh.I{}class lw extends lh.Y{}class lO extends o.PureComponent{constructor(){super(...arguments),this.deviceInfo=()=>lg.hY[this.props.prototypeDevice.presetIdentifier],this.shouldShowModelDropdown=()=>{let e=this.deviceInfo();return lg.yr[e?.deviceName||""].length>1},this.onModelChange=e=>{if(!this.deviceInfo())return;let t=lg.hY[e];if(!t)return;let n=this.props.prototypeDevice.rotation;t5.Y5.updateSelectionProperties({prototypeDevice:{type:"PRESET",size:t.framePresetSize,presetIdentifier:e,rotation:n}})},this.renderModelDropdown=(e,t,n)=>{if(!e)return;let a=o.createElement(lK,{dispatch:this.props.dispatch,presetIdentifier:this.deviceInfo().presetIdentifier,dropdownShown:this.props.dropdownShown,onChange:this.onModelChange,recordingKey:ar.Pt(this.props,"modelDropdown")}),r=t?o.createElement(rZ.dx,{left:a,right:n}):o.createElement(rZ.TN,null,a);return o.createElement("div",null,!this.props.isUI3&&o.createElement(ab.hl,null,o.createElement(ab.UZ,{className:lN},(0,T.tx)("presets.device_panel.model"))),this.props.isUI3?r:o.createElement(ab.fI,null,a))},this.cssForCurrentDeviceRotation=()=>{if("NONE"===this.props.prototypeDevice.type)return;let e="";switch("MICROSOFT_SURFACE_PRO_4"===this.props.prototypeDevice.presetIdentifier&&(e="scale(0.65)"),this.props.prototypeDevice.rotation){case"NONE":default:return;case"CCW_90":return`rotate(-90deg) ${e}`}},this.renderDevicePreview=()=>{let e=this.deviceInfo();if(!e)return;let t=(0,n3._W)(this.props.prototypeBackgroundColor,{r:0,g:0,b:0,a:0}),n=no.z5.format(t),a=t.r>.9&&t.g>.9&&t.b>.9,r=`1px solid ${a?"#EFEFEF":"transparent"}`,l=o.createElement("div",{className:"prototype_device_panel--devicePreview--T2Tzn",style:{backgroundColor:n,border:r}},o.createElement("img",{className:"prototype_device_panel--deviceImage--Wpr8Y",src:e.thumbnailUrl,style:{transform:this.cssForCurrentDeviceRotation()},alt:`${e.getI18nDeviceName()}`}));return o.createElement("div",null,!this.props.isUI3&&o.createElement(ab.hl,null,o.createElement(ab.UZ,{className:lN},(0,T.tx)("presets.device_panel.preview"))),this.props.isUI3?o.createElement(rZ.TN,{appendedClassName:lv.Rk},l):o.createElement("div",{className:"prototype_device_panel--devicePreviewContainer--pC-H4"},l))},this.onChangeOrientation=e=>{let t=this.props.prototypeDevice;if("NONE"===t.type)return;let n=t.size.y>t.size.x,a=t.rotation;a=n?"PORTRAIT"===e?"NONE":"CCW_90":"PORTRAIT"===e?"CCW_90":"NONE",t5.Y5.updateSelectionProperties({prototypeDevice:{...t,rotation:a}})},this.currentDeviceOrientation=()=>{let e=this.props.prototypeDevice;return"NONE"===e.type?"PORTRAIT":e.size.y>e.size.x?"NONE"===e.rotation?"PORTRAIT":"LANDSCAPE":"NONE"===e.rotation?"LANDSCAPE":"PORTRAIT"}}render(){let e=this.props.prototypeDevice,t=o.createElement(lM,{dispatch:this.props.dispatch,prototypeDevice:this.props.prototypeDevice,isUI3:this.props.isUI3,dropdownShown:this.props.dropdownShown,recordingKey:ar.Pt(this.props,"deviceDropdown")}),n=o.createElement(lk,{property:this.currentDeviceOrientation(),onChange:this.onChangeOrientation,recordingKey:ar.Pt(this.props,"orientationControl"),className:"prototype_device_panel--orientationControl--YdZ-v"},o.createElement(lw,{value:"PORTRAIT",svg:lA.A}),o.createElement(lw,{value:"LANDSCAPE",svg:lC.A})),a=(0,lg.$X)(e.type||"NONE",e.presetIdentifier),r=o.createElement(ab.fI,null,t,a&&n),l=this.deviceInfo()&&this.shouldShowModelDropdown(),i=a&&!l?o.createElement(rZ.dx,{left:t,right:n}):o.createElement(rZ.TN,null,t),s=o.createElement(lx,{prototypeDevice:this.props.prototypeDevice,dispatch:this.props.dispatch,smallNudgeAmount:this.props.smallNudgeAmount,bigNudgeAmount:this.props.bigNudgeAmount,recordingKey:ar.Pt(this.props,"deviceSizeInputs")});return o.createElement(ab.Zk,null,o.createElement(ab.fI,{className:"prototype_device_panel--panelTitleRowOuter--wkKKy collapsible_property_panel--panelTitleRowOuter--i5K0R"},o.createElement(ab.xw,{extended:this.props.isUI3},this.props.isUI3?(0,T.tx)("presets.device_panel.prototype_settings"):(0,T.tx)("presets.device_panel.device"))),this.props.isUI3?i:r,this.renderModelDropdown(!!l,a,n),this.props.isUI3&&"CUSTOM"===this.props.prototypeDevice.type&&s,this.props.isUI3&&o.createElement(l_,{pickerShown:this.props.pickerShown,dispatch:this.props.dispatch,prototypeBackgroundColor:this.props.prototypeBackgroundColor,recordingKey:ar.Pt(this.props,"backgroundPanel")}),this.renderDevicePreview(),!this.props.isUI3&&"CUSTOM"===this.props.prototypeDevice.type&&s)}}function lx(e){let t=o.useCallback(t=>{t5.Y5.updateSelectionProperties({prototypeDevice:{type:"CUSTOM",size:{x:t,y:e.prototypeDevice.size.y},rotation:e.prototypeDevice.rotation}})},[e.prototypeDevice.size.y,e.prototypeDevice.rotation]),n=o.useCallback(t=>{t5.Y5.updateSelectionProperties({prototypeDevice:{type:"CUSTOM",size:{x:e.prototypeDevice.size.x,y:t},rotation:e.prototypeDevice.rotation}})},[e.prototypeDevice.size.x,e.prototypeDevice.rotation]),a=o.createElement(rm.$j,{className:"prototype_device_panel--scrubbableInputLeftCol--P2T66 prototype_device_panel--scrubbableInput--0TFVb",inputClassName:"prototype_device_panel--leftColInput--pAJSy prototype_device_panel--input--vNirJ",dispatch:e.dispatch,value:e.prototypeDevice.size.x,onValueChange:t,smallNudgeAmount:e.smallNudgeAmount,bigNudgeAmount:e.bigNudgeAmount,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("presets.device_panel.device_width_tooltip"),tooltipForScreenReadersOnly:!0,recordingKey:ar.Pt(e,"deviceWidth")},o.createElement("span",{className:lT},(0,T.tx)("proto.device_panel.width"))),r=o.createElement(rm.$j,{className:"prototype_device_panel--scrubbableInput--0TFVb",inputClassName:"prototype_device_panel--input--vNirJ",dispatch:e.dispatch,value:e.prototypeDevice.size.y,onValueChange:n,smallNudgeAmount:e.smallNudgeAmount,bigNudgeAmount:e.bigNudgeAmount,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("presets.device_panel.device_height_tooltip"),tooltipForScreenReadersOnly:!0,recordingKey:ar.Pt(e,"deviceHeight")},o.createElement("span",{className:lT},(0,T.tx)("proto.device_panel.height")));return(0,em.GS)()?o.createElement(rZ.dx,{left:a,right:r}):o.createElement(ab.fI,null,a,r)}lO.displayName="PrototypeDevicePanel";class lD extends rq.l6{}class lR extends rq.c${}class lM extends ar.o6{constructor(){super(...arguments),this.formatter={format:e=>"NONE"===e?this.props.isUI3?(0,T.t)("proto.frame_preset_panel.no_device"):(0,T.t)("proto.frame_preset_panel.none"):"CUSTOM"===e?(0,T.t)("proto.frame_preset_panel.custom_size"):"PRESENTATION"===e?(0,T.t)("proto.frame_preset_panel.presentation"):e.getI18nDeviceName(),isEqual:(e,t)=>"NONE"===e||"CUSTOM"===e||"PRESENTATION"===e||"NONE"===t||"CUSTOM"===t||"PRESENTATION"===t?e===t:e.presetIdentifier===t.presetIdentifier},this.onChange=e=>{(0,lp.$J)(e,this.props.prototypeDevice);let t=this.props.prototypeDevice.type,n=t;n="NONE"===e?"NONE":"PRESENTATION"===e?"PRESENTATION":"CUSTOM"===e?"CUSTOM":"PRESET",this.props.dispatch((0,lp._P)({name:"Prototype Device Type Changed",params:{oldType:this.props.prototypeDevice.presetIdentifier||t,newType:e.presetIdentifier||n,isInlinePreviewOpened:f.zl.get(lf.h).modalStatus===lf.b.OPEN}}))},this.renderPresetOption=(e,t)=>{let n=(0,lg.Fh)(e,this.props.prototypeDevice);if(null===n)return null;let a=n.framePresetSize;return o.createElement(lR,{value:n,key:t,recordingKey:ar.Pt(this.props,n.deviceName)},o.createElement("div",{className:lS},o.createElement("span",null,n.getI18nDeviceName()),o.createElement("span",null,a.x,"\u200A\xd7\u200A",a.y)," "))}}render(){let e;return e="NONE"===this.props.prototypeDevice.type?"NONE":"PRESENTATION"===this.props.prototypeDevice.type?"PRESENTATION":"CUSTOM"===this.props.prototypeDevice.type?"CUSTOM":lg.hY[this.props.prototypeDevice.presetIdentifier]||"NONE",o.createElement(lD,{className:lb,chevronClassName:lI,inputClassName:lP,id:"prototype-device-select",property:e,formatter:this.formatter,onChange:this.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,dropdownClassName:"prototype_device_panel--deviceDropdown--ufbuZ",recordingKey:ar.Pt(this.props,"select"),dropdownAlignment:"right"},o.createElement(lR,{value:"NONE",recordingKey:ar.Pt(this.props,"NONE")}),o.createElement(rq.sK,null),lg.r6.map(this.renderPresetOption),o.createElement(rq.sK,null),lg.J_.map(this.renderPresetOption),o.createElement(rq.sK,null),lg.AG.map(this.renderPresetOption),o.createElement(rq.sK,null),lg.$w.map(this.renderPresetOption),o.createElement(rq.sK,null),o.createElement(lR,{value:"CUSTOM",recordingKey:ar.Pt(this.props,"CUSTOM")},o.createElement("div",{className:lS},o.createElement("span",null,(0,T.tx)("proto.frame_preset_panel.custom_size")),o.createElement("span",null,(0,T.tx)("proto.frame_preset_panel.fit")))),o.createElement(lR,{value:"PRESENTATION",recordingKey:ar.Pt(this.props,"PRESENTATION")},o.createElement("div",{className:lS},o.createElement("span",null,(0,T.tx)("proto.frame_preset_panel.presentation")),o.createElement("span",null,(0,T.tx)("proto.frame_preset_panel.fill")))),o.createElement(rq.sK,null),lg.dr.map(this.renderPresetOption))}}lM.displayName="DeviceDropdown";class lL extends rq.l6{}class lV extends rq.c${}class lK extends ar.o6{constructor(){super(...arguments),this.formatter={format:e=>{let t=lg.hY[e];return t?t.getI18nStyleName():(0,T.t)("proto.frame_preset_panel.missing")},isEqual:(e,t)=>e===t},this.renderStyleOption=(e,t)=>{let n=e.presetIdentifier;return o.createElement(lV,{value:n,key:t,recordingKey:ar.Pt(this.props,n)},lg.hY[n].getI18nStyleName())}}render(){let e=lg.hY[this.props.presetIdentifier];if(!e)return null;let t=lg.yr[e.deviceName],n=this.props.presetIdentifier;return o.createElement(lL,{className:lb,chevronClassName:lI,inputClassName:lP,id:"prototype-style-select",property:n,formatter:this.formatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,dropdownClassName:"prototype_device_panel--modelDropdown--WbHYJ",recordingKey:ar.Pt(this.props,"select")},t.map(this.renderStyleOption))}}lK.displayName="ModelDropdown";var lU=n(536825),lF=n(939683),lB=n(529004),lG=n(522739),lz=n(723081),lY=n(46878),lW=n(634238),lH=n(234945),l$=n(279702),lX=n(113468),lQ=n(107244),lJ=n(248752);function lj(e){return e??"Default"}let lq=o.createContext({getNodeName:lj}),lZ=o.memo(function({getNodeName:e=lj,children:t}){let n=o.useMemo(()=>({getNodeName:e}),[e]);return o.createElement(lq.Provider,{value:n},t)});var l0=n(325682),l1=n(73349),l2=n(38340),l4=n(908946),l8=n(987850),l3=n(239737),l5=n(222478),l7=n(709731),l6=n(30075),l9=n(384775),ie=n(406385),it=n(623590);function ia(){let e=(0,r.wA)(),t=(0,r.d4)(e=>(0,n7.Yh)(e.mirror.appModel,l5.JT.MAGIC_LINK)),n=(0,l3.PE)(),{withinMeter:a}=(0,l8.X)(l5.JT.MAGIC_LINK);return n&&a?o.createElement("span",{className:"magic_link--magicLinkButton--CWefW","data-testid":"magic-link-entry"},o.createElement(tT.K,{recordingKey:ar.Pt("prototypeInteractionList","magicLinkButton"),"aria-label":(0,s.kc)().prototype_ai_magic_link_name_change?(0,T.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip-v2"):(0,T.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip"),onClick:()=>{(0,l9.$I)({moduleToOpen:{type:"custom",module:o.createElement(ie.p,null),name:l6.Sn.MAGIC_LINK,beforeModuleOpen:()=>{e((0,lp.Zh)({name:"prototype.ai_magic_link_entry_clicked",params:{source:"properties_panel"}})),(0,l7.B3)(l5.JT.MAGIC_LINK),t&&(0,l7.Ag)(l5.JT.MAGIC_LINK,it.e,{})}},trackingData:{source:"prototype_magic_link_triggered"}})},htmlAttributes:{"data-tooltip":(0,s.kc)().prototype_ai_magic_link_name_change?(0,T.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip-v2"):(0,T.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip"),"data-tooltip-type":ak.Ib.TEXT,"data-tooltip-show-above":!0}},o.createElement(l4.B,null))):null}var io=n(422237);let ir=(0,io.ex)("prototype_info",function(e){let{tooltipText:t}=e;return o.createElement("div",{className:S.cx.flex.justifyCenter.itemsCenter.$},o.createElement("span",{className:S.cx.m6.flexGrow1.$,style:{maxWidth:144}},t))},e=>({tooltipText:e.getAttribute("data-tooltip-text")}));var il=n(139055),ii=n(447141),is=n(930269),ic=n(819785),id=n(695038),ip=n(612325);let im=new lz.JV,iu=new lz.Eq,iE=new lz.sX,iy=o.memo(function({filterInteractionCategory:e}){let t=(0,r.wA)(),n=(0,r.d4)(l2.Cy),a=(0,r.d4)(l2.n9),l=(0,r.d4)(l2.DV),c=(0,r.d4)(iv),d=(0,r.d4)(lH.dK),p=(0,r.d4)(lH.Xt),m=(0,l2.a2)(),u=(0,l2.R)(),E=(0,r.d4)(iS),y=(0,r.d4)(ih),_=Object.keys(p).length>1,g=iT(),h=function(){let e=iT(),t=(0,r.d4)(ib);return!!e&&!!t&&t.selectionOverrides[i.YnC.PROTOTYPE_INTERACTIONS]}(),f=(0,F.q5)(),v=(0,lF.U)(),b=(0,nV.cJ)(),S=o.useMemo(()=>new lz.cP(d),[d]),T=o.useCallback(e=>S.format(e),[S]),N=o.useRef(null),I=e=>{t5.Y5.updateSelectionProperties({prototypeInteractions:e},{shouldCommit:l$.zk.NO_BUT_TRACK_AS_EDIT}),t5.Y5.commit()},P=(0,lu.Zj)(Object.keys(p)),C=o.createElement(i_,{interactionGroups:m,inheritedInternalInteractionGroups:u,mixed:_,isOrInInstance:g,openFile:f,dispatch:t,currentSelectedProperty:c,onChange:(e,t)=>{let o=e.map(e=>e.interactions).reduce((e,t)=>e.concat(t),[]),r=new Set,l=[];for(let e of o){let t=ld.dI(e.id);if(t&&!r.has(t))l.push(e);else{if(!(t=i.glU.generateUniqueID()))continue;let n=ld.sH(t);if(!n)continue;l.push({...e,id:n})}t&&r.add(t)}t===lX.J.NORMAL?l=[...l,...a]:t===lX.J.INHERITED_INTERNAL&&(l=[...n,...l]),I(l)},onAddProperty:e=>{e.stopPropagation();let t=[],o=[];for(let e of Object.keys(p)){let n=i.glU.generateUniqueID();if(!n)return;let a=ld.sH(n);if(!a)return;let r={id:a,sourceNodeID:ld.sH(e)??ld.Hr,event:{interactionType:function(e,t=!1){let n=new Set;for(let{event:t}of e)n.add(t.interactionType);for(let e of iN)if((!(0,s.kc)().sts_interaction_interop||!t||"DRAG"!==e)&&!n.has(e))return e;return"ON_KEY_DOWN"}(m,b)}};r.stateManagementVersion=1,r.actions=[{connectionType:"NONE"}],t.push(r);let l=(0,t9.kh)(d,e);o.push(l?l.guid:"")}let r=t.map(e=>lB.d({nodeID:e.sourceNodeID,interactionID:e.id}));if(r.length>0){i.glU.setSelectedInteractions(r);let e=aS.findDOMNode(N.current),t=(0,rJ.cn)(e);ik(new tS.Mi(t.x,t.y+(0,tv.jz)(is.rightNavGridRowHeight)))}let l=[...n,...t,...a];v("prototype_interaction_added",{interactionCount:l.length,sourceTlfIds:JSON.stringify(o)}),I(l)},onDeleteProperty:(e,t)=>{let n=(t===lX.J.NORMAL?m:u).filter((t,n)=>e.has(n)),a=[];for(let e of n)a.push(...e.interactions);let o=iA(a);t1.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(o)),t5.Y5.deselectProperty()},shouldIgnoreKeyboardEvents:l.length>0||c.type!==i.rrT.PROTOTYPE_INTERACTION&&c.type!==i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,isValidPrototypingSourceSelected:E,showResetInteractionsButton:h,toggleScrollBehaviorPicker:()=>{if(y?.id===lE.AO)t(ed.XE());else{let e=aS.findDOMNode(N.current),n=(0,rJ.cn)(e);t(ed.u1({id:lE.AO,initialX:n.x,initialY:n.y}))}},headerAccessory:P&&o.createElement(ia,null),inSites:b,filterInteractionCategory:e});return o.createElement(lZ,{getNodeName:T},b?C:o.createElement(ab.Zk,{"data-onboarding-key":"prototypePanel",ref:N,"data-testid":"prototype-interaction-list"},C))});function i_(e){let t=o.useRef(!1),n=(0,em.GS)(),a=(0,s.kc)().sts_interaction_interop&&!!e.filterInteractionCategory,r=!a||e.filterInteractionCategory===lX.J.NORMAL,l=e.isOrInInstance&&e.inheritedInternalInteractionGroups.length>0,c=a?e.filterInteractionCategory===lX.J.INHERITED_INTERNAL&&l:l,d=n?o.createElement("div",{className:"prototype_interaction_list--categoryRow--Xxfm4"},o.createElement(tI.J,{className:"prototype_interaction_list--categoryLabel--0dGOM"},(0,T.tx)("proto.interaction_list.variant_interactions"))):o.createElement(ab.fI,null,o.createElement(ab.UZ,{className:"prototype_interaction_list--label--dGwgy"},(0,T.tx)("proto.interaction_list.variant_interactions")));return o.createElement(o.Fragment,null,r&&o.createElement(lJ.h6,{title:e.inSites?"":(0,T.t)("proto.title_interactions"),stylePickerShown:{isShown:!1},addProperty:e.onAddProperty,toggleScrollBehaviorPicker:e.toggleScrollBehaviorPicker,hideAddButton:!e.isValidPrototypingSourceSelected,renderProperty:(n,a,r,l,i,c,d,p,m)=>!(0,s.kc)().sts_interaction_interop&&e.inSites&&(0,il.p4)(n.interactions)?o.createElement(o.Fragment,{key:a}):o.createElement(ig,{interactionGroups:e.interactionGroups,interactionGroup:n,index:a,selected:r,hasFocus:i,isDragging:l,singletonRow:e.interactionGroups.length<=1,onMouseDown:d,onMouseMove:p,onMouseUp:m,dispatch:e.dispatch,category:lX.J.NORMAL,autoOpenVariablePicker:t,recordingKey:ar.Pt("prototypeInteractionList",a),key:a,inSites:e.inSites}),openFile:e.openFile,onChange:t=>e.onChange(t,lX.J.NORMAL),currentSelectedProperty:e.currentSelectedProperty,selectedPropertyType:i.rrT.PROTOTYPE_INTERACTION,propertyList:e.interactionGroups,pickerShown:null,dispatch:e.dispatch,onDeleteProperty:t=>e.onDeleteProperty(t,lX.J.NORMAL),shouldIgnoreKeyboardEvents:e.shouldIgnoreKeyboardEvents,recordingKey:"prototypeInteractionList",boldHeaderRow:e.interactionGroups.length>=1||e.inheritedInternalInteractionGroups.length>=1,showResetInteractionsButton:e.showResetInteractionsButton,onResetInteractions:t1.nc.user("reset-instance-interactions",()=>i.glU.resetSymbolOverrides(i.YnC.PROTOTYPE_INTERACTIONS)),headerAccessory:e.headerAccessory}),c&&d,c&&o.createElement(lJ.h6,{title:"",stylePickerShown:{isShown:!1},addProperty:b.lQ,hideAddButton:!0,toggleScrollBehaviorPicker:e.toggleScrollBehaviorPicker,renderProperty:(n,a,r,l,i,s,c,d,p)=>o.createElement(ig,{interactionGroups:e.inheritedInternalInteractionGroups,interactionGroup:n,key:a,index:a,selected:r,hasFocus:i,isDragging:l,singletonRow:e.inheritedInternalInteractionGroups.length<=1,onMouseDown:c,onMouseMove:d,onMouseUp:p,dispatch:e.dispatch,category:lX.J.INHERITED_INTERNAL,autoOpenVariablePicker:t,recordingKey:ar.Pt("prototypeInheritedInternalInteractionList",a),inSites:e.inSites}),openFile:e.openFile,onChange:t=>e.onChange(t,lX.J.INHERITED_INTERNAL),currentSelectedProperty:e.currentSelectedProperty,selectedPropertyType:i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,propertyList:e.inheritedInternalInteractionGroups,pickerShown:null,dispatch:e.dispatch,onDeleteProperty:t=>e.onDeleteProperty(t,lX.J.INHERITED_INTERNAL),shouldIgnoreKeyboardEvents:e.shouldIgnoreKeyboardEvents,recordingKey:ar.Pt("prototypeInheritedInternalInteractionList")}))}function ig({interactionGroups:e,interactionGroup:t,index:n,hasFocus:a,isDragging:l,selected:c,singletonRow:d,onMouseDown:p,onMouseMove:m,onMouseUp:u,dispatch:E,category:y,recordingKey:_,inSites:g}){let h=(0,em.GS)(),{getNodeName:v}=o.useContext(lq),S=(0,r.d4)(l2.DV),N=(0,l2.a2)(),I=(0,r.d4)(ih),P=I?.id===lE.o$?I:null,C=(0,r.d4)(lH.dK),[A,k]=o.useState(!1),w=(0,f.md)(lW.NE)?iu:im,O=o.useContext(il.qd),x=function(e,t){let n=new Set(t.map(e=>{let t=lB.s(e);return t?ld.dI(t.interactionID):""}).filter(e=>""!==e));for(let t of e.interactions){let e=ld.dI(t.id);if(e&&n.has(e))return!0}return!1}(t,S),D=o.useRef(null),R=o.useRef(null),M=o.useCallback(()=>{let e=h&&g?R.current:aS.findDOMNode(D.current);ik((0,rJ.cn)(e))},[g,h]),L=o.useCallback(()=>{i.glU.setSelectedInteractions([]),E(ed.XE()),t5.Y5.deselectProperty()},[E]),V=n=>{if(!D||!R)return;let a=iC(t);if(n.metaKey||n.ctrlKey)x?a=S.filter(e=>!a.includes(e)):a.push(...S);else if(n.shiftKey){var o;let n,r;let l=(o=t.key,e.findIndex(({key:e})=>e===o));if(-1===l)return;let i=function(e,t){let n=1/0,a=e;for(let o of t){let t=Math.abs(e-o);t<n&&(a=o,n=t)}return a}(l,function(e,t){let n=new Set,a=new Set(t);for(let t=0;t<e.length;t++)iC(e[t]).some(e=>a.has(e))&&n.add(t);return n}(e,S)),s=(n=l,r=i,l>i&&(n=i,r=l),e.slice(n,r+1));for(let e of(a=[...S],s))a.push(...iC(e))}i.glU.setSelectedInteractions(a),t5.Y5.updateAppModel({currentSelectedProperty:{type:y===lX.J.NORMAL?i.rrT.PROTOTYPE_INTERACTION:i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,indices:[]}}),a.length?P&&P.shouldPin?g&&(a.length>1||a.includes(S[0]))&&L():M():L()},K=(0,r.d4)(lQ.ZM),U=!1,F=null,B=null;for(let e of t.interactions)if(!F&&e.actions&&e.actions.length>0)F=e.actions[0],B=e;else if(iP(F,v,h,K)!=iP((e.actions??[])[0],v,h,K)){U=!0;break}let G=()=>{let e=iA(t.interactions);i.glU.hoverInteractions(e),k(!0)},z=()=>{i.glU.hoverInteractions([]),k(!1)},Y=e=>{e.stopPropagation()},W=e=>{e.stopPropagation();let n=iA(t.interactions);t1.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(n)),t5.Y5.deselectProperty(),t5.Y5.commit()},H=!1,$=!1;if(y===lX.J.NORMAL){for(let e of t.interactions){if(!e.actions||0===e.actions.length)continue;let t=e.actions[0];if(!t||"SWAP_STATE"!==t.navigationType)continue;let n="";if(t.transitionNodeID){let e=C.get(ld.dI(t.transitionNodeID));if(e){if(e.isState)n=e.parentGuid||"";else{H=!0;break}}}let a=i.glU.getContainingStateGroupOrSelf(ld.dI(e.sourceNodeID??ld.Hr))||"";if(""===a||""!==n&&a!==n){H=!0;break}}let n=["ON_CLICK","MOUSE_DOWN","MOUSE_UP"].includes(t.event.interactionType??""),a=e.some(e=>"ON_HOVER"===e.event.interactionType);$=n&&a}H=y!==lX.J.INHERITED_INTERNAL&&H;let X=function(e,t,n){if(e!==lX.J.INHERITED_INTERNAL)return null;let a=n.find(e=>e.key===t.key&&e.interactions.length===t.interactions.length&&1===t.interactions.length&&function(e,t){let n=void 0!==e.actions&&e.actions.length>=1,a=void 0!==t.actions&&t.actions.length>=1;if(!n||!a)return!1;let o=e.actions.every(e=>"UPDATE_MEDIA_RUNTIME"===e.connectionType),r=e.actions.every(e=>ld.fn(e.transitionNodeID));var l=!1;for(let e of t.actions)if("INTERNAL_NODE"===e.connectionType&&"SWAP_STATE"===e.navigationType){l=!0;break}return o&&r&&l}(e.interactions[0],t.interactions[0]));return a?.interactions[0]??null}(y,t,e),Q=(0,aa.ZC)(X),J=(0,lF.U)();if(o.useEffect(()=>{null===Q&&X&&J("prototype_interaction_conflict_override_created",{interaction_type:t.interactions[0].event?.interactionType,action_type:X.event?.interactionType})}),(0,s.kc)().sts_interaction_interop&&t.event.interactionType&&O&&O!==(0,l0.hD)(t.event.interactionType)||(0,s.kc)().sts_interaction_interop&&"mouse"===O&&(0,il.zL)(t.interactions))return null;let j=y===lX.J.INHERITED_INTERNAL&&N.some(e=>e.key===t.key)&&!X,q=c&&a,Z=x&&!c,ee=new lz.js(h,K),et=(0,lz.mj)(F),en=B?.actions?.length??0,ea=(0,s.kc)().sts_interaction_interop&&en>1?(0,T.t)("sites.panel.interaction_summary",{numActions:en}):U||!F||"NONE"===et?void 0:ee.format(et),eo=o.createElement(nn.Z,null),er=H||$||j,el=H?(0,T.t)("proto.prototype_panel.this_interaction_must_swap_from_a_variant_to_another_variant_within_the_same_component_set_tooltip"):$?(0,T.t)("proto.prototype_panel.prototype_multiple_interactions_mouse_and_hover_tooltip"):j?(0,T.t)("proto.prototype_panel.this_interaction_will_not_be_triggered_as_interactions_on_instances_are_triggered_before_inherited_internal_interactions_tooltip"):"",ei=o.createElement(oF.Y9,{ref:R,"data-testid":`prototypeInteractionItem-${n}`,singletonRow:d,dragging:l,onMouseDown:p,onMouseMove:m,onMouseUp:u,onMouseEnter:G,onMouseLeave:z,recordingKey:ar.Pt(_,"draggableRow"),onClick:(0,s.kc)().sts_interaction_interop?V:b.lQ},o.createElement(oF.s2,{label:null,leftIcon:o.createElement(ab.YW,{onClick:(0,s.kc)().sts_interaction_interop?b.lQ:V,selected:Z&&!!P,recordingKey:ar.Pt(_,"interactionIcon"),onMouseDown:Y,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":er?el:iI(t.event,w,!!g),className:A&&(0,s.kc)().sts_interaction_interop?ii.zY:void 0},er?eo:(0,lY.e7)(t.event.interactionType)),input:o.createElement(lG.D8,{onClick:(0,s.kc)().sts_interaction_interop?b.lQ:V,onMouseDown:Y,recordingKey:ar.Pt(_,"interactionText")},iI(t.event,w,!!g),ea&&o.createElement("span",{className:"prototype_interaction_list--summaryText--hGpp4"},"\xa0\xb7\xa0",ea)),rightIcon:o.createElement("div",{hidden:(0,s.kc)().sts_interaction_interop&&!A},o.createElement(tT.K,{onClick:W,"aria-label":(0,T.t)("proto.prototype_panel.remove_interaction_tooltip"),recordingKey:ar.Pt(_,"removeButton"),htmlAttributes:{onMouseDown:Y}},o.createElement(aA.U,{svg:ic.A,fallbackSvg:id.A},o.createElement(lU.O,null))))}));return g?ei:o.createElement("div",null,o.createElement(av.e,{ref:D,className:h?"prototype_interaction_list--interactionListRow---i0Rg ui3_rows--ui3OneInputOneIconRow--SMoQ9 ui3_rows--_row--DnZFk ui3_rows--_grid--cP2Wu":void 0,"data-testid":`prototypeInteractionItem-${n}`,selected:q,selectedSecondary:Z,singletonRow:d,dragging:l,onMouseDown:p,onMouseMove:m,onMouseUp:u,onMouseEnter:G,onMouseLeave:z,recordingKey:ar.Pt(_,"draggableRow")},o.createElement(lG.D8,{className:eA()({"prototype_interaction_list--interactionButton--q-58Q":!0,"prototype_interaction_list--interactionButtonSelected--8YX9A":q,"prototype_interaction_list--interactionButtonSelectedSecondary--Nx73L":Z}),onClick:V,onMouseDown:Y,recordingKey:_},er&&o.createElement(tx.B,{className:"prototype_interaction_list--warningIcon--Mgr5O",svg:ip.A,"data-tooltip-type":ak.Ib.SPECIAL,"data-tooltip":ir,"data-tooltip-text":el}),o.createElement("div",{className:er?"prototype_interaction_list--interactionNameShort--5UMLL prototype_interaction_list--interactionName--zQsSL":"prototype_interaction_list--interactionName--zQsSL"},iI(t.event,w,!!g)),o.createElement(aA.U,{className:"prototype_interaction_list--actionIcon--x-haP",svg:U?(0,lY.Yb)("NONE"):(0,lY.Yb)((0,lz.mj)(F))},(0,lY.av)((0,lz.mj)(F))),o.createElement("div",{className:"prototype_interaction_list--targetText--UMXyE",dir:"auto"},U?(0,T.t)("proto.variant_actions.mixed"):y===lX.J.INHERITED_INTERNAL?(0,T.t)("proto.variant_actions.change_to"):iP(F,v,h,K))),o.createElement("span",{className:"prototype_interaction_list--removeButton--g6aiQ"},o.createElement(tT.K,{onClick:W,"aria-label":(0,T.t)("proto.prototype_panel.remove_interaction_tooltip"),recordingKey:ar.Pt(_,"removeButton"),htmlAttributes:{onMouseDown:Y}},o.createElement(aA.U,{svg:ic.A,fallbackSvg:id.A},o.createElement(lU.O,null))))))}function ih(e){return e.pickerShown}function iv(e){return e.mirror.appModel.currentSelectedProperty}function ib(e){return e.mirror.selectionProperties.resettableInstanceOverrides}function iS(e){return e.mirror.selectionProperties.isValidPrototypingSourceSelected??!0}function iT(){let e=(0,r.d4)(lH.Xt),t=(0,r.d4)(lH.dK);for(let n of Object.keys(e)){let e=t.get(n);if(e&&("INSTANCE"===e.type||e.isInstanceSublayer))return!0}return!1}let iN=["ON_CLICK","DRAG","ON_HOVER","ON_PRESS","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"];function iI(e,t,n){let a=t.format(e.interactionType??"NONE");if("ON_KEY_DOWN"===e.interactionType&&e.keyTrigger&&e.keyTrigger.keyCodes){let t=(0,l1._i)(e.keyTrigger.keyCodes),o=(0,l1.E8)(e.keyTrigger,!0);if("KEYBOARD"===e.keyTrigger.triggerDevice&&t)return(0,s.kc)().sts_interaction_interop&&n?(0,l1.U8)(t):a+" ("+(0,l1.U8)(t)+")";if(o)return(0,s.kc)().sts_interaction_interop&&n?o:a+" ("+o+")"}return a}function iP(e,t,n,a){let o=new lz.js(n,a);if(!e)return o.format("NONE");let r=(0,lz.mj)(e);switch(r){case"NONE":case"GO_BACK":case"CLOSE_OVERLAY":case"SET_VARIABLE":case"SET_VARIABLE_MODE":case"CONDITIONAL":return o.format(r);case"OPEN_URL":if(null!=e.connectionURL){if((0,n3.gl)(e.connectionURL))return(0,T.t)("fullscreen.mixed");return e.connectionURL.replace(/https?:\/\//,"")}return o.format("NONE");case"UPDATE_MEDIA_PLAY":case"UPDATE_MEDIA_PAUSE":case"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE":case"UPDATE_MEDIA_MUTE":case"UPDATE_MEDIA_UNMUTE":case"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE":case"UPDATE_MEDIA_SKIP_FORWARD":case"UPDATE_MEDIA_SKIP_BACKWARD":case"UPDATE_MEDIA_SKIP_TO":return iE.format(e)}return e.transitionNodeID?(0,n3.gl)(e.transitionNodeID)?(0,T.t)("fullscreen.mixed"):t(ld.dI(e.transitionNodeID)):o.format("NONE")}function iC(e){return e.interactions.filter(e=>e.id&&e.sourceNodeID).map(e=>lB.d({nodeID:e.sourceNodeID,interactionID:e.id}))}function iA(e){let t=[];for(let n of e){let{sourceNodeID:e,id:a}=n;e&&a&&t.push(lB.d({nodeID:e,interactionID:a}))}return t}function ik(e){t5.Y5.triggerAction("show-prototype-interaction-edit-modal",{args:{source:i.yxn.PROPERTIES_PANEL,x:e.x,y:e.y}})}var iw=n(889157),iO=n(797613),ix=n(974985),iD=n(256981),iR=n(43604);let iM=(0,o.memo)(function(e){return(0,tC.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,tC.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M14 7.879v-1.88a1 1 0 0 0-1.707-.706L9.586 8H7.5A1.5 1.5 0 0 0 6 9.5v5c0 .383.144.733.38.998l.711-.71A.5.5 0 0 1 7 14.5v-5a.5.5 0 0 1 .5-.5H10l2-2 1-1v2.879zm0 4.242-1 1V18l-1-1-1.44-1.44-.706.708 2.439 2.439A1 1 0 0 0 14 18v-5.88m2.069-2.068.71-.71a3.501 3.501 0 0 1-1.217 5.993c-.29.092-.562-.144-.562-.448v-.03c0-.237.17-.437.392-.522a2.5 2.5 0 0 0 .677-4.283m-1.013 1.013.172-.172c.113-.056.248-.044.36.073.255.269.412.632.412 1.033s-.157.764-.412 1.033c-.238.25-.588.02-.588-.326v-1.415a.5.5 0 0 1 .056-.226m2.798-4.92a.5.5 0 0 1 0 .708l-11 11a.5.5 0 1 1-.708-.707l11-11a.5.5 0 0 1 .708 0",clipRule:"evenodd"})})});var iL=n(875533),iV=n(697945),iK=n(477633),iU=n(564734),iF=n(68710),iB=n(632319);function iG({videoPlayback:{mediaLoop:e,muted:t}}){let n=null;return(0,n3.gl)(e)&&(0,n3.gl)(t)?n=(0,T.tx)("proto.prototype_panel.replace_mixed_muted_and_loop_video_playback",{loopSvg:o.createElement(tx.B,{svg:iK.A,className:iV.eT}),speakerSvg:o.createElement(tx.B,{svg:iF.A,className:iV.To})}):(0,n3.gl)(e)?n=(0,T.tx)("proto.prototype_panel.replace_mixed_video_playback",{svg:o.createElement(tx.B,{svg:iK.A,className:iV.eT})}):(0,n3.gl)(t)&&(n=(0,T.tx)("proto.prototype_panel.replace_mixed_video_playback",{svg:o.createElement(tx.B,{svg:iF.A,className:iV.To})})),n?o.createElement(ab.fI,null,o.createElement(ab.UZ,{className:iV.pc},n)):null}let iz=e=>(0,n3.gl)(e)?"mixed":e,iY=e=>!0===e,iW=function(e){let t=()=>{let t=!iY(e.videoPlayback.mediaLoop);e.updateSelectionProperties({videoMediaLoop:t}),e.dispatch((0,lp._P)({name:"Node video loop changed",params:{newLoop:t,oldLoop:iz(e.videoPlayback.mediaLoop),numVideosSelected:e.videoPlayback.numVideosSelected}}))},n=()=>{let t=!e.videoPlayback.muted;e.updateSelectionProperties({videoMuted:t}),e.dispatch((0,lp._P)({name:"Node video muted changed",params:{newMuteValue:t,oldMuteValue:iz(e.videoPlayback.muted),numVideosSelected:e.videoPlayback.numVideosSelected}}))},a=o.createElement("span",{className:(0,em.GS)()?void 0:iV.hW},o.createElement(r$.S,{label:o.createElement(tI.J,{htmlAttributes:{"data-tooltip":(0,T.t)("proto.prototype_panel.default_video_playback_state"),"data-tooltip-type":ak.Ib.TEXT}},(0,T.tx)("proto.prototype_panel.autoplay")),onChange:t=>{e.updateSelectionProperties({videoAutoplay:t}),e.dispatch((0,lp._P)({name:"Node video autoplay Changed",params:{newAutoplay:t,oldAutoplay:iz(e.videoPlayback.autoplay),numVideosSelected:e.videoPlayback.numVideosSelected}}))},checked:iY(e.videoPlayback.autoplay),mixed:(0,n3.gl)(e.videoPlayback.autoplay),recordingKey:ar.Pt(e,"autoPlayToggle")})),r=(0,em.GS)()?o.createElement(iO.f,{checked:iY(e.videoPlayback.mediaLoop),mixed:(0,n3.gl)(e.videoPlayback.mediaLoop),onIcon:o.createElement(aA.U,{svg:iK.A},o.createElement(ix.p,null)),offIcon:o.createElement(aA.U,{svg:iU.A},o.createElement(iD.U,null)),onChange:t,recordingKey:ar.Pt(e,"videoLoopToggle"),"aria-label":(0,T.t)("proto.prototype_panel.loop"),htmlAttributes:{"data-tooltip":(0,T.t)("proto.prototype_panel.loop"),"data-tooltip-type":ak.Ib.TEXT}}):o.createElement(iL.m,{toggled:iY(e.videoPlayback.mediaLoop),svg:e.videoPlayback.mediaLoop?iK.A:iU.A,fallbackSvg:e.videoPlayback.mediaLoop?iK.A:iU.A,onMouseDown:t,recordingKey:ar.Pt(e,"videoLoopToggle"),"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("proto.prototype_panel.loop"),dataTestId:"videoLoopToggle",className:iV.BM}),l=(0,em.GS)()?o.createElement(iO.f,{checked:iY(!e.videoPlayback.muted),mixed:(0,n3.gl)(e.videoPlayback.muted),onIcon:o.createElement(aA.U,{svg:iF.A},o.createElement(iR.L,null)),offIcon:o.createElement(aA.U,{svg:iB.A},o.createElement(iM,null)),onChange:n,recordingKey:ar.Pt(e,"videoSoundToggle"),"aria-label":(0,T.t)("proto.prototype_panel.sound"),htmlAttributes:{"data-tooltip":(0,T.t)("proto.prototype_panel.sound"),"data-tooltip-type":ak.Ib.TEXT}}):o.createElement(iL.m,{toggled:!e.videoPlayback.muted,svg:iY(e.videoPlayback.muted)?iB.A:iF.A,fallbackSvg:iY(e.videoPlayback.muted)?iB.A:iF.A,onMouseDown:n,recordingKey:ar.Pt(e,"videoSoundToggle"),"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("proto.prototype_panel.sound"),dataTestId:"videoSoundToggle",className:iV.BM}),i=(0,em.GS)()?o.createElement(oF.pG,{input:a,leftIcon:r,rightIcon:l}):o.createElement(ab.fI,{className:iV.kh},a,o.createElement("div",{className:iV.zc},r,l));return o.createElement(ab.Zk,null,o.createElement(ab.fI,null,o.createElement(ab.xw,{extended:!0},(0,T.tx)("proto.prototype_panel.video"))),i,o.createElement(iG,{videoPlayback:e.videoPlayback}))};var iH=n(794272),i$=n(555074),iX=n(420450),iQ=n(955136);function iJ(e){let{type:t}=e;return o.createElement("div",{className:S.cx.flex.justifyCenter.itemsCenter.$},o.createElement(tx.B,{className:S.cx.flexGrow1.mx12.$,useOriginalSrcFills_DEPRECATED:!0,svg:"horizontal"===t?iX.A:iQ.A}),o.createElement("span",{className:S.cx.flexGrow1.m6.$,style:{maxWidth:144}},(0,T.tx)("proto.prototype_panel.content_needs_to_be_bigger_than_the_frame_tooltip")))}let ij=(0,io.ex)("prototype_scroll_horizontal_info",iJ,()=>({type:"horizontal",unconstrainWidth:!0})),iq=(0,io.ex)("prototype_scroll_vertical_info",iJ,()=>({type:"vertical",unconstrainWidth:!0})),iZ="scroll_behavior_panel--inactiveLabel--IexW8",i0="scroll_behavior_panel--inactiveLabelContainer--lQjAi";var i1=n(591363);function i2(e){let{scrollDirection:t,showScrollWarning:n,disableOverflowBehaviorItem:a,disableScrollBehaviorItem:l,dropdownShown:s,updateSelectionProperties:c}=e,d=(0,r.wA)(),[p,m]=function(){let e=(0,er.J2)(i.Ez5.propertiesPanelState().shownPropertiesPanels)[i.ibQ.OVERFLOW_ITEM],t=(0,lc.cJ)(),n=(0,i$.kl)("isSection"),a=(0,i$.kl)("anyTopLevelFramesInSelection");return[e,!t&&!n&&!a]}(),u=(0,em.GS)()?o.createElement(ry.mS,{titleTx:(0,T.tx)("proto.scroll_panel.scroll_behavior_title")}):o.createElement(ab.fI,null,o.createElement(ab.xw,{className:"scroll_behavior_panel--panelTitle--kN-Nl"},(0,T.tx)("proto.scroll_panel.scroll_behavior_title")));return p||m?o.createElement(as.k,{name:"scroll_behavior_panel"},o.createElement(ab.Zk,null,u,m&&o.createElement(ab.fI,null,o.createElement("div",{className:i0},o.createElement("span",{className:iZ},(0,T.tx)("proto.scroll_panel.position_dropdown.position"))),o.createElement(i9,{recordingKey:ar.Pt(e,"scrollBehavior"),dropdownShown:s,disabled:l})),p&&o.createElement(ab.fI,null,o.createElement("div",{className:i0},o.createElement("span",{className:iZ},(0,T.tx)("proto.scroll_panel.overflow_dropdown.overflow"))),n&&o.createElement(tx.B,{className:"scroll_behavior_panel--infoIcon--FeXbf",svg:i1.A,useOriginalSrcFills_DEPRECATED:!0,"data-tooltip-type":ak.Ib.SPECIAL,"data-tooltip":"HORIZONTAL"===t?ij:iq,"data-tooltip-show-immediately":!0}),o.createElement(i5,{className:n?"scroll_behavior_panel--scrollDirectionShort--w6iSo":"scroll_behavior_panel--scrollDirection--XSmzK",property:t,dispatch:d,dropdownShown:s,onChange:e=>{d((0,lp._P)({name:"Overflow Behavior changed",params:{newDirection:e,oldDirection:(0,n3._W)(t,"MIXED")}})),c({scrollDirection:e})},disabled:a,recordingKey:ar.Pt(e,"scrollDirection")})))):null}class i4 extends rq.c${}class i8 extends rq.l6{}let i3=["NONE","HORIZONTAL","VERTICAL","BOTH"];class i5 extends o.PureComponent{render(){return o.createElement(i8,{id:"scroll-direction-select",className:this.props.className,chevronClassName:"scroll_behavior_panel--scrollDirectionChevron--5keRt",inputClassName:"scroll_behavior_panel--scrollDirectionInput--vJSqu",property:this.props.property||"NONE",formatter:lz.Rk,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,disabled:this.props.disabled,recordingKey:this.props.recordingKey,dataTestId:"scroll-direction-dropdown"},i3.map(e=>o.createElement(i4,{key:e,value:e,recordingKey:ar.Pt(this.props,e)})))}}i5.displayName="ScrollDirectionDropdown";class i7 extends rq.l6{}class i6 extends rq.c${}function i9(e){let t=(0,r.wA)(),n=(0,i$.kl)("scrollBehavior"),{fixedScrollingDisabled:a}=(0,iH.R)(e=>{let t=e.mirror.selectionProperties;return{fixedScrollingDisabled:!t.nodesAreAllNotInStacksOrAbsolutePositioned||!t.allHaveScrollableFrameAsParent}}),l="scroll-behavior-select",s=e.dropdownShown&&e.dropdownShown.type===l?lz.Ge:lz.wi;return o.createElement(i7,{id:l,className:"scroll_behavior_panel--scrollPosition--YAyUM",formatter:s,property:n||"SCROLLS",onChange:e=>{t((0,lp._P)({name:"Node Scroll Behavior Changed",params:{newValue:e}}));let n="FIXED_WHEN_CHILD_OF_SCROLLING_FRAME"===e?i.KjJ.FIXED:"STICKY_SCROLLS"===e?i.KjJ.STICKY_SCROLLS:i.KjJ.SCROLLS;t1.l7.user("set-scroll-behavior",()=>i.X3B.aggressivelySetScrollBehaviorOfSelection(n)),t5.Y5.commit()},dispatch:t,dropdownShown:e.dropdownShown,dropdownClassName:"scroll_behavior_panel--fullWidth--reSmx",recordingKey:e.recordingKey,disabled:e.disabled,dataTestId:"scroll-behavior-dropdown"},o.createElement(i6,{value:"SCROLLS"}),o.createElement(i6,{value:"FIXED_WHEN_CHILD_OF_SCROLLING_FRAME",disabled:a}),o.createElement(i6,{value:"STICKY_SCROLLS"}))}var se=n(105020),st=n(548183),sn=n(854547),sa=n(654784),so=n(351731);function sr(){return o.createElement(lm.u,{idForTests:"create-connection-hint",title:(0,T.t)("proto.onboarding.creating_a_connection"),userFlag:"dismissed_create_connection_hint",icon_DEPRECATED:sn.A,iconFallback:sa.A,hintText:(0,T.t)("proto.onboarding.select_a_frame_or_object_hint")})}function sl(){return o.createElement(lm.u,{idForTests:"delete-connection-hint",title:(0,T.t)("proto.onboarding.removing_a_connection"),userFlag:"dismissed_delete_connection_hint",icon_DEPRECATED:se.A,iconFallback:st.A,hintText:(0,T.t)("proto.onboarding.to_delete_a_connection_click_and_drag_on_either_end")})}function si(){return o.createElement(lm.u,{idForTests:"play-button-hint",title:(0,T.t)("proto.onboarding.running_your_prototype"),userFlag:"dismissed_play_button_hint",icon_DEPRECATED:so.A,hintText:(0,T.t)("proto.onboarding.use_the_play_button_hint")})}function ss({dismissedCreateConnectionHint:e,dismissedDeleteConnectionHint:t,dismissedPlayButtonHint:n,numTransitionsOnCurrentPage:a}){let r=0===a&&!e,l=0!==a&&!t,i=!n,s=o.useMemo(()=>r?D.c.CREATING_A_CONNECTION:l?D.c.REMOVING_A_CONNECTION:i?D.c.RUNNING_YOUR_PROTOTYPE:null,[r,l,i]);return s?o.createElement(R.fu,{name:"Prototype Onboarding Hint Panel V1",properties:{trackingDescriptor:s}},o.createElement(ab.Zk,null,o.createElement("div",null,r&&o.createElement(sr,null),l&&o.createElement(sl,null),i&&o.createElement(si,null)))):null}class sc extends o.PureComponent{constructor(){super(...arguments),this.onClickShowPrototypeSettings=()=>{this.props.dispatch((0,lp._P)({name:"Show Prototype Settings Clicked"})),ee.wr()}}renderOnboardingPanel(){let e=!!this.props.userFlags.dismissed_create_connection_hint,t=!!this.props.userFlags.dismissed_delete_connection_hint,n=!!this.props.userFlags.dismissed_play_button_hint,a=this.props.selectionProperties.numTransitionsOnCurrentPage;return o.createElement(ss,{dismissedCreateConnectionHint:e,dismissedDeleteConnectionHint:t,dismissedPlayButtonHint:n,numTransitionsOnCurrentPage:a})}renderPrototypeSettingsPanel(){return o.createElement(as.k,{name:"show_prototype_settings_panel"},o.createElement(ab.Zk,{className:this.props.isUI3?r6.rq:void 0},o.createElement(oU.z,{onClick:this.onClickShowPrototypeSettings,recordingKey:ar.Pt(this.props,"prototypeSettingsButton")},(0,T.tx)("proto.menu.show_prototype_settings"))))}renderDevicePanel(){(0,n9.KF)((0,n3.hS)(this.props.selectionProperties.prototypeDevice),"should not have mixed device selection");let e=(0,lp.Qx)(this.props.selectionProperties.prototypeDevice);return o.createElement(lO,{key:"device-panel",dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,prototypeBackgroundColor:this.props.selectionProperties.prototypeBackgroundColor,prototypeDevice:e,smallNudgeAmount:this.props.smallNudgeAmount,bigNudgeAmount:this.props.bigNudgeAmount,recordingKey:"devicePanel",isUI3:this.props.isUI3,pickerShown:this.props.pickerShown})}render(){let e=!(0,n3.hS)(this.props.selectionProperties.transitionNodeID)||ld.fn((0,n3.E7)(this.props.selectionProperties.transitionNodeID)),t=this.props.selectionProperties.numSelected??!1,n=!this.props.isSites&&!!this.props.selectionProperties.numVideosSelected,a=this.props.selectionProperties.isInstanceSelected||this.props.selectionProperties.isInstanceSublayerSelected,r=this.props.selectionProperties.isInstanceSublayerSelected,l=!this.props.isSites&&this.props.selectionProperties.prototypeStartingPointsInfo&&this.props.selectionProperties.prototypeStartingPointsInfo.length>0,i=!this.props.isSites&&!e,s=!this.props.isSites&&((this.props.selectionProperties.isValidPrototypingSourceSelected??!0)||this.props.selectionProperties.isSectionSelected&&(0,lu.YR)());if(!t)return o.createElement("div",null,!this.props.isSites&&this.renderDevicePanel(),!this.props.isUI3&&o.createElement(ly,{recordingKey:ar.Pt(this.props,"backgroundPanel"),prototypeBackgroundColor:this.props.selectionProperties.prototypeBackgroundColor,pickerShown:this.props.pickerShown,dispatch:this.props.dispatch}),l&&o.createElement(re.A,null),!this.props.isSites&&i&&this.renderOnboardingPanel(),o.createElement(of.Mw,{panelName:of.ON.PROTOTYPE}));{let e=o.createElement(i2,{dropdownShown:this.props.dropdownShown,scrollDirection:this.props.selectionProperties.scrollDirection??"NONE",showScrollWarning:this.props.selectionProperties.showWontScrollWarning??!1,disableOverflowBehaviorItem:!!a,disableScrollBehaviorItem:!!r,recordingKey:ar.Pt(this.props,"scrollBehaviorPanel"),updateSelectionProperties:t5.Y5.updateSelectionProperties});return o.createElement("div",null,!this.props.isSites&&this.props.selectionProperties.isTopLevelFrameAndValidPrototypeSourceSelected&&o.createElement(iw.A,{recordingKey:ar.Pt(this.props,"startingPointPanel")}),s&&o.createElement(iy,null),e,n&&o.createElement(iW,{updateSelectionProperties:t5.Y5.updateSelectionProperties,dispatch:this.props.dispatch,videoPlayback:function(e){let{videoMediaLoop:t,videoAutoplay:n,videoMuted:a,numVideosSelected:o}=e;return(0,n9.B1)(t),(0,n9.B1)(n),(0,n9.B1)(a),(0,n9.B1)(o),{autoplay:n,muted:a,mediaLoop:t,numVideosSelected:o}}(this.props.selectionProperties)}),!this.props.isSites&&this.renderPrototypeSettingsPanel(),i&&this.renderOnboardingPanel(),o.createElement(of.Mw,{panelName:of.ON.PROTOTYPE}))}}}sc.displayName="PrototypePanel";let sd=(0,R.kp)(function(e){let{bigNudgeAmount:t,smallNudgeAmount:n}=(0,nU.sT)(),a=(0,em.GS)(),r=(0,lc.cJ)();return o.createElement(sc,{...e,bigNudgeAmount:t,smallNudgeAmount:n,isUI3:a,isSites:r})},o6.e0.PROTOTYPE_PANEL);function sp({appModel:e,colorFormat:t,dropdownShown:n,expandedFramePresetType:a,library:l,pickerShown:s,sceneGraphSelection:c,selectedStyleProperties:d,selectionProperties:p,shownPanels:m,userFlags:u}){let E=(0,r.wA)(),y=(0,F.q5)(),_=(0,lc.cJ)(),g=(0,nq.RB)(d)?d:p,h=!m[i.ibQ.FRAME_PRESETS]&&!m[i.ibQ.PENCIL_TOOL]&&!g.containsResponsiveSets;return o.createElement(n0.i,null,o.createElement(n2.VF,{isVisible:m[i.ibQ.FRAME_PRESETS]},()=>o.createElement(n4.nl,{key:"frame-presets",recordingKey:"framePresetPanel",dispatch:E,expandedFramePresetType:a})),!_&&o.createElement(n2.VF,{isVisible:m[i.ibQ.PENCIL_TOOL]},()=>o.createElement(n8.q,{id:"pencilToolPanel",key:"pencilToolPanel",recordingKey:"pencilToolPanel",openFile:y})),o.createElement(n2.VF,{isVisible:h},()=>o.createElement(sd,{key:"prototype",recordingKey:"prototypePanel",dispatch:E,selectionProperties:g,appModel:e,pickerShown:s,dropdownShown:n,currentTool:e.currentTool,colorFormat:t,sceneGraphSelection:c,editModeType:e.activeCanvasEditModeType,library:l,openFile:y,userFlags:u})))}function sm({scrollContainer:e,refMainScrollContainer:t,...n}){(0,o7.S2)();let a=n.user,r=(0,nV.my)()===nY.nT.Design,l=(0,nM.Kf)({isDesign:r,isUnauth:!a})(),c=n.appModel.topLevelMode,d=n.propertiesPanelTab,p=n.appModel.isReadOnly,m=c!==i.lyf.PREVIEW&&(c!==i.lyf.BRANCHING||!(0,nq.S4)(n.appModel,n.user))&&c!==i.lyf.DEV_HANDOFF&&d===i.FAf.DESIGN,u=c!==i.lyf.PREVIEW&&c!==i.lyf.BRANCHING&&d===i.FAf.PROTOTYPE,E=c===i.lyf.PREVIEW&&!n.userStateLoaded&&!l||d===i.FAf.INSPECT,y=(0,s.kc)().livefish&&c===i.lyf.LAYOUT&&!p&&d===i.FAf.LIVING_DESIGNS,_=d===i.FAf.EXPORT,g=d===i.FAf.COMMENT;return o.createElement(o.Fragment,null,m&&o.createElement(o8,{scrollContainer:e,...n}),u&&o.createElement(sp,{appModel:n.appModel,colorFormat:n.colorFormat,dropdownShown:n.dropdownShown,expandedFramePresetType:n.expandedFramePresetType,library:n.library,pickerShown:n.pickerShown,sceneGraphSelection:n.sceneGraphSelection,selectedStyleProperties:n.selectedStyleProperties,selectionProperties:n.selectionProperties,shownPanels:n.shownPanels,userFlags:n.userFlags}),E&&o.createElement(rt,{scrollContainer:e,selectionProperties:n.selectionProperties}),y&&o.createElement(li,null),_&&o.createElement(o5,{appModel:n.appModel,dropdownShown:n.dropdownShown,pickerShown:n.pickerShown,saveAsState:n.saveAsState,sceneGraphSelection:n.sceneGraphSelection,selectedStyleProperties:n.selectedStyleProperties,selectionProperties:n.selectionProperties}),g&&o.createElement(n.commentsPanel,null))}function su(e){!function(){let e="ui3"===(0,n$.DP)().version,{isPropertiesPanelCollapsed:t,setPropertiesPanelCollapsed:n}=(0,nX.iT)(),a=(0,eB.Ye)(),l=(0,nV.ow)(),s=(0,U.ax)(),c=(0,U.dH)(),d=c===i.NLJ.FRAME||c===i.NLJ.COMMENTS||c===i.NLJ.VECTOR_PENCIL,p=(0,r.d4)(e=>e.mirror.appModel.activeUserAction===i.QOV.DEFAULT),m=(0,nX.ys)();(0,o.useEffect)(()=>{e&&p&&!l&&t&&(d||s)&&n(!1)},[s,p,c,e,n,t,a,d,l]),(0,o.useEffect)(()=>{m&&n(!0)},[m,n,t])}();let{dispatch:t,...n}=e,a=null,l=e=>{a=e};return o.createElement(ls.j,{recordingKey:n.recordingKey,activeTab:n.propertiesPanelTab,refMainScrollContainer:l},o.createElement(sm,{...n,scrollContainer:a,refMainScrollContainer:l}))}var sE=n(16771),sy=n(59434);let s_=o.memo(function(){let e=(0,r.wA)(),t=(0,r.d4)(e=>(0,nG.getPermissionsState)(e)),n=(0,U.aV)(),a=(0,r.d4)(e=>e.loadingState),l=(0,r.d4)(e=>e.mirror.appModel),s=(0,f.md)(nz.wm),c=(0,r.d4)(e=>e.mirror.sceneGraphSelection),d=(0,r.d4)(e=>e.mirror.selectionPaints),p=(0,r.d4)(e=>e.mirror.selectionProperties),m=(0,r.d4)(e=>e.mirror.selectedStyleProperties),u=(0,r.d4)(e=>e.currentUserOrgId),E=(0,r.d4)(e=>e.dropdownShown),y=(0,r.d4)(e=>e.fonts),_=(0,r.d4)(e=>e.fileVersion),g=(0,r.d4)(e=>e.installedPluginVersions),h=(0,r.d4)(e=>e.library),v=(0,r.d4)(e=>e.localPlugins),b=(0,r.d4)(e=>e.modalShown),S=(0,r.d4)(e=>e.multiplayer),T=(0,r.d4)(e=>e.openFile),N=(0,r.d4)(e=>e.pickerShown),I=(0,r.d4)(e=>e.pickerInStyleCreationShown),P=(0,r.d4)(e=>e.publishedPlugins),C=(0,r.d4)(e=>e.saveAsState),A=(0,r.d4)(e=>e.selectedView),k=(0,r.d4)(e=>e.voice.showWidget),w=(0,r.d4)(e=>e.stylePickerListLayout),O=(0,r.d4)(e=>e.stylePickerShown),x=(0,r.d4)(e=>e.stylePreviewShown),D=(0,r.d4)(e=>e.styleSets),R=(0,r.d4)(e=>e.usedKeyboardShortcuts),M=(0,r.d4)(e=>e.user),L=(0,r.d4)(e=>e.userFlags),V=(0,r.d4)(e=>e.userStateLoaded),K=(0,r.d4)(e=>e.repos),F=(0,r.d4)(e=>e.folders),B=(0,r.d4)(e=>e.teams),G=(0,r.d4)(e=>e.orgById),z=(0,r.d4)(e=>e.orgUsersByOrgId),Y=(0,r.d4)(e=>e.userEduGracePeriods),W=(0,r.d4)(e=>e.licenseGroups),H=(0,em.GS)(),$=(0,nV.my)()===nY.nT.Design,X=(0,eN.iZ)(),Q=(0,nM.Kf)({isDesign:$,isUnauth:!X})(),J=(0,nB.VP)(a,"edit_button_upgrading_to_edit"),j=n||J,q=(0,er.ut)((0,ee.aY)(),i.FAf.DESIGN),Z=(0,er.J2)(i.Ez5.propertiesPanelState().shownPropertiesPanels),et=(0,er.J2)(i.Ez5.propertiesPanelState().strokePanelMode),en=(0,er.J2)(i.Ez5.propertiesPanelState().strokePanelTerminalPointCount),ea=(0,er.J2)((0,nU.UK)().expandedFramePresetType),eo=(0,nU.Ku)(),el=(0,nU.qw)(),ei=(0,nK.b)(),es=(0,er.J2)(i.Ez5.uiState().showPropertiesPanel),ec=!(0,nL.Oo)()&&H&&es,ed=(0,er.J2)((0,nU.UK)().renderRulers),{isRightPanelCollapsed:ep}=(0,o.useContext)(nW.t),{inProductHelpViewType:eu}=(0,nH.A5)(),eE=(0,er.J2)(i.Ez5.uiState().inProductHelpSidePanelWidth),ey=(0,nF.Tn)(),e_=(0,nF.qM)(),eg=(0,o.useMemo)(()=>Q?i.FAf.COMMENT:q,[q,Q]);return(0,o.useEffect)(()=>{eg!==q&&ee.aY()?.set(eg)},[eg,q]),o.createElement(sy.o,{boundaryKey:"PropertiesPanel",loggedOutDesktopRevampExpAvaialable:$},o.createElement(su,{recordingKey:"propertiesPanel",isCollapsed:ep,propertiesPanelTab:eg,strokePanelMode:et,strokePanelTerminalPointCount:en,commentsPanel:sE.L,dispatch:e,isLoading:j,shouldAnimateLoadingState:n,shouldShowBackgroundGradient:ec,shownPanels:Z,rulersVisible:ed,isInsetEditorEnabled:ei,expandedFramePresetType:ea,colorFormat:eo,propertiesPanelSplitPosition:el,permissionsState:t,key:(0,nR.tw)()??void 0,appModel:l,sceneGraph:s,sceneGraphSelection:c,selectionPaints:d,selectionProperties:p,selectedStyleProperties:m,currentUserOrgId:u,dropdownShown:E,fonts:y,fileVersion:_,allSavedPlugins:g,library:h,localPlugins:v,modalShown:b,multiplayer:S,openFile:T,pickerShown:N,pickerInStyleCreationShown:I,publishedPlugins:P,saveAsState:C,selectedView:A,stylePickerListLayout:w,stylePickerShown:O,stylePreviewShown:x,styleSets:D,usedKeyboardShortcuts:R,user:M,userFlags:L,userStateLoaded:V,repos:K,folders:F,teams:B,orgById:G,orgUsersByOrgId:z,userEduGracePeriods:Y,licenseGroups:W,isUI3:H,showVoiceWidget:k,hasMergedDimensionsAndAutolayout:H,inProductHelpViewType:eu,inProductHelpSidePanelWidth:eE,justChangedMinimizeUIValue:ey,isUIMinimized:e_}))});var sg=n(574068),sh=n(889085),sf=n(648836),sv=n(481483),sb=n(544750),sS=n(75888),sT=n(677859),sN=n(541524),sI=n(630978),sP=n(695342),sC=n(221537),sA=n(12519);let sk="stack_controls--input--gK1jo text--fontNeg12--2PWcg text--_fontBase--QdLsd text--_negText--j9g-L",sw="stack_controls--scrubbableControl--b1ChI",sO="stack_controls--inputSvg--wFizL",sx="stack_controls--stackSpacingRow--Uus3H";function sD(){let e=(0,er.J2)(i.Ez5.canvasViewState().focusedStackRegion);if(!e)return null;let{region:t,focus:n}=e;return t===i.RN9.SPACING?o.createElement(sM,{focusOnMount:n}):t===i.RN9.COUNTER_SPACING?o.createElement(sL,{focusOnMount:n}):o.createElement(sV,{stackRegion:t,focusOnMount:n})}let sR=e=>{if(e.keyCode===aw.Uz.TAB){e.preventDefault(),e.currentTarget.blur();let t=e.shiftKey;i.Qa7.tabActiveStackRegion(t)}};function sM({focusOnMount:e}){return o.createElement(ab.fI,{className:sx},o.createElement(sA.KI,{focusOnMount:e,outerClassName:sw,inputClassName:sk,svgClassName:sO,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:sR,onPaste:sK,noBorderOnFocus:!0,recordingKey:"stackSpacingControl",inputTestId:"stackSpacingControl",source:"canvas",onCanvasUI:!0}))}function sL({focusOnMount:e}){return o.createElement(ab.fI,{className:sx},o.createElement(sI.q,{focusOnMount:e,outerClassName:sw,inputClassName:sk,svgClassName:sO,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:sR,onPaste:sK,noBorderOnFocus:!0,recordingKey:"stackCounterSpacingControl",inputTestId:"stackCounterSpacingControl",source:"canvas",onCanvasUI:!0}))}function sV({stackRegion:e,focusOnMount:t}){let[n]=(0,sC.HF)(e),a=Array.isArray(n)?n.length:0;return e===i.RN9.SPACING?null:o.createElement(ab.fI,{className:eA()("stack_controls--stackPaddingRow--40WUa",{"stack_controls--large--bJFUN":a>3})},o.createElement(sP.s,{paddingSelection:e,focusOnMount:t,outerClassName:sw,inputClassName:sk,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:sR,onPaste:sK,noBorderOnFocus:!0,svgClassName:sO,recordingKey:"stackPaddingControl",inputTestId:"stackPaddingControl",source:"canvas",disableVariablesEntryPoint:!0}))}function sK(e){(0,sN.gk)(e)&&(e.preventDefault(),e.currentTarget.blur(),t1.l7.user("paste-in-stack",()=>{i.glU.triggerAction("paste",{})}))}let sU=o.memo(function(){return(0,r.d4)(e=>e.mirror.appModel.isReadOnly)?null:o.createElement(sF,null)});function sF(){return o.createElement(sf.k,{isShown:!0},o.createElement(sS.IA,null,o.createElement(sB,{testID:"DesignInlineMenu"})))}function sB({testID:e}){let t=(0,r.d4)(e=>{let t=e.mirror.selectionProperties.stackMode;return 1===e.mirror.selectionProperties.numSelected&&("HORIZONTAL"===t||"VERTICAL"===t)});return(0,r.d4)(e=>{let t=e.mirror.selectionProperties.selectedWidgetInfo;return!!(1===e.mirror.selectionProperties.numSelected&&t?.propertyMenu.length)})?o.createElement(sT.W1,{size:"small",testID:e},o.createElement(sv.jk,null),o.createElement(sb.x,null)):t?o.createElement(sT.W1,{testID:e,darkModePreferred:!0},o.createElement(sD,{key:"stackControls"})):null}var sG=n(284321),sz=n(100303),sY=n(137345),sW=n(286723),sH=n(876743),s$=n(475618),sX=n(412371),sQ=n(624488),sJ=n(515288),sj=n(936486),sq=n(237701);let sZ=new Map,s0=o.memo(function(){let e=(0,f.md)((0,sG.Xh)(void 0)),t=(0,F.q5)(),n=(0,em.GS)(),a=(0,U.aV)();(0,eB.bi)();let r=(0,j.X0)(),l=!!t&&e;return o.useEffect(()=>{l&&(0,eL.YQ)({id:"Found Updates To Publish"})},[l]),o.createElement(sH.Q,{ignoreRulers:a},o.createElement(sJ.s,null),o.createElement(sQ.$,null,n&&o.createElement(sq.n,null),n&&o.createElement(sj.d,{shouldUseBottomBorder:!r}),o.createElement(s1,null)))});function s1(){let e=(0,r.d4)(e=>e.leftPanel),t=(0,eB.cT)(),{pagesList:n,pageToNumChangesMap:a,isComparingChanges:l}=function(){let e=(0,eB.n0)(),t=(0,r.d4)(e=>!!(0,s.kc)().version_diffing&&e.mirror.appModel.activeCanvasEditModeType===i.m1T.COMPARE_CHANGES),n=(0,r.d4)(e=>e.versionHistory.compareId);return o.useMemo(()=>{if(!t||!n)return{pagesList:e,pageToNumChangesMap:sZ,isComparingChanges:t};let a=(0,sW.ee)(e);return{pagesList:e,pageToNumChangesMap:a,isComparingChanges:t}},[t,n,e])}(),c=(0,sX.g)({pagesList:n}),d=(0,eB.GQ)(),p=(0,er.J2)(i.Ez5.uiState().showCanvasSearch),m=(0,er.J2)(i.Ez5.uiState().showDesignLinter),u=tG();return p?o.createElement(sz.EA.Provider,{value:!0},o.createElement(sY.f,{showFilter:!0})):(0,s.kc)().aip_flower_garden&&m&&!u?o.createElement(nE,null):n.length>0?o.createElement(s$.y,{recordingKey:"pagesPanel",isReadOnly:t,width:d,pagesList:n,activeTab:e.activeTab,isDevHandoff:!1,isDevHandoffOverview:!1,isComparingChanges:l,pageToNumChanges:a,onPageContextMenu:c}):null}var s2=n(319008),s4=n(988889),s8=n(959369),s3=n(359919),s5=n(980650);let s7=(0,o.memo)(function(e){return(0,tC.jsxs)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:[(0,tC.jsx)("mask",{id:"fpl-icon-24-mail-a",fill:"#fff",children:(0,tC.jsx)("path",{fillRule:"evenodd",d:"M5.88 7h12.24a.88.88 0 0 1 .88.88v.82l-7 3.733L5 8.7v-.82A.88.88 0 0 1 5.88 7M4 8.99v7.13A1.88 1.88 0 0 0 5.88 18h12.24A1.88 1.88 0 0 0 20 16.12V7.88A1.88 1.88 0 0 0 18.12 6H5.88A1.88 1.88 0 0 0 4 7.88zm15 .843v6.287a.88.88 0 0 1-.88.88H5.88a.88.88 0 0 1-.88-.88V9.833l6.765 3.608.235.126.235-.126z",clipRule:"evenodd"})}),(0,tC.jsx)("path",{fill:"var(--color-icon)",d:"m19 8.7.47.882L20 9.3v-.6zm-7 3.733-.47.883.47.25.47-.25zM5 8.7H4v.6l.53.282zm-1 .31h1v-.02zm0-.02 1 .02v-.02zm16 .02-1-.02v.02zm0-.02h-1v.02zm-1 .843h1V8.167l-1.47.784zm-14 0 .47-.882L4 8.167v1.666zm6.765 3.608-.47.882zm.235.126-.47.882.47.251.47-.251zm.235-.126.471.882zM18.12 6H5.88v2h12.24zM20 7.88A1.88 1.88 0 0 0 18.12 6v2a.12.12 0 0 1-.12-.12zm0 .82v-.82h-2v.82zm-7.53 4.616 7-3.734-.94-1.764-7 3.733zM4.53 9.582l7 3.734.94-1.765-7-3.733zM4 7.88v.82h2v-.82zM5.88 6A1.88 1.88 0 0 0 4 7.88h2a.12.12 0 0 1-.12.12zM5 8.99v.02l-2-.04v.06zm-2 .02v7.11h2V9.01zm0 7.11A2.88 2.88 0 0 0 5.88 19v-2a.88.88 0 0 1-.88-.88zM5.88 19h12.24v-2H5.88zm12.24 0A2.88 2.88 0 0 0 21 16.12h-2a.88.88 0 0 1-.88.88zM21 16.12V9.01h-2v7.11zm-2-7.11v-.02l2 .04v-.06zm2-.02V7.88h-2v1.11zm0-1.11A2.88 2.88 0 0 0 18.12 5v2a.88.88 0 0 1 .88.88zM18.12 5H5.88v2h12.24zM5.88 5A2.88 2.88 0 0 0 3 7.88h2A.88.88 0 0 1 5.88 7zM3 7.88v1.11h2V7.88zm17 8.24V9.833h-2v6.287zM18.12 18A1.88 1.88 0 0 0 20 16.12h-2a.12.12 0 0 1 .12-.12zM5.88 18h12.24v-2H5.88zM4 16.12A1.88 1.88 0 0 0 5.88 18v-2a.12.12 0 0 1 .12.12zm0-6.287v6.287h2V9.833zm8.235 2.726L5.471 8.95l-.941 1.765 6.764 3.608zm.236.125-.236-.125-.94 1.765.235.125zm-.706-.125-.236.125.942 1.765.235-.126zm6.764-3.608-6.764 3.608.941 1.765 6.765-3.608z",mask:"url(#fpl-icon-24-mail-a)"})]})});var s6=n(137035),s9=n(737947),ce=n(27087),ct=n(809840),cn=n(218997),ca=n(15839),co=n(233286);function cr(){let e=(0,L.e)({overlay:$.Dqt,priority:Y.N.DEFAULT_MODAL});(0,M.E)(e.uniqueId,"commentThreadMobileAnnouncementClicked",()=>{(0,ek.sx)("sidebar_announcement_mobile_app_download_prompt_modal_shown"),e.show({})});let t=(0,o.useCallback)(async()=>{(0,ek.sx)("sidebar_announcement_mobile_app_download_prompt_email_me_cta_clicked"),await ce.Ay.post("/api/send_mobile_download_email"),e.complete()},[e]);return o.createElement(cn.h,{isShowing:e.isShowing,modalType:ca.q3.FEATURE_UPDATE,closeButtonStyle:ca.M_.ON_DARK,element:()=>o.createElement(cl,{onEmailClick:t}),trackingContextName:"mobile_comment_announcement",onClickPrimaryCta:e.complete,onClose:e.complete,onManualDismiss:e.complete})}function cl(e){return o.createElement("div",{className:"modal_comment_sidebar_announcement--container--5oh-p"},o.createElement("div",{className:"modal_comment_sidebar_announcement--imageContainer--Vuo-V"},o.createElement("img",{alt:"Background",src:(0,s.ck)("e19f2f58bc09414847ad59ff9228e07032e8842c"),className:"modal_comment_sidebar_announcement--image--lyA61"}),o.createElement("div",{className:"modal_comment_sidebar_announcement--spacer--m02YT"}),o.createElement(co.T,null)),o.createElement("div",{className:"modal_comment_sidebar_announcement--textContainer--btaTy"},o.createElement("div",{className:"modal_comment_sidebar_announcement--title--eiyLq"},o.createElement(ct.E,{fontSize:24,fontWeight:"semi-bold"},(0,T.t)("rcs.mobile_comment_announcement.title"))),o.createElement("div",{className:"modal_comment_sidebar_announcement--description--Y8AJE"},o.createElement(ct.E,{fontSize:14},(0,T.t)("rcs.mobile_comment_announcement.description")))),o.createElement("div",{className:"modal_comment_sidebar_announcement--buttonsContainer--UTcgc"},o.createElement(nt.$n,{variant:"secondary",onClick:e.onEmailClick,iconPrefix:o.createElement(s7,null)},(0,T.t)("rcs.mobile_comment_announcement.email_download_link")),o.createElement(nt.$n,{variant:"primary",onClick:()=>{(0,ek.sx)("sidebar_announcement_mobile_app_download_prompt_learn_more_cta_clicked"),s9.Ay.unsafeRedirect("https://help.figma.com/hc/articles/1500007537281-Guide-to-the-Figma-mobile-app#download","_blank")},iconPrefix:o.createElement(s6.b,null)},(0,T.t)("rcs.rcs_shared.learn_more"))))}var ci=n(723215),cs=n(866206),cc=n(355819),cd=n(457630),cp=n(83695),cm=n(344780),cu=n(820286),cE=n(175290),cy=n(503965);let c_=(0,io.ex)("prototype_action_info",function(){return o.createElement("div",{className:S.cx.flex.itemsCenter.justifyCenter.$},o.createElement(tx.B,{className:"prototype_action_info_tooltip--prototypeDestinationInfoIcon--GeQWS",svg:cy.A}),o.createElement("span",{className:S.cx.flexGrow1.m6.$,style:{maxWidth:144}},(0,T.tx)("proto.prototype_panel.use_the_circular_node_to_connect_the_selected_object_to_another_frame_tooltip")))},()=>({unconstrainWidth:!0})),cg=(0,o.memo)(function(e){return(0,tC.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,tC.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M11.5 6a.5.5 0 0 1 .5.5V11a1 1 0 0 0 1 1h4.5a.5.5 0 0 1 0 1H13a2 2 0 0 1-2-2V6.5a.5.5 0 0 1 .5-.5",clipRule:"evenodd"})})});var ch=n(995672),cf=n(647899);class cv extends rq.c${}class cb extends rq.l6{}function cS({action:e}){return o.createElement("div",{className:"prototype_action_dropdown--prototypeActionIcon--qChhY"},o.createElement(aA.U,{svg:(0,lY.Yb)(e)},(0,lY.av)(e)))}function cT(e){let t=`prototype-action-select-${e.recordingKey}`,n=e.dropdownShown&&e.dropdownShown.type===t,a=(0,n3.E7)(e.action),l=(0,lY.Yb)(a),i=(0,lY.av)(a),s=(0,em.GS)(),c=(0,r.d4)(lQ.ZM),d=new lz.js(s,c),p=new lz.Z6(s,c),m=n?d:p,u=!(0,r.d4)(e=>e.mirror.selectionProperties.isValidPrototypingSourceSelected??!0),E=o.useCallback(e=>e-24,[]),y=o.useCallback(e=>e+24,[]),[_,g]=o.useState(void 0),h=o.createElement(ch.Q,{setMaxWidth:g,options:cN(e),formatOption:e=>e&&e.props.value?m.format(e.props.value):"",getIcon:()=>o.createElement(cS,{action:"NAVIGATE_TO"})}),f=eA()({[e.className??""]:!0,"prototype_action_dropdown--select--b3Ssx":!s}),v=o.createElement(aA.U,{svg:l},i);return o.createElement(o.Fragment,null,o.createElement(cb,{disabled:u,id:t,dataTestId:"action-select",className:f,chevronClassName:"prototype_action_dropdown--prototypeActionChevron--ZL1Q4",inputClassName:"prototype_action_dropdown--prototypeActionInputWithSvg--Atfua",property:e.action,formatter:m,onChange:e.onChange,dispatch:e.dispatch,dropdownShown:e.dropdownShown,icon:v,iconClassName:"prototype_action_dropdown--selectActionSvg--XfhUx",recordingKey:ar.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,nR.nl)(),dropdownAlignment:E,dropdownWidth:s?_:y},cN(e)),s&&h)}function cN(e){let t=(0,lc.cJ)(),n=(0,em.GS)(),a=o.createElement(cv,{key:"NONE",value:"NONE",icon:o.createElement(cS,{action:"NONE"}),recordingKey:ar.Pt(e,"clear-option"),disabled:!1}),r=o.createElement(cv,{key:"NAVIGATE_TO",value:"NAVIGATE_TO",icon:o.createElement(cS,{action:"NAVIGATE_TO"}),recordingKey:ar.Pt(e,"navigate-to-option"),disabled:!1}),l=o.createElement(cv,{key:"SWAP_STATE_TO",value:"SWAP_STATE_TO",icon:o.createElement(cS,{action:"SWAP_STATE_TO"}),recordingKey:ar.Pt(e,"swap-state-to-option"),disabled:!i.glU.isSelectionContainedInStateOrStateInstance()}),c=o.createElement(cv,{key:"GO_BACK",value:"GO_BACK",icon:o.createElement(cS,{action:"GO_BACK"}),recordingKey:ar.Pt(e,"back-option"),disabled:!1}),d=o.createElement(cv,{key:"SCROLL_TO",value:"SCROLL_TO",icon:o.createElement(cS,{action:"SCROLL_TO"}),recordingKey:ar.Pt(e,"scroll-to-option"),disabled:!1}),p=o.createElement(cv,{key:"OPEN_URL",value:"OPEN_URL",icon:o.createElement(cS,{action:"OPEN_URL"}),recordingKey:ar.Pt(e,"url-option"),disabled:!1}),m=o.createElement(cv,{key:"OPEN_OVERLAY",value:"OPEN_OVERLAY",icon:o.createElement(cS,{action:"OPEN_OVERLAY"}),recordingKey:ar.Pt(e,"open-overlay-option"),disabled:!1}),u=o.createElement(cv,{key:"SWAP_WITH",value:"SWAP_WITH",icon:o.createElement(cS,{action:"SWAP_WITH"}),recordingKey:ar.Pt(e,"swap-with-option"),disabled:!1}),E=o.createElement(cv,{key:"CLOSE_OVERLAY",value:"CLOSE_OVERLAY",icon:o.createElement(cS,{action:"CLOSE_OVERLAY"}),recordingKey:ar.Pt(e,"close-option"),disabled:!1}),y=o.createElement(cv,{key:"SET_VARIABLE",value:"SET_VARIABLE",icon:o.createElement(cS,{action:"SET_VARIABLE"}),recordingKey:ar.Pt(e,"set-variable"),disabled:!1}),_=(0,s.kc)().prototype_set_mode_action&&o.createElement(cv,{key:"SET_VARIABLE_MODE",value:"SET_VARIABLE_MODE",icon:o.createElement(cS,{action:"SET_VARIABLE_MODE"}),recordingKey:ar.Pt(e,"set-variable-mode"),disabled:!1}),g=!e.isNestedInConditional&&o.createElement(cv,{key:"CONDITIONAL",value:"CONDITIONAL",icon:o.createElement(cS,{action:"CONDITIONAL"}),recordingKey:ar.Pt(e,"conditional"),disabled:!1}),h=o.createElement(rq.sK,{key:"first-divider"}),f=o.createElement(rq.sK,{key:"second-divider"}),v=o.createElement(rq.sK,{key:"third-divider"}),{getConfig:b}=(0,cf.I7)("exp_prototyping_reorder_actions"),S=!!b().getValue("new_ordering",!1),T=(0,s.kc)().sts_interaction_interop&&t?[l,c,d,h,y,g]:n?S?[a,h,r,l,c,d,p,f,y,_,g,v,m,u,E]:[a,h,r,l,c,d,p,f,m,u,E,v,y,_,g]:[a,h,r,l,c,f,y,_,g,d,p,v,m,u,E];if(e.showVideoActions&&!t){let t=[o.createElement(rq.sK,{key:"fourth-divider"}),o.createElement(cv,{key:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",value:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",icon:o.createElement(cS,{action:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS"}),recordingKey:ar.Pt(e,"update-media-play-pause-options"),disabled:!1}),o.createElement(cv,{key:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",value:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",icon:o.createElement(cS,{action:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS"}),recordingKey:ar.Pt(e,"update-media-mute-unmute-options"),disabled:!1}),o.createElement(cv,{key:"UPDATE_MEDIA_SKIP_TO",value:"UPDATE_MEDIA_SKIP_TO",icon:o.createElement(cS,{action:"UPDATE_MEDIA_SKIP_TO"}),recordingKey:ar.Pt(e,"update-media-skip_to"),disabled:!1}),o.createElement(cv,{key:"UPDATE_MEDIA_SKIP_BY_OPTIONS",value:"UPDATE_MEDIA_SKIP_BY_OPTIONS",icon:o.createElement(cS,{action:"UPDATE_MEDIA_SKIP_BY_OPTIONS"}),recordingKey:ar.Pt(e,"update-media-skip-by-options"),disabled:!1})];T=T.concat(t)}return T.filter(Boolean)}var cI=n(983405),cP=n(773833),cC=n(736656),cA=n(533573),ck=n(712685),cw=n(843709);let cO="prototype_action_verbose_title--actionNameInsertion--aF4kI",cx="prototype_action_verbose_title--actionName--qWJL3",cD="prototype_action_verbose_title--actionNameUI3--JAYsG",cR=()=>{let e=(0,r.d4)(e=>e.mirror.sceneGraph);return o.useMemo(()=>new lz.cP(e),[e])};function cM({action:e,isNestedInConditional:t,isNarrowPanel:n,onClick:a}){let r=(0,l0.YT)()===l0.Oz.TWO_COL,l=o.useContext(cC.c),s=r&&l===cC.P.LEFT,c=t||n,d=(0,oz.u)((0,n3.hS)(e.targetVariable)&&e.targetVariable&&"id"in e.targetVariable?e.targetVariable?.id:void 0),p=(0,n3.hS)(e.targetVariable)&&e.targetVariable&&"nodeFieldAlias"in e.targetVariable?(0,cP.aA)(e.targetVariable.nodeFieldAlias.stablePathToNode,e.targetVariable.nodeFieldAlias.indexOrKey):void 0,m=d?.name??p?.name,u=cR(),E=new lz.Z6((0,em.GS)()),y=(0,lz._X)(e),_=(0,n3.E7)(y),g=o.createElement(aA.U,{svg:(0,lY.Yb)(_)},(0,lY.av)(_)),h=e=>{if(!e.connectionType||(0,n3.gl)(e.connectionType))return null;let t=eA()({[cx]:!0,[cD]:r}),n=eA()({"prototype_action_verbose_title--actionDestination--JZ-gU":!0,"prototype_action_verbose_title--actionDestinationUI3--ZGxbq":r});switch(e.connectionType){case"NONE":case"SET_VARIABLE_MODE":case"OBJECT_ANIMATION":return null;case"INTERNAL_NODE":case"BACK":case"CLOSE":case"UPDATE_MEDIA_RUNTIME":{let a=e.transitionNodeID;if((0,n3.gl)(a))return o.createElement("div",{className:t},(0,T.t)("proto.variant_actions.mixed"));if(void 0===a)return null;let r=ld.dI(a),l=u.format(r);return o.createElement("div",{className:n},l)}case"URL":{let a=e.connectionURL;if(!a)return null;if((0,n3.gl)(a))return o.createElement("div",{className:t},(0,T.t)("proto.variant_actions.mixed"));return o.createElement("div",{className:n},a)}case"SET_VARIABLE":if(!e.targetVariableData||(0,n3.gl)(e.targetVariableData))return null;return o.createElement("div",{className:"prototype_action_verbose_title--setVariablePreviewContainer--6omxy"},o.createElement(cp.y3,{targetVariableData:e.targetVariableData,onClick:b.lQ,showVariableThumbnails:!1,isNarrowPanel:c,isInConditional:!0}));case"CONDITIONAL":{if((0,n3.gl)(e)||(0,n3.gl)(e.conditionalActions)||!e.conditionalActions)return null;let t=e.conditionalActions.length>0?e.conditionalActions[0].condition:void 0;return o.createElement(cp.y3,{targetVariableData:t,onClick:b.lQ,isInConditional:!0,showVariableThumbnails:!1})}default:(0,n9.xb)(e.connectionType)}},f=eA()({[cw.Li]:c&&!r,[cw.O8]:!c&&!r,[cw.kE]:r}),v=eA()({"prototype_action_verbose_title--iconContainer--jqarD":!0,"prototype_action_verbose_title--iconContainerUI3--yBP0-":r});return o.createElement("div",{className:f,onClick:a,role:"button",tabIndex:0},o.createElement(cI.Y1,{horizontalAlignItems:"space-between",width:"fill-parent"},o.createElement("div",{className:v},g),(e=>{let t=_?E.format(_):"Undefined",n=eA()({[cx]:!0,[cD]:r});if((0,n3.gl)(e.connectionType)&&(t=(0,T.t)("fullscreen.mixed")),!e.connectionType||(0,n3.gl)(e.connectionType)||"NONE"===e.connectionType||"BACK"===e.connectionType||"CLOSE"===e.connectionType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t));var a=h(e);switch(e.connectionType){case"INTERNAL_NODE":if("SWAP_STATE"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,T.t)("proto.action_change_to")),a);if(a){if("OVERLAY"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:cO},(0,T.tx)("proto.action_overlay_title",{overlayFrameName:o.createElement("span",null,a)})));if("SWAP"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,T.t)("proto.action_swap_overlay_title")),a)}return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t),a);case"UPDATE_MEDIA_RUNTIME":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t),a);case"URL":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},a?(0,T.t)("proto.action_url_title"):(0,T.t)("proto.action_open_link")),a);case"SET_VARIABLE":{let l=e.targetVariableData&&(0,n3.hS)(e.targetVariableData)&&e.targetVariableData.resolvedType===i.rXF.COLOR,c=eA()({"prototype_action_verbose_title--actionNameInsertionColor--isir- prototype_action_verbose_title--actionNameInsertion--aF4kI":!0,"prototype_action_verbose_title--actionNameInsertionColorUI3--Apj0i":r});if(m&&a)return o.createElement(o.Fragment,null,o.createElement("div",{className:l?c:cO},(0,T.tx)("proto.action_set_variable_title",{variableName:o.createElement("span",{className:"prototype_action_verbose_title--variableNameContainer--XeJX2"},o.createElement(ck.wG,{text:m,isDeleted:!!d&&(0,cA.eF)(d),disableHover:s})),variableValue:o.createElement("span",{className:"prototype_action_verbose_title--variableDestinationContainer--RXbKo prototype_action_verbose_title--variableNameContainer--XeJX2"},a)})));return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t))}case"SET_VARIABLE_MODE":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,T.t)("proto.action_set_variable_mode")));case"CONDITIONAL":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},r?(0,T.t)("proto.if"):(0,T.t)("proto.action_conditional_title")),a);case"OBJECT_ANIMATION":return o.createElement(o.Fragment,null);default:(0,n9.xb)(e.connectionType)}})(e)))}var cL=n(396353),cV=n(789529),cK=n.n(cV),cU=n(636149),cF=n.n(cU),cB=n(675551),cG=n.n(cB),cz=n(184058),cY=n.n(cz),cW=n(154483),cH=n(564092),c$=n(896850);let cX="prototype_set_variable_mode_controls--dropdownRow--vl5z4",cQ="missing";class cJ extends rq.l6{}class cj extends rq.c${}class cq extends rq.l6{}class cZ extends rq.c${}let c0={},c1=(0,cW.fv)();function c2(){let e=(0,oz.h6)()||c0,t=(0,cH.iR)(),n=o.useMemo(()=>{let n=cG()(t,(e,t)=>({collectionID:e.node_id,collectionName:e.name,key:e.key,modeOptions:e.modes?.map(t=>({modeId:{guid:t.id,collectionKey:e.key},name:t.name,isCompatible:!0}))||[],explicitMode:null,inheritMode:null,fileKey:c1(e),libraryKey:e.library_key}));return cK()({},e,n)},[t,e]),a=o.useMemo(()=>Object.entries(n).map(([e,t])=>({setKey:e,modeData:t,isLocal:void 0===t.fileKey})),[n]),l=o.useMemo(()=>Object.values(a).filter(e=>e.modeData?.modeOptions&&e.modeData?.modeOptions.length>1),[a]),s=o.useMemo(()=>cY()(l.map(e=>e.modeData.fileKey??c$.BH)),[l]),c=(0,oz.el)(s),[d,p]=o.useMemo(()=>{let{_local:e,_unknownFile:t,...n}=cF()(l,e=>e.isLocal?"_local":e.modeData.fileKey&&void 0===c[e.modeData.fileKey]?"_unknownFile":e.modeData.fileKey),a=Object.entries(n).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>[{fileKey:e,fileName:c[e]},...t]).flat(1);return t&&(a.push({fileKey:c$.BH,fileName:(0,T.t)("variables.mode_properties_panel.used_variables.subheading")}),a.push(...t)),[e??[],a]},[c,l]),m=(0,cH.d2)(),u=o.useCallback(e=>{let t=m[(0,at.yG)(e)],n=l.find(t=>t.setKey===e);if(n)return(e=>{if(e)return void 0===t&&(t=e.modeData.modeOptions[0].modeId.guid),e.modeData.modeOptions.find(e=>e.modeId.guid!==t&&(t=e.modeId.guid,!0))?.modeId.guid})(n)},[m,l]),E=l.length>0?l[0]:void 0,y=E?.setKey,_=E?.modeData.collectionID,g=o.useMemo(()=>y&&u(y),[y,u]),h=(0,r.wA)();return{localVariableSets:d,allVariableSets:l,firstVariableSet:E,firstVariableSetID:_,firstVariableSetMode:g,getDefaultNewModeForVariableCollectionKey:u,reportAnalyticsEventWhenSelected:e=>{let t=i.mSn.getVariableSetInfoForSetModeAnalytics(e);h((0,lp.Zh)({name:"prototype.set_mode_select_variable_set",params:{...t}}))},subscribedVariableSetsWithSections:p}}function c4({targetVariableSetID:e,targetVariableModeID:t,deprecatedTargetVariableSetKey:n,updateSelectionProperties:a,recordingKey:r,actionIndexPath:l}){let{getDefaultNewModeForVariableCollectionKey:i,allVariableSets:s,reportAnalyticsEventWhenSelected:c}=c2(),{shouldShowAdvancedPrototypingPaywall:d,showAdvancedPrototypingVariablesModal:p}=(0,l0.zt)(),m=(0,em.GS)();o.useEffect(()=>{if(!n||(0,n3.gl)(n))return;let e=s.find(e=>e.setKey===n);e?((0,n1.Lo)("SetVariableModeControls","updating variable set key to non-deprecated id value"),a({targetVariableSetKey:void 0,targetVariableSetID:e?.modeData.collectionID})):((0,n1.Lo)("SetVariableModeControls","attempted to update variable set key to non-deprecated id value, but could not find it in the list of variable sets, will just clear out the bad data."),a({targetVariableSetKey:void 0}))},[n,s,a]);let[u,E]=o.useMemo(()=>{let t=(0,n3.gl)(e)||void 0===e?e:function(e,t){let n=e.find(e=>e.modeData.collectionID===t);if(n)return n;let a=cL.gr.toRefIfSubscribed(t);if(a)return e.find(e=>e.setKey===a.key)}(s,e)||cQ,n=(()=>{if(!(0,n3.gl)(t)&&void 0!==t&&t!==cQ)return t})();return[t,n]},[e,s]),y=o.createElement(c5,{selectedVariableSet:u,onChange:e=>{d?p():(c(e.modeData.collectionID),a({targetVariableSetID:e.modeData.collectionID,targetVariableModeID:i(e.setKey)}))},actionIndexPath:l}),_=m?o.createElement(rZ.cS,{input:y,label:(0,T.tx)("proto.set_variable_mode.collection_label")}):o.createElement(ab.fI,{recordingKey:ar.Pt(r,"selectTargetVariableSet")},y),g=o.createElement(c9,{selectedVariableSetKey:E&&E.setKey,selectedVariableModeID:t,onChange:e=>{d?p():a({targetVariableModeID:e})},actionIndexPath:l}),h=m?o.createElement(rZ.cS,{input:g,label:(0,T.tx)("proto.set_variable_mode.mode_label")}):o.createElement(ab.fI,{recordingKey:ar.Pt(r,"selectTargetVariableMode")},g);return o.createElement("div",{className:m?void 0:S.cx.relative.$},_,E&&h)}let c8={format:e=>void 0===e?(0,T.t)("proto.prototype_panel.edit_set_mode.none"):e===cQ?(0,T.t)("proto.prototype_panel.edit_set_mode.missing_collection"):e.modeData.collectionName,isEqual:(e,t)=>void 0!==e&&void 0!==t&&e!==cQ&&t!==cQ&&(e.setKey===t.setKey||e.modeData.collectionID===t.modeData.collectionID)};function c3(e,t){return"fileKey"in e?[t&&o.createElement(rq.sK,{key:e.fileKey+"divider"}),o.createElement(cj,{isHeader:!0,key:e.fileKey+"header",formattedValue:e.fileName})]:o.createElement(cj,{key:e.setKey,value:e})}function c5({selectedVariableSet:e,onChange:t,actionIndexPath:n}){let a=(0,r.wA)(),l=(0,a0.Um)(),i="set-variable-mode--select-variable-set-"+n,{localVariableSets:c,allVariableSets:d,subscribedVariableSetsWithSections:p}=c2();return o.createElement(cJ,{id:i,className:cX,property:e,formatter:c8,dispatch:a,dropdownShown:l?.type===i?l:null,onChange:e=>{(0,n3.gl)(e)||void 0===e||e===cQ||t(e)}},d.length>0?[c.length>0&&o.createElement(cj,{key:ar.Pt(i,"local_variables"),isHeader:!0,formattedValue:(0,s.kc)().ds_variable_props_unified_ui?(0,T.t)("variables.mode_properties_panel.assets_created_in_file.subheading"):(0,T.t)("variables.mode_properties_panel.local_variables.subheading")}),...c.map(e=>c3(e,!1)),...p.map((e,t)=>c3(e,c.length>0||t>0))]:[])}let c7={format:e=>void 0===e?(0,T.t)("proto.prototype_panel.edit_set_mode.none"):e===cQ?(0,T.t)("proto.prototype_panel.edit_set_mode.missing_mode"):e?.name??""};function c6(e){return o.createElement(cZ,{key:e.modeId.guid,value:e})}function c9({selectedVariableSetKey:e,selectedVariableModeID:t,onChange:n,actionIndexPath:a}){let l=(0,r.wA)(),i=(0,a0.Um)(),s="set-variable-mode--select-variable-mode-"+a,{allVariableSets:c}=c2(),d=o.useMemo(()=>c.find(t=>t.setKey===e)?.modeData.modeOptions,[e,c]),p=o.useMemo(()=>(0,n3.gl)(t)||void 0===t?t:d?.find(e=>e.modeId.guid===t)||cQ,[t,d]);return o.createElement(cq,{id:s,className:cX,property:p,formatter:c7,dispatch:l,dropdownShown:i?.type===s?i:null,onChange:e=>{!e||(0,n3.gl)(e)||e===cQ||n(e.modeId.guid)}},d&&d?.map(c6))}var de=n(910392),dt=n(909666),dn=n(442458);let da=no.TI;function dr({children:e}){return(0,em.GS)()?o.createElement(rZ.TN,null,e):o.createElement(ab.fI,{className:"overlay_panel--fplCheckboxRow--EYTAZ checkbox--_checkboxRow--oEhow"},e)}function dl({interactionType:e,recordingKey:t,actionIndexPath:n,nodeId:a}){let[l,s]=o.useState(!1),[c,d]=o.useState(new tS.Mi),p=(0,r.wA)(),m=(0,em.GS)(),u="{ "+n.join(", ")+" }",{destinationOverlayBackgroundColor:E,destinationOverlayBackgroundType:y,destinationOverlayPositionType:_,destinationOverlayBackgroundInteraction:g}=(0,iH.R)(e=>({destinationOverlayBackgroundColor:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[u]?.destinationOverlayBackgroundColor,destinationOverlayBackgroundType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[u]?.destinationOverlayBackgroundType,destinationOverlayPositionType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[u]?.destinationOverlayPositionType,destinationOverlayBackgroundInteraction:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[u]?.destinationOverlayBackgroundInteraction})),h=o.useRef(),f=o.useRef(),v=o.useCallback(()=>{s(!1)},[s]),b=o.useCallback(()=>{if(l)v();else{s(!0);let e=m?aS.findDOMNode(f.current):aS.findDOMNode(h.current);d((0,rJ.cn)(e))}},[l,v,m]),S=o.useCallback(e=>{let t=e?"SOLID_COLOR":"NONE";t1.l7.user("overlay-background-type-edit-scope",()=>{i.X3B.setOverlayBackgroundType(ld.dI(a),t)}),p((0,lp._P)({name:"Overlay background visible changed",params:{backgroundType:t}}))},[p,a]),N=o.useCallback(e=>{let t=e?"CLOSE_ON_CLICK_OUTSIDE":"NONE";t1.l7.user("overlay-background-interaction-edit-scope",()=>{i.X3B.setOverlayBackgroundInteraction(ld.dI(a),t)}),p((0,lp._P)({name:"Overlay background interaction changed",params:{backgroundInteraction:t}}))},[p,a]),I=o.useCallback(()=>(0,n3._W)(E,{r:0,g:0,b:0,a:.25}),[E]),P=o.useCallback((e,t)=>{t!==l$.zk.NO&&t1.l7.user("overlay-background-color-edit-scope",()=>{i.X3B.setOverlayBackgroundColor(ld.dI(a),e)})},[a]),C=o.useCallback((e,t)=>{P(e,l$.zk.YES)},[P]),A=o.useCallback((e,t)=>{let n=I();P({r:n.r,g:n.g,b:n.b,a:e},t)},[I,P]),k=o.useCallback(e=>{t1.l7.user("overlay-position-type-edit-scope",()=>{i.X3B.setOverlayPositionType(ld.dI(a),e)}),p((0,lp._P)({name:"Overlay position changed",params:{position:e}}))},[p,a]),w=I(),O=I().a,x=(0,n3.E7)(_),D="CLOSE_ON_CLICK_OUTSIDE"===(0,n3.E7)(g),R="SOLID_COLOR"===(0,n3.E7)(y),M=o.createElement("div",{className:"overlay_panel--colorValueContainer--gJtb9 paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t"},o.createElement(t6.J,{onClick:R?b:()=>{},color:w,opacity:O,recordingKey:ar.Pt(t,"chit"),className:"overlay_panel--chit--Zn66r paint_panels--chit--twQEy"}),o.createElement(nr.AN,{className:m?"overlay_panel--colorInputUI3--ozOrK paint_panels--colorInput--nSz13":"overlay_panel--colorInput--6yyym paint_panels--colorInput--nSz13",noLeftBorder:!0,formatter:da,property:w,disabled:!R,onChange:C,recordingKey:ar.Pt(t,"colorInput"),noBorderOnFocus:!0}),o.createElement(rm.Pd,{className:"overlay_panel--opacity--vrrjV paint_panels--opacityInputContainer--oqlsk",value:O,onValueChange:A,dispatch:p,disabled:!R,noBorderOnFocus:!0,recordingKey:ar.Pt(t,"opacity")}));return o.createElement(ab.Zk,{className:m?"overlay_panel--overlayPanelUI3--GLqgD":"overlay_panel--overlayPanel--l-Hts"},!m&&o.createElement(ab.fI,null,o.createElement(ab.xw,{faded:!0,className:"overlay_panel--overlayPanelTitle--e9pjs"},(0,T.tx)("proto.overlay_settings"))),o.createElement(du,{overlayPositionType:x,onOverlayPositionTypeChange:k,recordingKey:t}),!("ON_HOVER"===e||"ON_PRESS"===e)&&o.createElement(dr,null,o.createElement(r$.S,{label:o.createElement(tI.J,null,(0,T.tx)("proto.close_when_clicking_outside")),recordingKey:ar.Pt(t,"closeOnClickOutside"),onChange:N,checked:D})),o.createElement(dr,null,o.createElement(r$.S,{label:o.createElement(tI.J,null,m?(0,T.tx)("proto.overlay_panel.background"):(0,T.tx)("proto.add_background")),recordingKey:ar.Pt(t,"addBackgroundBehindOverlay"),onChange:S,checked:R})),R&&(m?o.createElement(rZ.cS,{ref:f,label:(0,T.tx)("proto.overlay_panel.background"),input:M}):o.createElement(ab.fI,{ref:h}," ",M," ")),l&&o.createElement(rj.h3,{disabledVariableIds:new Set,initialPosition:c,color:w,boundVariable:null,onChange:P,onClose:v,recordingKey:ar.Pt(t,"colorPicker")}))}class di extends rq.l6{}class ds extends rq.c${}class dc extends o.PureComponent{constructor(){super(...arguments),this.titleFormatter=new lz.Cr,this.renderOverlayPositionOption=(e,t)=>o.createElement(ds,{key:t,value:e,recordingKey:ar.Pt(this.props,e)})}render(){let e=["CENTER","TOP_LEFT","TOP_CENTER","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT"].map(this.renderOverlayPositionOption);return o.createElement(di,{id:this.props.recordingKey??"overlay-position_select",className:this.props.className,chevronClassName:"overlay_panel--chevron--7RTA-",inputClassName:"overlay_panel--input--tGHHB",dropdownWidth:ax.DxS,property:this.props.property,formatter:this.titleFormatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,recordingKey:ar.Pt(this.props,"select")},e,o.createElement(rq.sK,null),this.renderOverlayPositionOption("MANUAL",10))}}dc.displayName="OverlayPositionDropdown";class dd extends lh.I{}class dp extends lh.Y{}class dm extends o.PureComponent{render(){return o.createElement(dd,{className:this.props.className,property:this.props.property,onChange:this.props.onChange,recordingKey:this.props.recordingKey},o.createElement(dp,{value:"CENTER",tooltip:(0,T.t)("proto.tooltip_overlay_position_center"),svg:dt.A,recordingKey:ar.Pt(this.props,"center")}),o.createElement(dp,{value:"TOP_LEFT",tooltip:(0,T.t)("proto.tooltip_overlay_position_top_left"),svg:dn.A,recordingKey:ar.Pt(this.props,"top-left")}),o.createElement(dp,{value:"BOTTOM_CENTER",tooltip:(0,T.t)("proto.tooltip_overlay_position_bottom_center"),svg:de.A,recordingKey:ar.Pt(this.props,"bottom-center")}))}}function du({overlayPositionType:e,onOverlayPositionTypeChange:t,recordingKey:n}){let a=(0,em.GS)(),l=(0,r.wA)(),i=(0,a0.Um)(),s=o.createElement(dc,{className:"overlay_panel--overlayPositionDropdown--ZxxSI",property:e,dispatch:l,dropdownShown:i,onChange:t,recordingKey:ar.Pt(n,"overlayPositionDropdown")}),c=o.createElement(dm,{property:e,onChange:t,recordingKey:ar.Pt(n,"overlayPositionControl"),className:"overlay_panel--overlayPositionControl--SWngJ"});return a?o.createElement(rZ.cS,{label:(0,T.tx)("proto.overlay_panel.position"),input:s}):o.createElement(ab.fI,null,s,c)}var dE=n(171447),dy=n(301036),d_=n(112976),dg=n(728587);let dh=e=>`interaction-panel-create-action-${e}`;function df(e){let t=dh(e.recordingKey);var{showing:n,toggle:a,hide:l}=(0,a0.BK)(t);let i=(0,o.useRef)(null),{recordingKey:s,addButtonPressed:c,presetInteractions:d}=e,{shouldShowAdvancedPrototypingPaywall:p,showAdvancedPrototypinglMultipleActionsModal:m}=(0,l0.zt)(),u=(0,o.useCallback)(()=>{!e.skipPaywall&&p?m():a()},[e.skipPaywall,p,m,a]),E=ar.rf(ar.Pt(s,"createActionDropdown"),"click",u),y=(0,l0.YT)()===l0.Oz.TWO_COL,_=(0,l0.hP)(),g=(0,em.GS)(),h=(0,lc.cJ)(),f=(0,l0.He)({showVideoActions:_,isNestedInConditional:e.isNestedInConditional,isSites:h,isUI3:g,showPresetActions:!!e.presetInteractions}),v=(0,r.wA)(),b=(0,o.useCallback)(e=>{c((0,l0.Bs)(e)),l()},[c,l]),S=eA()({[cw.x1]:e.renderButton,[cw.xm]:!e.renderButton&&!y,[cw.U3]:!e.renderButton&&y}),N=[];return f.forEach(e=>{(0,l0.vc)(e)?N.push(d_.w):e===l0.Xk&&d?.length?N.push(...d,d_.w):N.push(function({actionType:e,clickCb:t,recordingKey:n,isUI3:a}){let r=(0,lY.Yb)(e),l=(0,lY.av)(e),i=new lz.Z6(a),s=e?i.format(e):"Undefined";return{className:cw.BP,callback:()=>t(e),icon:o.createElement(aA.U,{className:cw.QE,svg:r},l),displayText:s,recordingKey:ar.Pt(n,"createActionOption",e)}}({clickCb:b,recordingKey:s,actionType:e,isUI3:g}))}),o.createElement(o.Fragment,null,o.createElement("button",{ref:i,className:S,onClick:E,"aria-label":(0,T.t)("proto.prototype_panel.create_action_button"),"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":e.isNestedInConditional?(0,T.t)("proto.prototype_panel.add_nested_action"):(0,T.t)("proto.prototype_panel.add")},e.renderButton?o.createElement(aA.U,{svg:aF.A},o.createElement(a9.e,null)):(0,T.tx)("fullscreen.properties_panel.click_plus_to_add_new_action")),n&&i.current&&o.createElement(dg.j,{minWidth:130,lean:"center",parentRect:i.current.getBoundingClientRect(),hidePointWhenContentOffScreen:!0,showPoint:!0,items:N,dispatch:v,onSelectItem:e=>e.callback?.(),recordingKey:"actionDropdown"}))}let dv="prototype_conditional_controls--conditionalRowUI3--rQlu6",db="prototype_conditional_controls--conditionIcon--Npk57";var dS=n(381809),dT=n(527967),dN=n(5068);function dI({onDeleteAction:e,updateMultipleDestinationNodes:t,updateSelectionProperties:n,updateCondition:a,updateActions:r,onAddAction:l,autoOpenVariablePicker:s,isSelected:c,handleMouseDownUI3:d,...p}){let m=p.conditionalActions,u=m?.actions?m?.actions:[],E=m?.condition?m?.condition:void 0,y=(0,l0.YT)()===l0.Oz.TWO_COL,_=y?dv:"prototype_conditional_controls--conditionalRowIf--25FqB prototype_conditional_controls--conditionalRow--u0PaS",g=o.createElement(cp.KN,{resolvedType:i.rXF.BOOLEAN,targetVariableData:E,updateSelectionProperties:n,recordingKey:p.recordingKey,updateConditionInConditionalAction:a,showVariableThumbnails:!0,isNarrowPanel:!0}),h=o.createElement("div",{className:"prototype_conditional_controls--addButton--vlYLn"},o.createElement(df,{addButtonPressed:l,recordingKey:ar.Pt(p.recordingKey,"addActionToIfButton"),renderButton:!0,isNestedInConditional:!0})),f=o.createElement(o.Fragment,null,y?o.createElement("span",{className:"prototype_conditional_controls--conditionIconUI3--zcwx0"},(0,T.tx)("proto.else")):o.createElement(tx.B,{className:db,svg:dS.A}),!y&&u.length>0&&o.createElement("div",{className:"prototype_conditional_controls--addButtonForElse--ogBWu prototype_conditional_controls--addButton--vlYLn"},o.createElement(df,{addButtonPressed:l,recordingKey:ar.Pt(p.recordingKey,"addActionToElseButton"),renderButton:!y,isNestedInConditional:!0}))),v=y?o.createElement(aT.E,{className:"prototype_conditional_controls--elseBlockRowUI3--VXjmO",onClick:d},f):o.createElement(ab.fI,{className:y?dv:"prototype_conditional_controls--conditionalRow--u0PaS"},f);return o.createElement(o.Fragment,null,p.ifStatement&&o.createElement("div",{className:_},!y&&o.createElement(cE.Y,{direction:"horizontal",spacing:4},o.createElement("span",{className:y?"prototype_conditional_controls--conditionalRowConditionUI3--M2mOx":"prototype_conditional_controls--conditionalRowCondition--kn-f7"},o.createElement(cE.Y,{direction:"horizontal",spacing:0},o.createElement(tx.B,{className:db,svg:dT.A}),o.createElement(cE.Y,{direction:"horizontal",spacing:0},(0,n3.hS)(E)&&g),o.createElement(tx.B,{className:"prototype_conditional_controls--icon--JV1i0",svg:dN.default}))),!y&&u.length>0&&h)),!p.ifStatement&&v,u&&u.map((a,r)=>o.createElement(ps,{key:r,updateMultipleDestinationNodes:t.appendActionIndex(r),action:a,recordingKey:ar.Pt(p.recordingKey,"conditional-action-row",r),updateSelectionProperties:n.appendActionIndex(r),onDeleteAction:()=>e(r),interactionType:p.interactionType,actionIndexPath:[p.actionIndexPath[0],p.actionIndexPath[1],r],numActions:u.length,isNestedInConditional:!0,stateManagementVersion:p.stateManagementVersion,selectedInteractions:p.selectedInteractions,onDrop:p.onDrop,onSelect:p.onSelect,onExpand:p.onExpand,onAddAction:l,selectedActionIndex:p.selectedActionIndex,expandedRows:p.expandedRows,autoOpenVariablePicker:s})),0===u.length&&o.createElement(ps,{key:0,updateMultipleDestinationNodes:t.appendActionIndex(0),action:p.emptyAction,recordingKey:ar.Pt(p.recordingKey,"conditional-action-row",0),updateSelectionProperties:n.appendActionIndex(0),onDeleteAction:()=>e(0),interactionType:p.interactionType,actionIndexPath:[p.actionIndexPath[0],p.actionIndexPath[1],0],numActions:u.length,isNestedInConditional:!0,stateManagementVersion:p.stateManagementVersion,selectedInteractions:p.selectedInteractions,onDrop:p.onDrop,onSelect:p.onSelect,onExpand:p.onExpand,onAddAction:l,selectedActionIndex:p.selectedActionIndex,expandedRows:p.expandedRows,autoOpenVariablePicker:s}))}function dP(e,t,n){return function(a){var o=[...t];o.length>e?o[e].condition=a:o.push({condition:0===e?a:void 0,actions:[]},{condition:1===e?a:void 0,actions:[]}),n({conditionalActions:o})}}function dC({onDrop:e,onSelect:t,onExpand:n,action:a,updateMultipleDestinationNodes:l,updateSelectionProperties:i,interactionType:s,recordingKey:c,stateManagementVersion:d,selectedInteractions:p,actionIndexPath:m,selectedActionIndex:u,expandedRows:E,autoOpenVariablePicker:y,onNewActionAdded:_,handleMouseDownUI3:g}){let h=(0,r.wA)(),f=(0,U.p8)("currentPage"),v=(0,l0.YT)()===l0.Oz.TWO_COL,b=v?u.equals(m):void 0,{shouldShowAdvancedPrototypingPaywall:S,showAdvancedPrototypingConditionalActionsModal:N}=(0,l0.zt)(),I=(0,n3.hS)(a.conditionalActions)&&a.conditionalActions?a.conditionalActions:[],P=e=>function(t){var n=[...I];n.length>e?n[e].actions=[...t]:n.push({actions:t}),i({conditionalActions:n})},C=e=>function(t){var n=[...I],a=0;if(n.length>e){var o=n[e].actions;o?o.push(t):o=[t],a=o.length}else n.push({actions:0===e?[t]:[]},{actions:1===e?[t]:[]}),a=1;"SET_VARIABLE"===t.connectionType&&(y.current=!0),i({conditionalActions:n}),_&&_(new dy.Op([m[0],e,a-1])),h((0,lp._P)({name:"Prototype add action",params:{action:t.connectionType?t.connectionType:"NONE",source:"panel",page_id:f,actionInConditionalAction:!0}}))},A=e=>function(t){if(S)N();else{var n=[...I];let a=I[e],o=[];if(a&&a.actions)for(let e=0;e<a.actions.length;e++){let n=a.actions[e];e!==t?o.push(n):h((0,lp._P)({name:"Prototype delete action",params:{action:n.connectionType?n.connectionType:"NONE",source:"panel",page_id:f,actionInConditionalAction:!0}}))}n[e].actions=o,i({conditionalActions:n})}},k=I.length>0?I[0]:void 0,w=I.length>1?I[1]:void 0;return o.createElement("div",{style:v?{position:"relative"}:void 0},(0,n3.gl)(a.conditionalActions)&&o.createElement(cI.Y1,null,o.createElement(aT.E,{className:"prototype_conditional_controls--mixedConditionalText--6O32b",onClick:()=>{var e=[];e.push({},{}),i({conditionalActions:e})}},(0,T.t)("fullscreen.properties_panel.click_to_replace_mixed_content"))),(0,n3.hS)(a.conditionalActions)&&o.createElement(o.Fragment,null,o.createElement(dI,{key:0,conditionalActions:k,recordingKey:ar.Pt(c,"conditional-block",0),updateCondition:dP(0,I,i),updateActions:P(0),onAddAction:C(0),updateMultipleDestinationNodes:l.appendActionIndex(0),onDeleteAction:A(0),interactionType:s,updateSelectionProperties:i.appendActionIndex(0),ifStatement:!0,stateManagementVersion:d,selectedInteractions:p,actionIndexPath:[m[0],0],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:u,autoOpenVariablePicker:y,expandedRows:E,emptyAction:{ifStatement:!0,action:a},isSelected:b,handleMouseDownUI3:g}),o.createElement(dI,{key:1,conditionalActions:w,recordingKey:ar.Pt(c,"conditional-block",1),updateCondition:dP(1,I,i),updateActions:P(1),onAddAction:C(1),updateMultipleDestinationNodes:l.appendActionIndex(1),onDeleteAction:A(1),interactionType:s,updateSelectionProperties:i.appendActionIndex(1),ifStatement:!1,stateManagementVersion:d,selectedInteractions:p,actionIndexPath:[m[0],1],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:u,autoOpenVariablePicker:y,expandedRows:E,emptyAction:{ifStatement:!1,action:a},isSelected:b,handleMouseDownUI3:g})))}function dA({updateSelectionProperties:e,conditionalActions:t,autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,...r}){let l=t.length>0?t[0]:void 0,s=l?.condition?l?.condition:void 0,c=eA()({"prototype_conditional_controls--standaloneIfConditional--GLFDU":!0,"prototype_conditional_controls--placeholderText--esG0u":!s});return o.createElement(o.Fragment,null,o.createElement(rZ.cS,{input:null,label:(0,T.tx)("proto.condition")}),o.createElement(oF.Ad,{appendedClassName:"prototype_conditional_controls--conditionalActionRightPadding--xpK6Z",label:null,input:(0,n3.hS)(s)?o.createElement("div",{className:c},o.createElement(cp.KN,{resolvedType:i.rXF.BOOLEAN,targetVariableData:s,updateSelectionProperties:e.appendActionIndex(0),recordingKey:r.recordingKey,updateConditionInConditionalAction:dP(0,t,e),autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,showVariableThumbnails:!0,isNarrowPanel:!0})):null}))}var dk=n(510879),dw=n(830002),dO=n(731262);class dx extends rq.c${}class dD extends rq.l6{}class dR extends o.PureComponent{constructor(e){super(e),this.loadDestinationsFromFullscreen=()=>{let e=i.baT.ALL;"SCROLL_TO"===this.props.action?e=i.baT.SCROLL_TO:"SWAP_STATE_TO"===this.props.action&&(e=i.baT.STATES);let{viableIds:t,disabledIds:n}=i.X3B.getTransitionDestinationsOnActiveCanvas(e);return new Promise((e,a)=>{this.setState({viableIds:t,disabledIds:n},e)})},this.onOptionFocus=e=>{ee.Uc(e??"")},this.renderGroupedScrollableNodes=(e,t)=>{let n=cF()(e.filter(e=>this.nodeNameFormatter.hasNameForNode(e)),e=>e===t&&(0,n3.hS)(t)?t9.Ql(this.props.scene,e)?.guid:this.props.scene.get(e)?.parentGuid),a=Object.keys(n);(0,t9.X4)(a,this.nodeNameFormatter.format.bind(this.nodeNameFormatter));let{tlfId:r,index:l}=(0,t9.H_)(this.props.scene,a);return r&&l&&(a.splice(l,1),a=[r,...a]),a.reduce((e,t,a)=>(0!==a&&e.push(o.createElement(rq.sK,{key:a})),e.push(o.createElement(dx,{key:`disabled-${t}`,value:t+" ",recordingKey:ar.Pt(this.props,`disabled-option-${t}`),disabled:!0})),n[t].forEach((t,n)=>{e.push(o.createElement(dx,{key:`enabled-${t+n}`,value:t,recordingKey:ar.Pt(this.props,`viable-option-${n}`),disabled:!1}))}),e),[])},this.state={viableIds:[],disabledIds:[]},this.nodeNameFormatter=new lz.cP(e.scene)}render(){let e=this.props.nodeId===n3.oV?n3.oV:ld.dI(this.props.nodeId),t=this.state.viableIds;(0,n3.hS)(e)&&e!==ld.AD&&-1===t.indexOf(e)&&(t=t.concat([e]));let n=this.state.disabledIds,a=`prototype-destination-select-${this.props.recordingKey}`,r="SCROLL_TO"!==this.props.action?t.filter(e=>this.nodeNameFormatter.hasNameForNode(e)).map((e,t)=>o.createElement(dx,{key:`enabled-${e}`,value:e,recordingKey:ar.Pt(this.props,`viable-option-${t}`),disabled:!1})):this.renderGroupedScrollableNodes(t,e),l=n.filter(e=>this.nodeNameFormatter.hasNameForNode(e)).map((e,t)=>o.createElement(dx,{key:`disabled-${e}`,value:e,recordingKey:ar.Pt(this.props,`disabled-option-${t}`),disabled:!0})),i=this.props.isUI3?o.Fragment:ab.fI;return o.createElement(i,null,o.createElement(dD,{id:a,dataTestId:"destination-select",className:this.props.className,chevronClassName:"prototype_destination_dropdown--chevron--pmWtI",inputClassName:"prototype_destination_dropdown--input--rzglN",dropdownWidth:ax.DxS,property:e,formatter:this.nodeNameFormatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,recordingKey:ar.Pt(this.props,"select"),willShowDropdown:this.loadDestinationsFromFullscreen,onOptionFocus:this.onOptionFocus,hideDropdownWhenContainerMoves:!(0,nR.nl)()},r,0!==n.length&&0!==t.length&&o.createElement(rq.sK,null),l))}}let dM=o.memo(function(e){let t=(0,F.tS)(),n=(0,F._G)(),a=(0,r.d4)(dL),l=(0,r.d4)(lH.qd),s=(0,r.d4)(lH.dK),c=(0,dk.D)(l,s),d=(0,r.d4)(dV),p=o.useMemo(()=>(0,dO.cP)(d,t,n,e.actionIndexPath),[d,t,n,e.actionIndexPath]),m=o.useMemo(()=>(0,dO.cP)(a,t,n),[a,t,n]),u=p||m;if(!u||u.mode!==i.iCO.STATE_OR_STATE_INSTANCE_SUBLAYER)return null;let{allStates:E,stateGroupModel:y,selectedStates:_,selectedStatesPropertyValues:g}=u,h=y.propertySortOrder||[],f=y.propertyValues;return f?o.createElement(dw.lS,{sortedProperties:h,stateGroupPropertyValues:f,selectedStatesPropertyValues:g,selectedStates:_,allStates:E,onSelectProperty:t=>{let n={};for(let e of Object.keys(t)){let a=t[e].symbol.node_id;for(let t of(n[e]=a,c[e]||[]))n[t]=a;for(let e of l)n[e]||(n[e]=a)}e.onChange(n)},recordingKey:e.recordingKey,hideErrorsPanel:!0,shouldIndent:!0,extended:!0}):null});function dL(e){return e.mirror.selectionProperties.stateGroupSelectionInfo}function dV(e){return e.mirror.selectionProperties.prototypeDestinationStateGroupSelectionInfo}var dK=n(169231),dU=n(511787),dF=n(939143),dB=n(720531);let dG="prototype_set_variable_controls--dropdownAndIconContainer--6m3Tw",dz="prototype_set_variable_controls--icon---HzDt",dY="prototype_set_variable_controls--placeholderText--PBIqf";function dW({targetVariableData:e,targetVariable:t,updateSelectionProperties:n,autoOpenVariablePicker:a,...l}){let c=o.useRef(null),d=(0,r.wA)(),p=(0,em.GS)(),m=(0,r.d4)(e=>e.variablePickerShown),u=(0,oz.tZ)((0,n3.hS)(t)&&"id"in t?t.id:void 0),E=(0,oz.u)((0,n3.hS)(t)&&"id"in t?t.id:void 0),[y,_]=o.useState("");(0,ew.h)(()=>{a&&!0===a.current&&(h(),a.current=!1)});let g=(0,oz.BQ)((0,n3.hS)(t)&&"id"in t?t.id:void 0)??(0,cP.m9)((0,n3.hS)(t)&&"nodeFieldAlias"in t?t.nodeFieldAlias:void 0);o.useEffect(()=>{void 0!==e&&g&&"MIXED"!==g&&(0,n3.hS)(e)&&e.resolvedType!==g.resolvedType&&!((0,cP.tz)(e.resolvedType)&&(0,cP.tz)(g.resolvedType))&&n({targetVariableData:void 0})},[g,n,e]);let h=()=>{let e=c.current.getBoundingClientRect();d((0,dK.C)({type:"variable-picker-set-variable-action",isShown:!0,resolvedType:i.rXF.STRING,initialPosition:new tS.Mi(e.left-20,e.top),key:l.recordingKey,onVariableSelected:I}))},f=o.useCallback(()=>{d((0,dK.B)())},[d]),[v,N]=o.useState(!1),I=o.useCallback(t=>{if(void 0!==t&&t.node_id){let a={targetVariable:{id:t.node_id}},o=i.CWU.getVariableResolvedValue(t.node_id,new Map);!e&&t.resolvedType===i.rXF.COLOR&&o&&(a.targetVariableData=o??void 0),n(a),d((0,lp.Zh)({name:"prototype.variable_selected",params:{collectionId:t.variableSetId,variableId:t.node_id,variableType:t.resolvedType}})),N(!0)}},[d,e,n]),P=o.useCallback(e=>{e.value.stablePath.map(e=>ld.sH(e))&&(n({targetVariable:{nodeFieldAlias:{stablePathToNode:e.value.stablePath,nodeField:"COMPONENT_PROP_ASSIGNMENTS",indexOrKey:e.value.explicitDefId}}}),N(!0))},[n]),C=o.useMemo(()=>({type:"LOCAL_VARIABLES",layout:"list"}),[]);o.useEffect(()=>{let e=i.Ez5.prototypingEditorState().colorPickerEyedropperVarData;return(0,er.lu)(e,{onChangeImmediate(){let t=e.getCopy();t&&n({targetVariableData:t})}})},[n]);let A="nodeFieldAlias"in t?(0,cP.aA)(t.nodeFieldAlias.stablePathToNode,t.nodeFieldAlias.indexOrKey):void 0,k=A?(0,cP.Xx)(A.varValue.resolvedType):null,w=null;if((0,n3.gl)(t))w=null;else if(g?.resolvedType===i.rXF.COLOR)w=(0,n3.gl)(e)?o.createElement("div",{className:"prototype_set_variable_controls--targetVariableDataMixedContainer--H6uGu"},(0,T.t)("fullscreen.mixed")):o.createElement(o.Fragment,null,o.createElement(dB.gJ,{variableValue:e??g,onChange:e=>{n({targetVariableData:e})},recordingKey:ar.Pt(l.recordingKey,"variableValueInput"),setVariableAction:!0,innerContainerClassName:"prototype_set_variable_controls--variableColorInputContainer--NaOmp"}));else{let t=l.isNestedInConditional?"prototype_set_variable_controls--absoluteIconInConditional--BbEmW":"prototype_set_variable_controls--absoluteIcon--1XpBF",a=i.rXF.BOOLEAN;E?a=E.resolvedType:A&&(a=A.varValue.resolvedType===i.rXF.TEXT_DATA?i.rXF.STRING:A.varValue.resolvedType),w=o.createElement("div",{className:p?void 0:S.cx.ml12.$},o.createElement("div",{className:dG},o.createElement(cp.KN,{resolvedType:a,targetVariableData:e,autoOpenExpressionBuilder:v,setAutoOpenExpressionBuilder:N,updateSelectionProperties:n,recordingKey:l.recordingKey,isNarrowPanel:l.isNarrowPanel,showVariableThumbnails:!0}),!p&&o.createElement(tx.B,{className:eA()(dz,t),svg:dN.default})))}let O=eA()({"prototype_set_variable_controls--targetVariableDropdown--IZwoF":!p&&!l.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownNarrow--WWi-t prototype_set_variable_controls--targetVariableDropdown--IZwoF":!p&&l.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownUI3--Pz71q":p,[dY]:p&&!(u||A)}),x=(0,r.d4)(lQ.ZM),D=(0,s.kc)().ds_variable_props_unified_ui&&x?(0,T.t)("proto.select_variable_unified"):p?(0,T.t)("proto.select_variable.short"):(0,T.t)("proto.select_variable"),R=o.createElement(lG.D8,{recordingKey:ar.Pt(l.recordingKey,"selectTargetVariable"),onClick:h},o.createElement("div",{className:p?void 0:(0,n3.hS)(t)?"prototype_set_variable_controls--targetVariableLabel--AFCqK":"prototype_set_variable_controls--targetVariableLabelInactive--zHWCC prototype_set_variable_controls--targetVariableLabel--AFCqK",ref:c},o.createElement(cE.Y,null,o.createElement("div",{className:O},o.createElement("div",{className:dG},(0,n3.gl)(t)?o.createElement("div",{className:eA()(S.cx.pt2.$,S.cx.pb2.$)},(0,T.t)("fullscreen.mixed")):u?o.createElement(ck.wG,{text:u,thumbnailValue:g,isDeleted:!!E&&(0,cA.eF)(E)}):A?o.createElement(ck.wG,{text:A.name,thumbnailValue:k,isDeleted:!1,colorTheme:ck.J2.COMPONENT}):o.createElement("div",{className:eA()(S.cx.pt2.$,S.cx.pb2.$,p?"prototype_set_variable_controls--placeholderTextColorUI3--Pc-4N":void 0)},D),!p&&o.createElement(tx.B,{className:dz,svg:dN.default})))))),M=p?o.createElement(rZ.cS,{input:R,label:(0,s.kc)().ds_variable_props_unified_ui?(0,T.tx)("proto.target"):(0,T.tx)("proto.variable")}):R,L=eA()({"prototype_set_variable_controls--setVariableToContainerNarrow--HHbHQ prototype_set_variable_controls--setVariableToContainer--kxsCZ":!p&&l.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainer--kxsCZ":!p&&!l.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainerUI3--pGbDe":p,[dY]:p&&!e&&g?.resolvedType!==i.rXF.COLOR}),V=o.createElement("div",{className:L,"data-testid":"set-variable-container"},w),K=p?null!==w?o.createElement(rZ.cS,{label:(0,T.tx)("proto.variable.value"),input:V}):null:V;return o.createElement("div",{className:p?void 0:S.cx.relative.$},M,m.isShown&&"variable-picker-set-variable-action"===m.type&&m.key===l.recordingKey?o.createElement(o.Fragment,null,o.createElement(rD.vx,{title:"",headerSize:"hidden",initialPosition:m.initialPosition,onClose:f,dragHeaderOnly:!1,initialWidth:216,canRenderBelowViewport:!0},o.createElement(dF.YK,{selectedItem:E,disabledVariableIds:new Set,currentView:C,toggleLayout:b.lQ,pickerType:"set-variable",setControlRightButtons:o.createElement(dU.f,{resolvedTypes:[i.rXF.BOOLEAN,i.rXF.STRING,i.rXF.FLOAT,i.rXF.COLOR]}),onVariableSelected:I,onClose:f,recordingKey:ar.Pt(l.recordingKey,"variablePickerForSelection"),searchQuery:y,onSearchInputChange:_,onComponentPropSelected:(0,s.kc)().ds_variable_props_proto?P:void 0})),o.createElement(dF.$3,{onClose:f})):null,K)}var dH=n(896474),d$=n(394781);let dX=(0,io.ex)("prototype_state_management_info",function(){let e=o.createElement(u.N,{newTab:!0,href:"https://help.figma.com/hc/articles/14397859494295",htmlAttributes:{rel:"noopener noreferrer",onMouseDown:e=>{e.stopPropagation(),e.preventDefault()}}},(0,T.tx)("proto.state_management.info_tooltip_learn_more")),t=o.createElement("span",null,o.createElement("strong",null,(0,T.tx)("proto.animation_panel.preserve_scroll_position")));return o.createElement("div",{className:"prototype_state_management_info_tooltip--stateManagementMoreInfo---gER1 tooltip--text--Ll1mS"},(0,T.tx)("proto.state_management.info_tooltip",{PreserveScrollPositionBold:t,LearnMoreLink:e}))}),dQ="prototype_state_management_panel--checkboxRow--2u02e checkbox--_checkboxRow--oEhow",dJ="prototype_state_management_panel--expandCaret--uuDge";function dj({transition:e,navigationType:t,recordingKey:n,showPreserveScrollPosition:a,showResetVideoState:l,showResetInteractiveComponentState:i,updateSelectionProperties:s,stateManagementVersion:c,selectedInteractions:d}){let p=(0,r.wA)(),m=(0,em.GS)(),[u,E]=o.useState(!m),y=o.useContext(cC.c);if((0,l0.YT)()===l0.Oz.TWO_COL&&y===cC.P.LEFT)return null;let _=(0,l0.LH)(c),g=o.createElement(r$.S,{onChange:t=>{p((0,lp._P)({name:"Preserve Scroll Changed",params:{newValue:t}})),s({...function(e){if((0,n3.hS)(e.preserveScroll))return{transitionPreserveScroll:e.preserveScroll}}({...e,preserveScroll:t})})},checked:!0===e.preserveScroll,mixed:(0,n3.gl)(e.preserveScroll),recordingKey:ar.Pt(n,"preserve-scroll-check"),label:o.createElement(tI.J,null,(0,T.tx)("proto.animation_panel.preserve_scroll_position"))}),h=m?o.createElement(rZ.TN,null,g):o.createElement(ab.fI,{className:dQ},g),f=o.createElement(r$.S,{onChange:t=>{p((0,lp._P)({name:"Reset Scroll Position Changed",params:{newValue:t,noodleUpgradedThisSession:d$.zZ.haveAnyInteractionsBeenUpgraded(d)}})),s({...function(e){if((0,n3.hS)(e.resetScrollPosition))return{transitionResetScrollPosition:e.resetScrollPosition}}({...e,resetScrollPosition:t})})},checked:!0===e.resetScrollPosition,mixed:(0,n3.gl)(e.resetScrollPosition),recordingKey:ar.Pt(n,"reset-scroll-position-check"),label:o.createElement(tI.J,null,(0,T.tx)("proto.animation_panel.reset_scroll_position"))}),v=o.createElement("div",{"data-tooltip-type":ak.Ib.SPECIAL,"data-tooltip":dX,"data-tooltip-interactive":!0,"data-tooltip-show-immediately":!0,"data-tooltip-max-width":240,className:m?"prototype_state_management_panel--stateManagementPanelTooltipUI3--x5MQ3":void 0},o.createElement(dH.In,{icon:"info-16"})),b=m?o.createElement(rZ.TN,null,f," ",v):o.createElement(ab.fI,{className:dQ},f),S=o.createElement(r$.S,{onChange:t=>{p((0,lp._P)({name:"Reset Component State Changed",params:{newValue:t,noodleUpgradedThisSession:d$.zZ.haveAnyInteractionsBeenUpgraded(d)}})),s({...function(e){if((0,n3.hS)(e.resetInteractiveComponents))return{transitionResetInteractiveComponents:e.resetInteractiveComponents}}({...e,resetInteractiveComponents:t})})},checked:!0===e.resetInteractiveComponents,mixed:(0,n3.gl)(e.resetInteractiveComponents),recordingKey:ar.Pt(n,"reset-component-state-check"),label:o.createElement(tI.J,null,(0,T.tx)("proto.animation_panel.reset_component_state"))}),N=m?o.createElement(rZ.TN,null,S):o.createElement(ab.fI,{className:dQ},S),I=o.createElement(r$.S,{onChange:t=>{p((0,lp._P)({name:"Reset Video Position Changed",params:{newValue:t}})),s({...function(e){if((0,n3.hS)(e.resetVideoPosition))return{transitionResetVideoPosition:e.resetVideoPosition}}({...e,resetVideoPosition:t})})},checked:!0===e.resetVideoPosition,mixed:(0,n3.gl)(e.resetVideoPosition),recordingKey:ar.Pt(n,"reset-video-position-check"),label:o.createElement(tI.J,null,(0,l0.LH)(c)?(0,T.tx)("proto.state_management.reset_video_state"):(0,T.tx)("proto.animation_panel.reset_video_state"))}),P=m?o.createElement(rZ.TN,null,I):o.createElement(ab.fI,{className:dQ},I),C=o.createElement(ab.Zk,{className:`prototype_state_management_panel--stateManagementPanel--sYaaj ${(0,l0.kM)(c)&&"prototype_state_management_panel--stateManagementPanelWithVersion--AovOP"}`},!m&&o.createElement(ab.fI,null,o.createElement(ab.xw,{className:"prototype_state_management_panel--panelTitle--Nr4Eh",faded:!0},(0,T.tx)("proto.state_management")),!(0,l0.kM)(c)&&v),(0,l0.uU)(c)&&a&&h,l&&(0,l0.uU)(c)&&P,_&&b,_&&i&&N,_&&l&&P,(0,n3.gl)(c)&&o.createElement(cE.Y,{direction:"horizontal",padding:{horizontal:12,vertical:12}},o.createElement(ab.UZ,null,(0,T.tx)("proto.state_management.mixed_state_update")))),A=o.createElement(aA.U,{svg:u?aK.A:aU.A},u?o.createElement(aI.O,{className:dJ}):o.createElement(aN.k,{className:dJ})),k=o.createElement(aT.E,{key:"expand-caret",recordingKey:ar.Pt(n,"expand-caret"),onClick:()=>{E(!u)},actionOnPointerDown:!0,className:"prototype_state_management_panel--expandRow--RVDCp"},A,o.createElement("span",null,(0,T.tx)("proto.state")));return o.createElement(as.k,{name:"prototype_state_management_panel"},m&&k,(u||!m)&&C)}class dq extends rq.c${}class dZ extends rq.l6{}let d0=ld.AD;class d1 extends lz.cP{format(e){return e===d0||null===e?(0,T.t)("proto.target_video_node_name_formatter.this_video"):super.format(e)}}function d2(e){let{viableSameFrameVideoIds:t,disabledSameFrameVideoIds:n,scene:a,dropdownShown:l,targetVideoNodeID:i,isVideoSelected:s,onChange:c}=e,d=(0,r.wA)(),[p,m]=o.useState(()=>s?new d1(a):new lz.cP(a));t.sort((e,t)=>{let n=p.format(e),a=p.format(t);return n.localeCompare(a)}),s&&t.unshift(d0);let u=t.length>0&&n.length>0,E=`prototype-target-video-select-${e.recordingKey}`,y=(0,em.GS)(),_=o.createElement(dZ,{id:E,dataTestId:"target-video-select",className:"prototype_target_video_dropdown--targetVideoDropdown--6hKF-",chevronClassName:"prototype_target_video_dropdown--chevron--jgz53",inputClassName:"prototype_target_video_dropdown--input--infAK",property:(0,n3.gl)(i)?i:ld.dI(i),formatter:p,onChange:c,dispatch:d,dropdownShown:l,recordingKey:ar.Pt(e,"select"),onOptionFocus:e=>{ee.Uc(e??"")},dropdownAlignment:"left"},t.filter(e=>p.hasNameForNode(e)).map((t,n)=>o.createElement(dq,{key:`enabled-${n}`,value:t,recordingKey:ar.Pt(e,`viable-option-${n}`),disabled:!1})),u&&o.createElement(rq.sK,null),n.filter(e=>p.hasNameForNode(e)).map((t,n)=>o.createElement(dq,{key:`disabled-${n}`,value:t,recordingKey:ar.Pt(e,`viable-option-${n}`),disabled:!0})));return y?o.createElement(rZ.cS,{input:_,label:(0,T.tx)("proto.video_dropdown.label")}):_}var d4=n(946689);function d8({action:e,recordingKey:t,onURLChange:n,onOpenInNewTabChange:a}){let r=(0,em.GS)(),l=o.createElement(d4.ks,{className:r?"prototype_open_url_action_options--urlInputUI3--H-JfT":"prototype_open_url_action_options--urlInput--T-tGT",dataTestId:"url-input",placeholder:(0,T.t)("proto.interaction.example_com"),value:(0,n3.gl)(e.connectionURL)?(0,T.t)("fullscreen.mixed"):(0,n3._W)(e.connectionURL,""),onChange:n,recordingKey:ar.Pt(t,"urlTextInput"),autoFocus:!1}),i=o.createElement(r$.S,{label:o.createElement(tI.J,null,(0,T.tx)("proto.action_open_url_in_new_tab")),onChange:a,recordingKey:ar.Pt(t,"open-url-in-new-tab-check"),checked:void 0===e.openUrlInNewTab||!0===e.openUrlInNewTab});return o.createElement(o.Fragment,null,r?o.createElement(rZ.cS,{label:(0,T.tx)("proto.open_url.text_input_label"),input:l}):l,r?o.createElement(rZ.TN,null,i):o.createElement(ab.fI,{className:"prototype_open_url_action_options--checkboxRow--mu17T checkbox--_checkboxRow--oEhow"},i))}var d3=n(588599);function d5({updateSelectionProperties:e,action:t,extraScrollOffset:n,showScrollToOptions:a,recordingKey:l}){let{smallNudgeAmount:i,bigNudgeAmount:s}=(0,nU.sT)(),c=(0,r.wA)(),d=(0,em.GS)(),p=(t,n)=>(a,o)=>{t&&e({extraScrollOffset:{...t,[n]:a}},{shouldCommit:o})},m=(0,n3._W)(n,{x:0,y:0});if(!a||"SCROLL_TO"!==t)return null;let u=o.createElement(rm.gq,{className:d?void 0:cw.U,inputClassName:d?cw.oM:cw.hF,value:m.y,wheelMultiplier:i,scrubMultiplier:i,smallNudgeAmount:i,bigNudgeAmount:s,onValueChange:p(m,"y"),dispatch:c,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("proto.trigger.y_offset"),tooltipForScreenReadersOnly:!1,recordingKey:ar.Pt(l,"extraScrollOffsetY")},d?o.createElement("span",{className:cw.QK},(0,T.tx)("proto.scroll_options.scroll_offset.y")):o.createElement(tx.B,{className:cw.QK,svg:d3.A})),E=o.createElement(rm.gq,{className:d?void 0:cw.sC,inputClassName:d?cw.oM:cw.hF,value:m.x,wheelMultiplier:i,scrubMultiplier:i,smallNudgeAmount:i,bigNudgeAmount:s,onValueChange:p(m,"x"),dispatch:c,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("proto.trigger.x_offset"),tooltipForScreenReadersOnly:!1,recordingKey:ar.Pt(l,"extraScrollOffsetX")},d?o.createElement("span",{className:cw.QK},(0,T.tx)("proto.scroll_options.scroll_offset.x")):o.createElement(tx.B,{className:cw.Kh,svg:d3.A}));return d?o.createElement(rZ.Cm,{label:(0,T.tx)("proto.scroll_options.offset"),leftInput:E,rightInput:u}):o.createElement(ab.fI,null,u,E)}let d7=(0,o.memo)(function(e){return(0,tC.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,tC.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M18 12a6 6 0 1 1-12 0 6 6 0 0 1 12 0m1 0a7 7 0 1 1-14 0 7 7 0 0 1 14 0m-6.5-3.5a.5.5 0 0 0-1 0V12a.5.5 0 0 0 .146.354l2 2a.5.5 0 0 0 .708-.708L12.5 11.793z",clipRule:"evenodd"})})}),d6="prototype_video_action_options--chevron--mkNyv",d9="prototype_video_action_options--input--3-cEi",pe=new lz.js,pt=new lz.Z6;function pn({action:e,onChange:t,updateSelectionProperties:n,dropdownShown:a,recordingKey:l}){let i=(0,em.GS)(),s=(0,lz.Od)(e),c=(0,n3.E7)(e.mediaAction),d="UPDATE_MEDIA_RUNTIME"===(0,n3.E7)(e.connectionType),p="SKIP_TO"===c,m="SKIP_FORWARD"===c||"SKIP_BACKWARD"===c,u="PLAY"===c||"PAUSE"===c||"TOGGLE_PLAY_PAUSE"===c,E="MUTE"===c||"UNMUTE"===c||"TOGGLE_MUTE_UNMUTE"===c,y=(0,r.wA)(),_=(0,nU.RU)(),g=o.useCallback(e=>{n({mediaSkipToTime:e}),y((0,lp._P)({name:"Media skip to time changed",params:{value:e}}))},[y,n]),h=`prototype-media-action-select-${l}`,f="prototype_video_action_options--shortDropdown--NOXXv",v=a&&a.type===h?pe:pt,b=o.createElement(cb,{id:h,dataTestId:"media-play-pause-select",className:f,chevronClassName:d6,inputClassName:d9,property:s,formatter:v,onChange:t,dispatch:y,dropdownShown:a,recordingKey:ar.Pt(l,"select")},o.createElement(cv,{key:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",value:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",recordingKey:ar.Pt(l,"toggle-play-pause-option"),disabled:!1}),o.createElement(cv,{key:"UPDATE_MEDIA_PLAY",value:"UPDATE_MEDIA_PLAY",recordingKey:ar.Pt(l,"play-option"),disabled:!1}),o.createElement(cv,{key:"UPDATE_MEDIA_PAUSE",value:"UPDATE_MEDIA_PAUSE",recordingKey:ar.Pt(l,"pause-option"),disabled:!1})),S=o.createElement(cb,{id:h,dataTestId:"media-mute-unmute-select",className:f,chevronClassName:d6,inputClassName:d9,property:s,formatter:v,onChange:t,dispatch:y,dropdownShown:a,recordingKey:ar.Pt(l,"select")},o.createElement(cv,{key:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",value:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",recordingKey:ar.Pt(l,"toggle-mute-unmute-option"),disabled:!1}),o.createElement(cv,{key:"UPDATE_MEDIA_MUTE",value:"UPDATE_MEDIA_MUTE",recordingKey:ar.Pt(l,"mute-option"),disabled:!1}),o.createElement(cv,{key:"UPDATE_MEDIA_UNMUTE",value:"UPDATE_MEDIA_UNMUTE",recordingKey:ar.Pt(l,"unmute-option"),disabled:!1})),N=o.createElement(cb,{id:h,dataTestId:"media-skip-by-select",className:f,chevronClassName:d6,inputClassName:d9,property:s,formatter:v,onChange:t,dispatch:y,dropdownShown:a,recordingKey:ar.Pt(l,"select"),dropdownWidth:160},o.createElement(cv,{key:"UPDATE_MEDIA_SKIP_FORWARD",value:"UPDATE_MEDIA_SKIP_FORWARD",recordingKey:ar.Pt(l,"skip-forward-option"),disabled:!1}),o.createElement(cv,{key:"UPDATE_MEDIA_SKIP_BACKWARD",value:"UPDATE_MEDIA_SKIP_BACKWARD",recordingKey:ar.Pt(l,"skip-backward-option"),disabled:!1})),I=o.createElement(rm.qd,{className:"prototype_video_action_options--timestampContainer---DdaI",inputClassName:"prototype_video_action_options--timestamp--luOrs",dataTestId:"mediaSkipToTime-input",dispatch:y,value:e.mediaSkipToTime||0,onValueChange:g,wheelMultiplier:_/1e3,scrubMultiplier:_/1e3,max:3600,displayFractions:!0,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("proto.trigger.timestamp_to_set_to"),tooltipForScreenReadersOnly:!0,recordingKey:ar.Pt(l,"mediaSkipToTimeInput")},i?o.createElement(d7,null):void 0),P="SKIP_BACKWARD"===c?(0,T.t)("proto.trigger.duration_to_jump_backward"):(0,T.t)("proto.trigger.duration_to_jump_forward"),C=o.createElement(rm.dE,{className:"prototype_video_action_options--timeAmountContainer--5kpHn",dataTestId:"mediaSkipByAmount-input",dispatch:y,value:e.mediaSkipByAmount||5,onValueChange:e=>{n({mediaSkipByAmount:e}),y((0,lp._P)({name:"Media skip by amount changed",params:{value:e}}))},wheelMultiplier:_/1e3,scrubMultiplier:_/1e3,max:3600,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":P,tooltipForScreenReadersOnly:!0,recordingKey:ar.Pt(l,"mediaSkipByAmountInput")});if(!d)return null;if(i){if(u)return o.createElement(rZ.cS,{input:b,label:(0,T.tx)("proto.video_options.behavior")});if(E)return o.createElement(rZ.cS,{input:S,label:(0,T.tx)("proto.video_options.behavior")});if(m)return o.createElement(o.Fragment,null,o.createElement(rZ.cS,{input:N,label:(0,T.tx)("proto.video_options.direction")}),o.createElement(rZ.cS,{input:C,label:(0,T.tx)("proto.video_options.offset")}));if(p)return o.createElement(rZ.cS,{input:I,label:(0,T.tx)("proto.video_options.timestamp")})}return o.createElement(ab.fI,null,u&&b,E&&S,m&&N,m&&C,p&&I)}function pa({action:e,recordingKey:t,interactionType:n,onActionChange:a,updateMultipleDestinationNodes:l,updateSelectionProperties:s,stateManagementVersion:c,autoOpenVariablePicker:d,autoOpenExpressionBuilder:p,setAutoOpenExpressionBuilder:m,...u}){let E=(0,r.wA)(),y=(0,a0.Um)(),{scene:_,selectionProperties:g}=(0,iH.R)(e=>({scene:e.mirror.sceneGraph,selectionProperties:e.mirror.selectionProperties})),h=(0,em.GS)(),f=(0,l0.YT)(),v=f===l0.Oz.SINGLE_COL,b=f===l0.Oz.TWO_COL,N=o.useContext(cC.c),I=b&&N===cC.P.RIGHT,P="SET_VARIABLE"===(0,n3.E7)(e.connectionType),C="SET_VARIABLE_MODE"===(0,n3.E7)(e.connectionType),A="CONDITIONAL"===(0,n3.E7)(e.connectionType),k="INTERNAL_NODE"===(0,n3.E7)(e.connectionType),w="INTERNAL_NODE"===(0,n3.E7)(e.connectionType)&&"SWAP_STATE"===(0,n3.E7)(e.navigationType),O="URL"===(0,n3.E7)(e.connectionType),x=k||"BACK"===(0,n3.E7)(e.connectionType)||"CLOSE"===(0,n3.E7)(e.connectionType),D="UPDATE_MEDIA_RUNTIME"===(0,n3.E7)(e.connectionType),R=(0,lY.dq)(g),M=(0,rO.uQ)(),L=[],V=[];if(M){let{viableIds:e,disabledIds:t}=i.X3B.getVideoNodesOnSameTlfAsNode(M);L=e,V=t}let K=ld.dI((0,n3.E7)(e.transitionNodeID)),U=null!=K&&K!==ld.AD,F=k&&(!(0,n3.hS)(e.transitionNodeID)||U),B=(0,n3.E7)(e.navigationType),G=k&&"OVERLAY"===(0,n3.E7)(B),z=(0,l0.hU)(e.transitionType,e.easingType,e.easingFunction,e.transitionDuration,e.transitionShouldSmartAnimate,e.transitionPreserveScroll,e.transitionResetVideoPosition,e.openUrlInNewTab,e.transitionResetScrollPosition,e.transitionResetInteractiveComponents),Y=x&&!G&&("INSTANT"===z.behavior||"DISSOLVE"===z.behavior),W=k&&"OVERLAY"===(0,n3.E7)(e.navigationType)&&U,H=k&&(G||"SWAP"===(0,n3.E7)(B)),$=!D&&(0,l0.oc)(e),X=(0,l0.GB)(e),Q=(0,l0.uU)(c)?Y||$:(0,l0.Fp)(c,e.connectionType,e.navigationType),{selectedInteractions:J}=(0,l2.Ay)(lX.J.NORMAL),j=J.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>lB.d({nodeID:e.sourceNodeID,interactionID:e.id})),q=o.useCallback(e=>{let t=ld.sH(e);t&&s({transitionNodeID:t}),E((0,lp._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(j),destinationTlfId:e}}))},[E,s,j]),Z=o.useCallback(e=>{l(e),E((0,lp._P)({name:"Variant based prototyping UI changed",params:{source:"panel"}})),E((0,lp._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(j)}}))},[l,E,j]),ee=o.useCallback(e=>{s({connectionURL:e.target.value})},[s]),et=(0,lz.Od)(e),en=eA()({[cw.Ph]:!h,[cw.Ti]:u.isNestedInConditional&&!v&&!I}),ea=k&&!w,eo=o.createElement(dR,{className:cw.iR,dispatch:E,dropdownShown:y,onChange:q,nodeId:e.transitionNodeID||ld.Hr,scene:_,recordingKey:ar.Pt(t,"destinationDropdown"),action:et,isUI3:h}),er=o.createElement(d5,{action:et,showScrollToOptions:"SCROLL_TO"===et,extraScrollOffset:e.extraScrollOffset,updateSelectionProperties:s,recordingKey:ar.Pt(t,"scrollOptionsPanel")}),el=o.createElement(dl,{interactionType:n,updateSelectionProperties:s,recordingKey:ar.Pt(t,"overlaySettings"),actionIndexPath:u.actionIndexPath,nodeId:e.transitionNodeID||ld.Hr});return o.createElement("div",{className:en},ea&&(h?o.createElement(o.Fragment,null,o.createElement(rZ.cS,{label:H?(0,T.tx)("proto.overlay"):(0,T.tx)("proto.destination"),input:eo}),er,W&&el):eo),O&&o.createElement(d8,{action:e,recordingKey:t,onOpenInNewTabChange:e=>{s({openUrlInNewTab:e}),E((0,lp._P)({name:"Open Url In New Tab Changed",params:{value:e}}))},onURLChange:ee}),D&&o.createElement(d2,{dropdownShown:y,scene:_,targetVideoNodeID:e.transitionNodeID||ld.Hr,recordingKey:ar.Pt(t,"targetVideoDropdown"),viableSameFrameVideoIds:L,disabledSameFrameVideoIds:V,isVideoSelected:R,onChange:q}),o.createElement(pn,{dropdownShown:y,action:e,onChange:a,updateSelectionProperties:s,recordingKey:t}),!h&&er,P&&o.createElement("div",{className:h?void 0:S.cx.ml4.$},o.createElement(dW,{className:cw.PB,dispatch:E,onChange:q,nodeId:e.transitionNodeID||ld.Hr,targetVariable:e.targetVariable||{id:""},targetVariableData:e.targetVariableData,updateSelectionProperties:s,recordingKey:ar.Pt(t,"setVariableControls"),action:et,isNestedInConditional:u.isNestedInConditional,isNarrowPanel:u.isNestedInConditional||u.isNarrowPanel,autoOpenVariablePicker:d})),C&&o.createElement("div",{className:h?void 0:S.cx.ml4.$},o.createElement(c4,{dispatch:E,targetVariableSetID:e.targetVariableSetID,targetVariableModeID:e.targetVariableModeID,deprecatedTargetVariableSetKey:e.targetVariableSetKey,updateSelectionProperties:s,recordingKey:ar.Pt(t,"setVariableControls"),actionIndexPath:u.actionIndexPath.join(",")})),A&&(I?o.createElement(dA,{recordingKey:ar.Pt(t,"conditionalActionSection","conditional-block",0),autoOpenExpressionBuilder:p,setAutoOpenExpressionBuilder:m,updateSelectionProperties:s,conditionalActions:(0,n3.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]}):o.createElement(dC,{updateSelectionProperties:s,recordingKey:ar.Pt(t,"conditionalActionSection"),action:e,updateMultipleDestinationNodes:l,interactionType:n,stateManagementVersion:c,selectedInteractions:u.selectedInteractions,actionIndexPath:u.actionIndexPath,onDrop:u.onDrop,onSelect:u.onSelect,onExpand:u.onExpand,onNewActionAdded:u.onNewActionAdded,selectedActionIndex:u.selectedActionIndex,expandedRows:u.expandedRows,autoOpenVariablePicker:d,handleMouseDownUI3:u.handleMouseDownUI3})),w&&o.createElement("div",{className:S.cx.ml0.$},o.createElement(dM,{onChange:Z,nodeId:e.transitionNodeID||ld.Hr,recordingKey:ar.Pt(t,"consumption"),actionIndexPath:u.actionIndexPath})),F&&o.createElement(o.Fragment,null,h&&o.createElement("div",{className:cw.x}),o.createElement(dE.X7,{transition:z,interactionType:n,navigationType:e.navigationType,recordingKey:ar.Pt(t,"animationPanel"),updateSelectionProperties:s,isNarrowPanel:u.isNestedInConditional||u.isNarrowPanel,stateManagementVersion:c})),W&&!h&&el,Q&&o.createElement(o.Fragment,null,h&&o.createElement("div",{className:cw.x}),o.createElement(dj,{connectionType:e.connectionType,transition:z,navigationType:e.navigationType,recordingKey:ar.Pt(t,"stateManagementPanel"),updateSelectionProperties:s,showPreserveScrollPosition:Y,showResetVideoState:!!$,showResetInteractiveComponentState:!!X,stateManagementVersion:c,selectedInteractions:u.selectedInteractions})))}var po=n(584999),pr=n(323110),pl=n(482725);let pi=Symbol("ACTION_ROW");function ps({updateMultipleDestinationNodes:e,updateSelectionProperties:t,onDeleteAction:n,stateManagementVersion:a,selectedInteractions:l,autoOpenVariablePicker:i,autoOpenExpressionBuilder:s,setAutoOpenExpressionBuilder:c,...d}){let p=(0,r.wA)(),{shouldShowAdvancedPrototypingPaywall:m,showAdvancedPrototypingVariablesModal:u,showAdvancedPrototypingConditionalActionsModal:E}=(0,l0.zt)(),y=(0,a0.Um)(),_=(0,l0.hP)(),{firstVariableSetMode:g,firstVariableSetID:h}=c2(),v=d.action,b=d.isNestedInConditional&&(0,dy.qQ)(d.action),S=!!v.connectionType&&"CONDITIONAL"===v.connectionType,N=(0,em.GS)(),I=(0,l0.YT)(),P=I===l0.Oz.SINGLE_COL,C=I===l0.Oz.TWO_COL,A=o.useContext(cC.c),k=C&&A===cC.P.RIGHT,w=C&&A===cC.P.LEFT,O=!((0,n3.gl)(d.action)||["CLOSE","NONE"].includes(v.connectionType))&&!N;var x=d.selectedActionIndex.equals(d.actionIndexPath);let D=1===d.selectedActionIndex.path.length&&d.isNestedInConditional&&d.actionIndexPath[0]===d.selectedActionIndex.path[0];var R=void 0===d.expandedRows||void 0!==d.expandedRows.find(e=>e.equals(d.actionIndexPath));N&&(R=!!P||!w||S);let M=o.useCallback(()=>{(O||P)&&d.onExpand(d.actionIndexPath)},[O,P,d]),[L,V]=o.useState(!1);o.useEffect(()=>{if(S){let e=setTimeout(()=>{V(!0)},0);return()=>clearTimeout(e)}V(!0)},[S]);let K=S&&!R,U=S&&R,F=o.useRef(null),[B,G]=(0,f.fp)(l0.hV),{position:z,dragItem:Y}=(0,cu.h4)(()=>({type:pi,element:F,item:d.action,dropPositionThreshold:U?.2:K?1/3:.5,getDeepestTargetOnly:!0,canDrag:!!w||!R,onDrop(e){d.onDrop(e),G(!0)}})),W=o.useMemo(()=>{let e=F.current;if(!e||!z||k)return;if(Y&&"CONDITIONAL"===Y.connectionType&&d.isNestedInConditional||(0,dy.qQ)(Y)){G(!1);return}let t=b?cu.Nz.BEFORE:z;var n=void 0;let a=e.offsetParent?.firstElementChild?.scrollTop??0;return t===cu.Nz.BEFORE?n=e.offsetTop-a:t===cu.Nz.AFTER&&(n=e.offsetTop+e.offsetHeight-a),G(!0),n},[z,k,Y,d.isNestedInConditional,b,G]),H=z&&S&&!R&&z===cu.Nz.INSIDE&&"CONDITIONAL"!==Y.connectionType,$=ar.rf(d.recordingKey,"mousedown",e=>{R||(x=!0,d.onSelect(d.actionIndexPath,!0))}),X=ar.rf(d.recordingKey,"mousedown",e=>{x=!1,d.onSelect(d.actionIndexPath,!1)}),Q=ar.rf(d.recordingKey,"click",e=>{d.onSelect(d.actionIndexPath,!0)}),J=ar.rf(d.recordingKey,"mousedown",e=>{(0,dy.qQ)(d.action)||d.onSelect(d.actionIndexPath,!0)}),j=e=>{var n=!0,a=!1;switch(e){case"NONE":t({connectionType:"NONE"});break;case"NAVIGATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"NAVIGATE"});break;case"OPEN_OVERLAY":t({connectionType:"INTERNAL_NODE",navigationType:"OVERLAY"});break;case"SCROLL_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SCROLL_TO"});break;case"SWAP_WITH":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP"});break;case"SWAP_STATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP_STATE"});break;case"GO_BACK":t({connectionType:"BACK"});break;case"CLOSE_OVERLAY":t({connectionType:"CLOSE"});break;case"OPEN_URL":t({connectionType:"URL"});break;case"SET_VARIABLE":m?(n=!1,u()):(t({connectionType:"SET_VARIABLE"}),i.current=!0);break;case"SET_VARIABLE_MODE":m?(n=!1,u()):t({connectionType:"SET_VARIABLE_MODE",targetVariableSetID:h,targetVariableModeID:g});break;case"UPDATE_MEDIA_PLAY":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PLAY"});break;case"UPDATE_MEDIA_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PAUSE"});break;case"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_PLAY_PAUSE"});break;case"UPDATE_MEDIA_MUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"MUTE"});break;case"UPDATE_MEDIA_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"UNMUTE"});break;case"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_MUTE_UNMUTE"});break;case"UPDATE_MEDIA_SKIP_BY_OPTIONS":case"UPDATE_MEDIA_SKIP_FORWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_FORWARD"});break;case"UPDATE_MEDIA_SKIP_BACKWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_BACKWARD"});break;case"UPDATE_MEDIA_SKIP_TO":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_TO"});break;case"CONDITIONAL":a=!0,m?(n=!1,E()):(t({connectionType:"CONDITIONAL"}),N&&c&&c(!0))}if(N||R||M(),C&&d.onExpand(d.actionIndexPath,a),n){let t=l.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>lB.d({nodeID:e.sourceNodeID,interactionID:e.id}));p((0,lp._P)({name:"Prototype action changed",params:{action:e,source:"panel",connectorIds:JSON.stringify(t)}}))}},q=d.isNestedInConditional?cw.It:cw.ft,Z=eA()({[cw.wu]:!w,[cw.zX]:w&&B}),ee=o.createElement(aA.U,{svg:pr.A},o.createElement(cg,{className:cw._2}));if(b&&d.onAddAction)return o.createElement("div",{className:w?cw.LW:void 0},W&&o.createElement("hr",{className:q,style:{transform:`translateY(${W}px)`}}),w&&d.isNestedInConditional&&ee,o.createElement("div",{className:Z,ref:F},o.createElement(df,{addButtonPressed:d.onAddAction,recordingKey:ar.Pt(d.recordingKey,"addAction"),isNestedInConditional:!0})));let et=(0,lz._X)(v),en="NONE"!==et,ea=(R||!en)&&!w,eo=d.numActions>1,er=(d.numActions>1||d.isNestedInConditional)&&!w,el=eA()({[cw.$l]:!0,[cw.KY]:w&&!d.isNestedInConditional,[cw.Iw]:w&&!d.isNestedInConditional&&B,[cw.DM]:w&&d.isNestedInConditional,[cw.vs]:w&&d.isNestedInConditional&&B,[cw.M9]:w&&d.isNestedInConditional&&D&&B,[cw.I_]:w&&S&&!x&&B,[cw.Cu]:x&&!N,[cw.PE]:x&&w&&!d.isNestedInConditional,[cw.Ze]:H,[cw.Op]:d.isNestedInConditional&&!N}),ei=eA()({[cw.rn]:!0,[cw.Gu]:w,[cw.Ti]:d.isNestedInConditional&&!N&&!k,[cw.Yo]:d.isNestedInConditional&&N&&!k}),es=o.createElement(tx.B,{key:"expand-caret",className:cw.GE,svg:R?aK.A:aU.A,recordingKey:ar.Pt(d.recordingKey,"expandCaret"),onClick:M}),ec=o.createElement(cM,{action:v,isNestedInConditional:d.isNestedInConditional,isNarrowPanel:d.isNarrowPanel&&eo,onClick:N?Q:void 0}),ed=o.createElement(cT,{className:"NONE"===et||N?void 0:po.fH,dispatch:p,dropdownShown:y,onChange:j,action:et,recordingKey:ar.Pt(d.recordingKey,"actionDropdown"),showVideoActions:_,isNestedInConditional:d.isNestedInConditional}),ep=o.createElement(ab.K0,{className:N?cw.gG:cw.hH,onClick:n,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("proto.prototype_panel.delete"),"aria-label":(0,T.t)("proto.prototype_panel.delete"),recordingKey:ar.Pt(d.recordingKey,"actionDeleteButton")},o.createElement(aA.U,{svg:pl.A},o.createElement(lU.O,null))),eu=o.createElement(ab.fI,{className:ei,onDoubleClick:M},O&&es,ea?o.createElement("span",{className:cw.P2},ed):ec,er&&ep),eE=ea?ed:ec,ey=o.createElement(lG.D8,{className:ei,onDoubleClick:M},O&&es,er?o.createElement(oF.DE,{appendedClassName:cw.Jw,label:null,input:eE,icon:ep}):o.createElement(oF.Ad,{appendedClassName:cw.Jw,label:null,input:eE})),e_=(0,T.tx)("proto.action"),eg=o.createElement(lG.D8,{className:ei},P||k?o.createElement(rZ.cS,{label:e_,input:eE}):eE),eh=N?eg:ey,ef=eA()({[cw.Oe]:!0,[cw.h2]:x,[cw.Ob]:S});return o.createElement("div",{className:el,ref:F,role:"button",tabIndex:0,onMouseDown:N?void 0:$,onMouseUp:N?void 0:X},void 0!==W&&o.createElement("hr",{className:q,style:{transform:`translateY(${W}px)`}}),w?o.createElement("div",{className:ef,role:"button",tabIndex:0,onMouseDown:N?J:void 0},d.isNestedInConditional&&ee,eh):N?eh:eu,R&&L&&o.createElement(pa,{updateMultipleDestinationNodes:e,action:v,onActionChange:j,recordingKey:d.recordingKey,updateSelectionProperties:t,interactionType:d.interactionType,stateManagementVersion:a,selectedInteractions:l,isNestedInConditional:d.isNestedInConditional,isNarrowPanel:d.isNarrowPanel,actionIndexPath:d.actionIndexPath,onDrop:d.onDrop,onSelect:d.onSelect,onExpand:d.onExpand,onNewActionAdded:d.onNewActionAdded,selectedActionIndex:d.selectedActionIndex,expandedRows:d.expandedRows,autoOpenVariablePicker:i,autoOpenExpressionBuilder:s,setAutoOpenExpressionBuilder:c,handleMouseDownUI3:J}))}var pc=n(427113),pd=n(682331);function pp({onChange:e,value:t,shouldFocusKeyCaptureField:n,setShouldFocusKeyCaptureField:a}){let r;let l=(0,l1._i)(t?.keyCodes),i=t=>e({keyCodes:t,triggerDevice:"KEYBOARD"}),[s,c]=o.useState(!1),d=o.useRef(null);o.useEffect(()=>{(!t||!t.keyCodes||0===t.keyCodes.length)&&n&&d.current&&(a(!1),d.current.focus(),c(!0))},[a,n,t]),o.useEffect(()=>{if(!s)return()=>{};let t=new pd.L,n=t.onPress(t=>{e({keyCodes:[t.buttons[0]],triggerDevice:t.controllerType}),requestAnimationFrame(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})});return t.start(),()=>{n.release(),t.end()}},[e,s]);let p=null,m=(0,l1.E8)(t),u=(0,em.GS)();return s?r=o.createElement(pm,null,u?(0,T.tx)("proto.keyCapture.press_key_lowercase"):(0,T.tx)("proto.keyCapture.press_key")):t?.triggerDevice==="KEYBOARD"&&l?p=(0,l1.U8)(l):m?p=m:r=o.createElement(pm,null,u?(0,T.tx)("proto.keyCapture.click_to_set_key"):(0,T.tx)("proto.keyCapture.click_to_select")),o.createElement(ab.rp,{ref:d,className:"prototype_key_capture_field--root--bD21s","data-tooltip-type":ak.Ib.TEXT,"data-tooltip":p&&p.length>10?p:null,onFocus:()=>c(!0),onBlur:()=>c(!1),onKeyDown:e=>{e.preventDefault(),e.stopPropagation();let t=e.which||e.keyCode;!l1.RI.has(t)&&l1.pu[t]&&(t===l?.keyCode&&e.repeat?i((0,l1.wb)({keyCode:t,metaKey:e.metaKey||l.metaKey,shiftKey:e.shiftKey||l.shiftKey,ctrlKey:e.ctrlKey||l.ctrlKey,altKey:e.altKey||l.altKey})):i((0,l1.wb)({...e,keyCode:t})),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},recordingKey:"keycapture"},p??r)}function pm({children:e}){return o.createElement("span",{className:"prototype_key_capture_field--placeholder--gWUKF"},e)}class pu extends rq.l6{}class pE extends rq.c${}let py=new lz.VG,p_=new lz.EX,pg=new lz.JV,ph=new lz.Eq;function pf(e){let t=(0,r.wA)(),n=(0,a0.Um)(),a=(0,em.GS)(),l=(0,lc.cJ)(),{showVideoV2Triggers:s}=(0,iH.R)(e=>({allStatesInSelection:e.mirror.selectionProperties.stateGroupSelectionInfo?.mode===i.iCO.STATE,allTopLevelFramesInSelection:!!e.mirror.selectionProperties.allTopLevelFramesInSelection,showVideoV2Triggers:(0,lY.dq)(e.mirror.selectionProperties)})),c=(0,f.md)(lW.NE),d=(t,n)=>{let r=o.createElement("div",{className:"transition_interaction_dropdown--prototypeInteractionIcon---njby"},(0,lY.e7)(t));return o.createElement(pE,{key:n,value:t,icon:a?r:void 0,recordingKey:ar.Pt(e,t),disabled:!function(t){if("NONE"===t)return!0;let n=!!e.interactionsOnSelectedNodes&&e.interactionsOnSelectedNodes.every(t=>e.interactionsOnSelectedNodes&&ld.aI(t.sourceNodeID,e.interactionsOnSelectedNodes[0].sourceNodeID))&&!(0,n3.hS)(e.property),a=(function(){if(e.interactionsOnSelectedNodes)return new Set(e.interactionsOnSelectedNodes.map(e=>e?.event?.interactionType).filter(e=>void 0!==e))})()?.has(t)&&(0,n3.hS)(e.property)&&e.property!==t;return(!n&&!a||!!["ON_KEY_DOWN","DRAG","ON_VOICE","ON_MEDIA_HIT"].includes(t))&&("AFTER_TIMEOUT"===t?!e.interactionContainsOpenLinkAction:"ON_MEDIA_HIT"===t||"ON_MEDIA_END"===t?s:(!e.interactionContainsOpenLinkAction||"ON_CLICK"===t||"MOUSE_UP"===t)&&(!e.interactionContainsUpdateMediaRuntime||"ON_HOVER"!==t&&"ON_PRESS"!==t&&"DRAG"!==t)&&(!e.interactionOnlyContainsBack||"ON_HOVER"!==t&&"ON_PRESS"!==t))}(t)})},p=(l?[]:["NONE"]).map(d),m=["ON_CLICK",...l?[]:["DRAG"],"ON_HOVER","ON_PRESS","ON_KEY_DOWN"].map(d),u=["MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].map(d),E=(l?[]:["ON_MEDIA_HIT","ON_MEDIA_END"]).map(d),y=["AFTER_TIMEOUT"].map(d),_=c?"ON_MEDIA_HIT"!==e.property?p_:ph:"ON_MEDIA_HIT"!==e.property?py:pg,g=o.useCallback(e=>e-24,[]),h=(0,n3.E7)(e.property);return o.createElement(pu,{id:"interaction-type-select",className:e.className,chevronClassName:"transition_interaction_dropdown--chevron--pyzhq",dataTestId:"interaction-select",property:e.property,formatter:_,icon:a&&h?(0,lY.e7)(h):void 0,onChange:e.onChange,dispatch:t,dropdownShown:n,recordingKey:ar.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,nR.nl)(),dropdownAlignment:g,dropdownWidth:160},p,!l&&o.createElement(rq.sK,null),m,o.createElement(rq.sK,null),u,!l&&o.createElement(rq.sK,null),y,!l&&s&&[o.createElement(rq.sK,{key:""}),...E])}let pv={keyCodes:[],triggerDevice:"KEYBOARD"};function pb(e,t,n,a){return n?o.createElement(rZ.cS,{label:e,input:t,appendedClassName:a?void 0:cw.dU}):o.createElement(ab.fI,null,t)}function pS(e){let{detailPropsMultipleActions:t,interactionsOnSelectedNodesAndComponents:n,updateSelectionProperties:a}=(0,l2.Ay)(e.category),{interactionType:l="NONE",transitionTimeout:i=.8,mediaHitTime:s=0,interactionMaintained:c=!1,interactionDuration:d=.3,keyTrigger:p=pv}=t.interactionEvent,m=(e,t)=>{if(e.connectionType===t)return e;if("CONDITIONAL"===e.connectionType)for(let n of(0,n3.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]){let e=n.actions?n.actions.find(e=>e.connectionType===t):void 0;if(void 0!==e)return e}return null},u=void 0!==t.interactionActions.find(e=>m(e,"URL")),E=void 0!==t.interactionActions.find(e=>m(e,"UPDATE_MEDIA_RUNTIME")),y=1===t.interactionActions.length&&"BACK"===t.interactionActions[0].connectionType,_=void 0!==t.interactionActions.find(e=>m(e,"CONDITIONAL"));return function(e){let t=(0,r.wA)(),n=e.updateSelectionProperties,a=(0,nU.RU)(),[l,i]=o.useState(!1),s=(0,em.GS)(),c=(0,l0.YT)(),d=c===l0.Oz.SINGLE_COL,p=c===l0.Oz.TWO_COL,m=!0===(0,n3.E7)(e.maintained),u=(0,n3.E7)(e.keyTrigger),E="ON_KEY_DOWN"===(0,n3.E7)(e.interactionType),y="AFTER_TIMEOUT"===(0,n3.E7)(e.interactionType),_="ON_MEDIA_HIT"===(0,n3.E7)(e.interactionType),g=["MOUSE_IN","MOUSE_OUT","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].indexOf((0,n3.E7)(e.interactionType)||"")>-1,h=o.createElement(pf,{className:cw.sQ,property:e.interactionType,onChange:a=>{cm.sn.start("interaction_details_changed"),n({interactionType:a}),t((0,lp._P)({name:"Prototype Interaction Type Changed",params:{newType:a,oldType:(0,n3._W)(e.interactionType,"MIXED")}})),"ON_KEY_DOWN"===a&&i(!0)},interactionContainsOpenLinkAction:e.interactionContainsOpenLinkAction,interactionContainsUpdateMediaRuntime:e.interactionContainsUpdateMediaRuntime,interactionOnlyContainsBack:e.interactionOnlyContainsBack,recordingKey:ar.Pt(e,"interactionDropdown"),interactionsOnSelectedNodes:e.interactionsOnSelectedNodes}),f=s?d?o.createElement(rZ.cS,{label:(0,T.tx)("proto.trigger"),input:h}):o.createElement("div",{className:cw.BX},h):o.createElement(ab.fI,{className:eA()(cw.SG,cw.QT)},h,o.createElement("div",{className:cw.LY},e.headerButtons)),v=o.createElement(o.Fragment,null,y&&pb((0,T.tx)("proto.delay"),o.createElement(rm.W4,{className:s?cw.Lp:cw.Zp,inputClassName:s?cw.Gl:void 0,dataTestId:"timeout-input",dispatch:t,value:e.timeout,onValueChange:e=>{n({transitionTimeout:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:20,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:ar.Pt(e,"timeoutInput")},s?o.createElement(pc.A,null):void 0),s,d),E&&pb((0,T.tx)("proto.key"),o.createElement(pp,{onChange:e=>{n({keyTrigger:e})},value:u,shouldFocusKeyCaptureField:l,setShouldFocusKeyCaptureField:i}),s,d),_&&pb((0,T.tx)("proto.time"),o.createElement(rm.qd,{displayFractions:!0,className:cw.Ym,inputClassName:cw.vE,dataTestId:"mediaHitTime-input",dispatch:t,value:e.mediaHitTime,onValueChange:e=>{n({mediaHitTime:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:3600,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("proto.trigger.video_hit_time"),tooltipForScreenReadersOnly:!0,recordingKey:ar.Pt(e,"mediaHitTimeInput")},s?o.createElement(d7,null):void 0),s,d),g&&pb((0,T.tx)("proto.delay"),o.createElement(rm.W4,{className:s?cw.Lp:cw.aq,inputClassName:s?cw.Gl:cw.p0,dataTestId:"duration-input",dispatch:t,value:m?e.interactionDuration:void 0,onValueChange:e=>{n(e&&e>0?{interactionMaintained:!0,interactionDuration:e}:{interactionMaintained:!1})},min:0,allowEmpty:!0,placeholder:(0,T.t)("proto.trigger.add_delay_placeholder"),wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,"data-tooltip-type":ak.Ib.TEXT,"data-tooltip":(0,T.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:ar.Pt(e,"delayInput")},s?o.createElement(pc.A,null):void 0),s,d));return s?o.createElement("div",{className:p?cw.eU:void 0},f,v):o.createElement("div",{className:cw.cF},f,v)}({...e,updateSelectionProperties:a,interactionType:l,interactionContainsOpenLinkAction:u,interactionContainsUpdateMediaRuntime:E,interactionOnlyContainsBack:y,interactionContainsConditionalAction:_,timeout:i,maintained:c,interactionDuration:d,mediaHitTime:s,keyTrigger:p,interactionsOnSelectedNodes:n,recordingKey:ar.Pt(e.recordingKey,l0.Qe)})}let pT="prototype_interaction_edit_modal--contentContainer--bo2b4",pN="prototype_interaction_edit_modal--ui3TwoColContentContainer--x9vrG",pI="prototype_interaction_edit_modal--ui3SingleColContentContainer--uF-ir",pP="prototype_interaction_edit_modal--dividerHorizontal--3wvnB",pC="prototype_interaction_edit_modal--ui3InteractionsPanelContentRight--bVfG8";function pA(e){let{selectedInteractions:t,makeUpdateSelectionPropertiesForActionIndex:n,makeUpdateMultipleDestinationNodesForActionIndex:a,differentLengthActions:r,mergedActions:l}=(0,l2.Ay)(e.category),i="NONE"!==(0,n3.E7)(e.interactionType),s=void 0!==l.find(e=>"CONDITIONAL"===e.connectionType),{selectedActionIndex:c,onSelect:d}=e,p=(0,em.GS)(),m=(0,l0.YT)(),u=m===l0.Oz.SINGLE_COL,E=m===l0.Oz.TWO_COL,{expandedRows:y,setExpandedRows:_,deleteButtonPressed:g,newActionIndexPath:h,resetNewActionIndexPath:f}=e;o.useEffect(()=>{h&&!h?.equals([])&&(p?d(h.path,!0):(_([...y,h]),d([],!1)),f())},[y,_,h,f,d,p]);let v=o.useCallback(e=>{y.find(t=>t.equals(e))?_(y.filter(t=>!t.equals(e))):_([...y,new dy.Op(e)])},[y,_]),b=o.useCallback(n=>{var a=n.dropItem;if((0,n3.gl)(a)||(0,dy.qQ)(n.dragItem))return;let o=e.interactionsOnSelectedNodes;if(!o||!t)return;for(var r=0;r<t?.length;r++){let e=t[r];if(e&&e.actions){let o=e.actions,l=(0,dy.Vp)(o,c,y,a,n.position);if(l.newSelectedActionIndex&&E&&d(l.newSelectedActionIndex.path,!0),l.newActions&&(t[r].actions=l.newActions,p||d([],!1)),l.newExpandedRows){if(E){let e=[];l.newActions?.forEach((t,n)=>{"CONDITIONAL"===t.connectionType&&e.push(new dy.Op([n]))}),_(e)}else _(l.newExpandedRows)}}}let l=o.map(e=>t.find(t=>t.id===e.id)??e);t5.Y5.updateSelectionProperties({prototypeInteractions:l})},[y,_,e.interactionsOnSelectedNodes,c,t,d,p,E]),S=eA()({"prototype_interaction_edit_modal--panelUI3--WK3CN":p,"prototype_interaction_edit_modal--panelUI3TwoColumn--V5gi4":E});return o.createElement(cu.hh,null,o.createElement(ab.Zk,{className:S},e.shouldHideTitle?null:o.createElement(ab.fI,null,o.createElement(ab.U8,{title:(0,T.t)("proto.interaction.interaction"),dataTooltipContentKey:c_,dataTooltipTimeoutDelay:50})),o.createElement("div",null,(i||p)&&o.createElement(o.Fragment,null,u&&o.createElement(o.Fragment,null,o.createElement(pS,{category:e.category,recordingKey:l0.dJ,headerButtons:o.createElement(o.Fragment,null)}),o.createElement("div",{className:"prototype_interaction_edit_modal--dividerHorizontalUI3--HMCeE"})),r&&o.createElement(cE.Y,{direction:"horizontal",padding:{horizontal:16,vertical:12}},o.createElement(ab.UZ,null,(0,T.tx)("fullscreen.properties_panel.click_plus_to_replace_mixed_content"))),!r&&o.createElement(o.Fragment,null,l?.map((r,i)=>o.createElement(ps,{key:i,updateMultipleDestinationNodes:a(i),action:r,recordingKey:ar.Pt(e.recordingKey,l0.eG,i),updateSelectionProperties:n(i),onDeleteAction:()=>g(i),interactionType:e.interactionType,actionIndexPath:[i],numActions:l.length,isNestedInConditional:!1,isNarrowPanel:!s,stateManagementVersion:e.stateManagementVersion,selectedInteractions:t,onDrop:b,onSelect:e.onSelect,onExpand:v,selectedActionIndex:c,autoOpenVariablePicker:e.autoOpenVariablePicker,expandedRows:y,onNewActionAdded:e.onNewActionAdded,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder})))))))}function pk({transition:e,recordingKey:t,updateSelectionProperties:n,stateManagementVersion:a,selectedInteractions:l}){let i=(0,r.wA)(),s=(0,em.GS)(),c=(0,l0.YT)()===l0.Oz.SINGLE_COL,p=()=>{for(let t of(ek.az.trackDefinedEvent("prototype.state_management_noodle_upgraded",{num_interactions:l.length,preserve_scroll_position_value:!!e.preserveScroll}),l))(0,l0.uU)(t.stateManagementVersion)&&t.id&&t.sourceNodeID&&d$.zZ.recordInteractionUpgraded(t.id,t.sourceNodeID);n({...(0,n3.hS)(e.preserveScroll)&&(0,n3.hS)(a)?{transitionResetScrollPosition:!e.preserveScroll}:{},stateManagementVersion:1}),i(d.F.enqueue({type:"state-management-updated",message:(0,T.t)("proto.state_management.visual_bell_updated_message"),button:{text:(0,T.t)("proto.state_management.visual_bell_update_all"),action:()=>{t5.Y5.triggerActionInUserEditScope("update-interactions-state-management-on-page"),i(d.F.enqueue({type:"state-management-updated-all",message:(0,T.t)("proto.state_management.visual_bell_update_all_message")}))}}}))},m=()=>{ek.az.trackDefinedEvent("prototype.state_management_noodle_reverted",{num_interactions:l.length}),n({stateManagementVersion:0})},E=1===a?o.createElement(nt.$n,{variant:"link",recordingKey:ar.Pt(t,"revert-state-management-version"),onClick:m,htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,T.tx)("proto.state_management.revert_controls")):o.createElement(nt.$n,{variant:"secondary",recordingKey:ar.Pt(t,"update-state-management-version"),onClick:p},(0,T.tx)("proto.state_management.update_controls")),y=c?nt.IK:nt.$n,_=1===a?o.createElement(y,{variant:"secondary",onClick:m,recordingKey:ar.Pt(t,"revert-state-management-version"),htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,T.tx)("proto.state_management.revert_controls")):o.createElement(y,{variant:"primary",onClick:p,recordingKey:ar.Pt(t,"update-state-management-version")},(0,T.tx)("proto.state_management.update_controls")),g=1===a?(0,T.tx)("proto.state_management.new_controls"):(0,T.tx)("proto.state_management.old_controls"),h=o.createElement(u.N,{trusted:!0,newTab:!0,href:"https://help.figma.com/hc/articles/14397859494295"},s?(0,T.tx)("proto.state_management.controls_help_link_new"):(0,T.tx)("proto.state_management.controls_help_link")),f=o.createElement("div",{className:"prototype_state_management_version_panel--versionControls--siAOf"},o.createElement(ab.JU,{className:"prototype_state_management_version_panel--label--vvYMX"},g,h),o.createElement("div",{className:"prototype_state_management_version_panel--buttonContainer--rJZ-y"},E)),v=o.createElement("div",{className:"prototype_state_management_version_panel--containerUI3--V5tpG"},o.createElement(tI.J,null,g),o.createElement(tI.J,null,h),_),b=o.createElement("div",{className:"prototype_state_management_version_panel--containerUI3TwoCol--AAp8u"},o.createElement("span",{className:"prototype_state_management_version_panel--labelWrapperUI3--37g5A"},o.createElement(tI.J,null,g)),o.createElement("span",{className:"prototype_state_management_version_panel--helpLinkWrapperUI3--BttuC"},h),_);return o.createElement(as.k,{name:"prototype_state_management_version_panel"},o.createElement(ab.Zk,{className:s?"prototype_state_management_version_panel--panelUI3--8-Db5":void 0},s?c?v:b:f))}let pw="created_noodle";function pO(e){let{shouldHideTitle:t=!1,category:n,newActionIndexPath:a}=e,r=(0,l0.YT)()===l0.Oz.TWO_COL,{detailProps:l,detailPropsMultipleActions:i,interactionsOnSelectedNodesAndComponents:s,updateSelectionProperties:c,selectedInteractions:d}=(0,l2.Ay)(e.category);(0,ew.h)(()=>{if(void 0!==cm.sn.get(pw)){let e=cm.sn.stop(pw);(0,ek.sx)(pw,{elapsedMs:e,numConnectors:d.length},{forwardToDatadog:!0})}});let{showPanel:p,transition:m}=(0,l0.n6)(l,i,d),{interactionType:u="NONE",interactionMaintained:E=!1,interactionDuration:y=.3,keyTrigger:_=pv,transitionTimeout:g=.8,mediaHitTime:h=0}=i.interactionEvent,f=(0,l0.iC)(d),v=o.createElement(pA,{interactionType:u,timeout:g,mediaHitTime:h,maintained:E,interactionDuration:y,keyTrigger:_,recordingKey:ar.Pt(e,l0.Qe),shouldHideTitle:t,interactionsOnSelectedNodes:s,category:n,stateManagementVersion:f,autoOpenVariablePicker:e.autoOpenVariablePicker,newActionIndexPath:a,resetNewActionIndexPath:e.resetNewActionIndexPath,onNewActionAdded:e.onNewActionAdded,onSelect:e.onSelect,selectedActionIndex:e.selectedActionIndex,expandedRows:e.expandedRows,setExpandedRows:e.setExpandedRows,deleteButtonPressed:e.deleteButtonPressed,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder});return o.createElement("div",null,v,!r&&p&&o.createElement(pk,{transition:m,recordingKey:ar.Pt(e,"stateManagementVersionPanel"),updateSelectionProperties:c,stateManagementVersion:f,selectedInteractions:d}))}var px=n(360803),pD=n(102165);function pR(e,t,n){let[a,o,r]=e.path,l=t[a].conditionalActions;if((0,n3.hS)(l)){let e=l?.[o].actions?.length??0;if(r>=e){if(0===e){n([a],!0);return}n([a,o,r-1],!0);return}}}function pM(e,t,n){let a=e.path[0]>=t.length,o=0===e.path.length;if(a){n([t.length-1],!0);return}if(o){n([0],!0);return}}var pL=n(277687);let pV=()=>{i.glU.setSelectedInteractions([]),(0,s.kc)().prototype_ai_magic_link_show_suggestion_toast&&t5.Y5.showMagicLinkSuggestedVisualBell("create_node_transition"),t5.Y5.deselectProperty()},pK=(0,tv.jz)("197px"),pU=(0,tv.c8)("50%");function pF(e){var t;return e&&a?.height<369?a=t={...a,height:369}:a??={width:440,height:e?369:320,leftWidthPct:45}}let pB=o.memo(function(){let e=(0,r.d4)(pW),t=(0,l2.HS)(),{selectedInteractions:n}=(0,l2.Ay)(t),a=n.length>0,[l,i]=o.useState(!1),s=ar.v_(l0.dJ,"keydown",t=>"Shift"!==t.key?ar.aH:(i(!0),e&&a)?void 0:ar.aH),c=ar.v_(l0.dJ,"keyup",t=>"Shift"!==t.key?ar.aH:(i(!1),e&&a)?void 0:ar.aH);if(o.useEffect(()=>(document.addEventListener("keydown",s),document.addEventListener("keyup",c),()=>{document.removeEventListener("keydown",s),document.removeEventListener("keyup",c)}),[s,c]),!e||!a)return null;let d=n.some(e=>e.actions?.some(e=>"CONDITIONAL"===e.connectionType));return o.createElement(pG,{category:t,containsConditional:d,pressingShiftKey:l,initialX:e.initialX,initialY:e.initialY,shouldPin:e.shouldPin,setPressingShiftKey:i})}),pG=o.memo(function({category:e,containsConditional:t,pressingShiftKey:n,initialX:l,initialY:s,shouldPin:c,setPressingShiftKey:d}){let p=(0,r.wA)(),[m,u]=o.useState(!1),[,E]=(0,f.fp)(pD.x),y=(0,o.useRef)(null),[_,g]=o.useState(!1),h=c||m,v=(0,em.GS)(),b=(0,l0.YT)(),S=b===l0.Oz.SINGLE_COL,N=b===l0.Oz.TWO_COL,[I,P]=o.useState(new dy.Op(v?[0]:[])),{selectedInteractions:C,differentLengthActions:A,interactionsOnSelectedNodesAndComponents:k,mergedActions:w,detailProps:O,detailPropsMultipleActions:x,updateSelectionProperties:D}=(0,l2.Ay)(e);var R=I.path.length>0?I:new dy.Op([0]);let M=R.isConditional(),L=(e,t)=>R=new dy.Op(e);v&&R.path[0]>=w.length&&!M?pM(I,w,L):v&&M&&pR(I,w,L);let V=o.useCallback((e,t)=>{t?P(new dy.Op(e)):P(new dy.Op([]))},[]);o.useEffect(()=>{if((0,cs.vA)(w.length>0,"the interactions panel should always have actions if rendered"),!v)return;let e=I.isConditional();if(e){if(e){pR(I,w,V);return}}else{pM(I,w,V);return}},[w,I,v,V]);let{shouldShowAdvancedPrototypingPaywall:K,showAdvancedPrototypinglMultipleActionsModal:B}=(0,l0.zt)(),{showPanel:G,transition:z}=(0,l0.n6)(O,x,C),Y=(0,l0.iC)(C);var W=[];N?w.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&W.push(new dy.Op([t]))}):w.length<4&&w.forEach((e,t)=>{W.push(new dy.Op([t]))});let[H,$]=o.useState(W),X=o.useRef(null),Q=n&&!h&&!_,J=(0,tv.jz)(is.prototypeInteractionModalWidth),j=(0,tv.jz)(is.prototypeInteractionModalExpandedWidth),q=pF(G).width,Z=t?j:J;N&&(Z=q);let[ee,et]=o.useState(c),en=(0,cd._X)({subscribeToUpdates_expensive:!c}),ea=o.useCallback(()=>{m||(p((0,lp._P)({name:"prototype_interaction_details_modal_dragged"})),u(!0))},[p,m,u]),eo=o.useMemo(()=>{let e=new tS.Mi(l,s);if(c)return N?new tS.Mi(e.x-(q-J),e.y):t?new tS.Mi(e.x-(j-J),e.y):e;{let t=(0,cd.$g)(en,e);return new tS.Mi(t.x-Z/2,t.y+30)}},[Z,l,s,t,c,en,N,j,J,q]);o.useEffect(()=>{if(!n)return;let e=e=>{!e.shiftKey&&n&&d(!1)};return document.addEventListener("mousemove",e),()=>{document.removeEventListener("mousemove",e)}},[n,d]),o.useEffect(()=>{E(Q)},[E,Q]),o.useEffect(()=>{et(c)},[c]),o.useEffect(()=>()=>{p((0,lp._P)({name:"prototype_interaction_details_modal_closed"}))},[p]);let er=o.useRef(null),[el,ei]=o.useState(!1);o.useEffect(()=>{el&&(ei(!1),er.current?.scrollToBottom())},[el,ei,er]);let[es,ec]=o.useState(new dy.Op([])),ed=(0,F.q5)(),ep=o.useCallback((e,t)=>{let n=e.event.clipboardData||window.clipboardData;switch(t){case ag.zy.COPY:case ag.zy.CUT:{let a=JSON.parse(JSON.stringify(C)),o=(0,px.l)(a),r=sN.fG(ed?.key||null,{prototypeInteractions:o});if(sN.C4(n,r,""),t===ag.zy.CUT){let e=[];for(let t of C){let{sourceNodeID:n,id:a}=t;n&&a&&e.push(lB.d({nodeID:n,interactionID:a}))}t1.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(e)),t5.Y5.deselectProperty()}e.accept()}}},[ed?.key,C]),eu=o.useRef(!1),[eE,ey]=o.useState(!1),{firstVariableSetMode:e_,firstVariableSetID:eg}=c2(),eh=(0,U.p8)("currentPage"),ef=o.useCallback((e,t,n,a)=>{p((0,lp._P)({name:"Prototype delete action",params:{action:e,source:"panel",connector_id:t,page_id:n,actionInConditionalAction:a}}))},[p]),ev=o.useCallback(e=>{if(k&&C){var t=!1,n=!1;if(K)B();else{for(let r=0;r<C?.length;r++){let l=C[r],i=[];if(l&&l.actions){var a=0,o=[];for(let r=0;r<l.actions.length;r++){let s=l.actions[r];if(r!==e)void 0!==H.find(e=>e.equals([r]))&&o.push(new dy.Op([a])),i.push(s),a++;else{let e=l.id?l.id:ld.Hr;ef(s.connectionType?s.connectionType:"NONE",(0,ld.dI)(e),eh),r===l.actions.length-1&&(t=!0),2===l.actions.length&&(n=!0)}$(o)}C[r].actions=i}}let r=k.map(e=>C.find(t=>t.id===e.id)??e);t5.Y5.updateSelectionProperties({prototypeInteractions:r}),n&&v&&$([new dy.Op([0])]),t&&N&&P(new dy.Op([e-1]))}}},[k,C,K,B,H,eh,ef,N,v]),eb=o.useCallback(e=>{if(!k||!C||!e.path.length||void 0===e.path[0])return;let[t,n,a]=e.path,o=e.isConditional();if(K)B();else if(o){let e=!1,o=!1,r=C.map(r=>{let l=r.actions;if(!l)return r;let i=l.map((l,i)=>{if(i!==t||"CONDITIONAL"!==l.connectionType)return l;let s=l.conditionalActions;if(!s)return l;let c=s.map((t,l)=>{if(l!==n)return t;let i=t.actions;if(!i)return t;let s=i[a];s&&ef(s.connectionType?s.connectionType:"NONE",(0,ld.dI)(r.id??ld.Hr),eh,!0);let c=i.filter((e,t)=>t!==a);return e=a===i.length-1,o=0===c.length,{...t,actions:c}});return{...l,conditionalActions:c}});return{...r,actions:i}}),l=k.map(e=>r.find(t=>t.id===e.id)??e);t5.Y5.updateSelectionProperties({prototypeInteractions:l}),o?P(new dy.Op([t])):!o&&e&&P(new dy.Op([t,n,a-1]))}else ev(t);document.activeElement?.blur()},[k,C,K,B,ev,eh,ef]),eS=o.createElement(cc.P,{className:N?"prototype_interaction_edit_modal--ui3TwoColScrollContainer--IWuQ4":pT,useBottomPinning:!N,ref:er,allowScrollAndZoomOver:!0,"data-not-draggable":!0},o.createElement(pO,{shouldHideTitle:!0,recordingKey:N?ar.Pt("leftCol",l0.dJ):l0.dJ,category:e,autoOpenVariablePicker:eu,newActionIndexPath:es,resetNewActionIndexPath:()=>{ec(new dy.Op([]))},onNewActionAdded:e=>{ec(e)},selectedActionIndex:I,onSelect:V,expandedRows:H,setExpandedRows:$,deleteButtonPressed:ev,autoOpenExpressionBuilder:eE,setAutoOpenExpressionBuilder:ey})),eT=1===C.length,eN=C[0],eI=eN.actions&&eN.actions.length<2,eP=eN.actions&&1===eN.actions.length&&eN.actions[0],eC=!eP||"NONE"===eP.connectionType,ek=eT&&eI&&eC;var ew=ld.Hr;let eO=o.createElement(df,{skipPaywall:ek,addButtonPressed:e=>{if(!C)return;if(("CONDITIONAL"===e.connectionType||"SET_VARIABLE"===e.connectionType||"SET_VARIABLE_MODE"===e.connectionType)&&K){B();return}"SET_VARIABLE_MODE"===e.connectionType&&(e.targetVariableSetID=eg,e.targetVariableModeID=e_),"SET_VARIABLE"===e.connectionType&&eu&&(eu.current=!0),v&&"CONDITIONAL"===e.connectionType&&ey(!0);let t=!1;var n=null,a=v&&!A&&!ek&&C[0].actions&&1===C[0].actions.length;if(A||ek)for(var o=0;o<C.length;o++){let t=C[o];t.actions=[e];let n=t.id,a=t.sourceNodeID;(0,l0.uU)(t.stateManagementVersion)&&n&&a&&d$.zZ.recordInteractionUpgraded(n,a),t.stateManagementVersion=1}else for(var o=0;o<C.length;o++){let a=C[o];if(a.actions){if((0,l0.uU)(a.stateManagementVersion)&&(a.id&&a.sourceNodeID&&d$.zZ.recordInteractionUpgraded(a.id,a.sourceNodeID),a.actions?.forEach(e=>{e.transitionResetScrollPosition=!e.transitionPreserveScroll})),N){if(I.isConditional()){let n=I.path[0],o=I.path[1],r=I.path[2],l=a.actions?.[n],i=l.conditionalActions?.[o].actions?.length??0;n===a.actions.length-1&&r===i-1&&(t=!0),l.conditionalActions?.[o].actions?.splice(r+1,0,e)}else{let n=I.path[0]+1;n===a.actions.length&&(t=!0),a.actions?.splice(n,0,e)}}else a.actions?.push(e);ew=a.id?a.id:ld.Hr}else a.actions=[e],ew=a.id?a.id:ld.Hr;if(a.stateManagementVersion=1,N){let e=[...I.path];e[e.length-1]+=1,n=new dy.Op([...e])}else n=new dy.Op([a.actions.length-1])}let r=k.map(e=>C.find(t=>t.id===e.id)??e);if(t5.Y5.updateSelectionProperties({prototypeInteractions:r}),a||N){var l=[];r[0].actions?.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&l.push(new dy.Op([t]))}),$(l)}ei&&(!N||t)&&ei(!0),ec&&ec(n),p((0,lp._P)({name:"Prototype add action",params:{action:e.connectionType?e.connectionType:"NONE",source:"panel",connector_id:(0,ld.dI)(ew),page_id:eh}}))},renderButton:!0,recordingKey:l0.dJ,isNestedInConditional:N&&I.isConditional()}),ex=C.some(e=>void 0!==e.actions&&e.actions?.length>1),eD=!I.isConditional()&&!ex,eR=o.createElement(tT.K,{onClick:()=>eb(I),"aria-label":(0,T.t)("proto.prototype_panel.delete"),disabled:eD,recordingKey:ar.Pt(l0.dJ,"actionDeleteButton"),htmlAttributes:{"data-tooltip":(0,T.t)("proto.prototype_panel.delete"),"data-tooltip-type":ak.Ib.TEXT}},o.createElement(aA.U,{svg:pl.A},o.createElement(lU.O,null))),eM=o.createElement("div",{className:"prototype_interaction_edit_modal--ui3FooterContainer--oYsXM"},eO," ",eR),eL=o.createElement(cC.c.Provider,{value:cC.P.LEFT},o.createElement("div",{className:N?"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeftResizable--16pLu":"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeft--UYWSG",ref:X,style:N?{width:`${pF(G).leftWidthPct}%`}:void 0},o.createElement(pS,{category:e,recordingKey:l0.dJ,headerButtons:o.createElement(o.Fragment,null)}),o.createElement("div",{className:pP}),eS,o.createElement("div",{className:pP}),o.createElement(o.Fragment,null,eM))),eV=w.length>0?o.createElement(cC.c.Provider,{value:cC.P.RIGHT},o.createElement(cc.P,{allowScrollAndZoomOver:!0,"data-not-draggable":!0,className:N?"prototype_interaction_edit_modal--ui3ScrollContainerRight--LJr-n":void 0},o.createElement(pz,{selectedActionIndex:R,handleExpandUI3:(e,t)=>{!t&&w.length>1?$(H.filter(t=>!t.equals(e))):H.find(t=>t.equals(e))||$([...H,new dy.Op(e)])},autoOpenVariablePicker:eu,autoOpenExpressionBuilder:eE,setAutoOpenExpressionBuilder:ey}))):null,eK=o.useRef(pK),[,eU]=(0,ci.i)({disabled:!N,onDragStart(){X.current&&(eK.current=X.current.getBoundingClientRect().width)},onDrag(e){if(X.current&&eK.current){let t=pF(G),n=eK.current+e.delta.x,o=n/t.width*100;n<pK?o=pK/t.width*100:o>pU&&(o=pU),X.current.style.width=`${o}%`,a={...t,leftWidthPct:o}}}}),eF=N?o.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColPanelContainer--e8MK8"},o.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColInnerContainer--ZvJj2"},eL,o.createElement("div",{className:"prototype_interaction_edit_modal--dividerVertical--Noi1C"},o.createElement("div",{...eU({className:"prototype_interaction_edit_modal--verticalResizeHandle--xkc8V"})})),eV),G&&o.createElement(pk,{transition:z,recordingKey:ar.Pt(l0.dJ,"stateManagementVersionPanel"),updateSelectionProperties:D,stateManagementVersion:Y,selectedInteractions:C})):eS;return o.createElement(cp.ht.Provider,{value:o.useMemo(()=>({autoCloseOnScroll:!h}),[h])},o.createElement(af.vL,{name:"Prototype Draggable modal",className:"prototype_interaction_edit_modal--prototypeDraggableModal--njJ6A",handleClipboard:ep},o.createElement(rD.vx,{ref:y,dataTestId:"in-context-prototype-interaction-edit-modal",title:t=>o.createElement("div",{className:"prototype_interaction_edit_modal--onboardingRow--UlvE0"},o.createElement(pY,{category:e,recordingKey:l0.dJ,createActionTrigger:eO,closeButton:t})),containerClassName:eA()({[pT]:!N,[pN]:N,[pI]:S,"prototype_interaction_edit_modal--abovePropertiesPanel--hFejC":ee,"prototype_interaction_edit_modal--belowPropertiesPanel--f1Jfl":!ee,"prototype_interaction_edit_modal--modalExpandedWidth--IDl6k":t&&!v,"prototype_interaction_edit_modal--modalWidth--cCH7B":!t&&!v,"prototype_interaction_edit_modal--hideModal--RSp-R":Q}),contentContainerClassName:eA()({[pT]:!N,[pN]:N,[pI]:S}),headerClassName:"prototype_interaction_edit_modal--multilineInteractionDetailsHeader--OE8Wr",allowWheelPassthrough:!0,initialPosition:eo,headerSize:"small",onClose:pV,recordingKey:"interactionDetailsModal",arrowPosition:c?void 0:rD.F_.TOP,arrowRelativeX:c?void 0:Z/2,onDragStart:()=>{et(!0),ea()},canRenderBelowViewport:!0,allowAutoExpanding:!0,dragHeaderOnly:!0,onFocus:()=>g(!0),allowResizeHeight:N,allowResizeWidth:N,fullFrame:N,minWidth:N?440:void 0,minHeight:N?G?369:320:void 0,maxWidth:N?800:void 0,maxHeight:N?800:void 0,initialHeight:N?pF(G).height-rD.uF:void 0,initialWidth:N?pF(G).width:void 0,onResize:N?e=>{a={...pF(G),height:e.height,width:e.width}}:void 0},v?eF:eS)))});function pz({selectedActionIndex:e,autoOpenVariablePicker:t,handleExpandUI3:n,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:r}){let l=(0,l2.HS)(),{selectedInteractions:i,mergedActions:s,makeUpdateSelectionPropertiesForActionIndex:c,makeUpdateMultipleDestinationNodesForActionIndex:d,detailPropsMultipleActions:p}=(0,l2.Ay)(l),m=e.path[0],u=d(m),E=c(m),y=(0,l0.iC)(i),_=p.interactionEvent.interactionType??"NONE";if(e.isConditional()){let n=e.path[1],l=e.path[2],c=s[m],d=((0,n3.hS)(c.conditionalActions)&&c.conditionalActions?c.conditionalActions:[])[n],p=d?.actions?.[l];return p?o.createElement("div",{className:pC},o.createElement(ps,{key:l,updateMultipleDestinationNodes:u.appendActionIndex(n).appendActionIndex(l),action:p,recordingKey:ar.Pt(l0.dJ,l0.Qe,l0.eG,m),updateSelectionProperties:E.appendActionIndex(n).appendActionIndex(l),onDeleteAction:b.lQ,interactionType:_,actionIndexPath:e.path,numActions:s.length,isNestedInConditional:!0,stateManagementVersion:y,selectedInteractions:i,onDrop:b.lQ,onSelect:b.lQ,onExpand:b.lQ,selectedActionIndex:e,expandedRows:[e],autoOpenVariablePicker:t,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:r,isNarrowPanel:!0})):null}return o.createElement("div",{className:pC},o.createElement(ps,{key:m,updateMultipleDestinationNodes:u,action:s[m],recordingKey:ar.Pt(l0.dJ,l0.Qe,l0.eG,m),updateSelectionProperties:E,onDeleteAction:b.lQ,interactionType:_,actionIndexPath:[m],numActions:s.length,isNestedInConditional:!1,stateManagementVersion:y,selectedInteractions:i,onDrop:b.lQ,onSelect:b.lQ,onExpand:n,selectedActionIndex:e,autoOpenVariablePicker:t,expandedRows:[e],autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:r,isNarrowPanel:!0}))}function pY({category:e,recordingKey:t,closeButton:n,createActionTrigger:a}){let l=(0,r.wA)(),{selectedInteractions:c}=(0,l2.Ay)(e),d=(0,l0.YT)(),p=d===l0.Oz.TWO_COL,m=d===l0.Oz.SINGLE_COL,u=(()=>{if(1!==c.length)return 0;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id};return i.X3B.getMatchingInteractions(lB.d(t)).length})(),E=(0,s.kc)().prototype_hide_matching_noodles&&1===c.length&&u>1&&o.createElement(tT.K,{actionOnPointerDown:!0,onClick:()=>{if(1!==c.length)return;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=i.X3B.getMatchingInteractions(lB.d(t));i.glU.selectInteractionsAndSourceNodes(n);let a=(0,T.t)("proto.interaction_details.visual_bell.selected_n_matching_interactions",{total_num_interactions:n.length});t5.Y5.showVisualBellWithUndo("selected-matching-noodles",a,!1),l((0,lp._P)({name:"prototype_select_matching_interactions",params:{num_connectors:n.length}}))},"aria-label":(0,T.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:u}),htmlAttributes:{tabIndex:-1,onMouseEnter:()=>{if(1!==c.length)return;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=i.X3B.getMatchingInteractions(lB.d(t));i.glU.hoverInteractions(n)},onMouseLeave:()=>i.glU.hoverInteractions([]),"data-tooltip":(0,T.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:u}),"data-tooltip-type":ak.Ib.TEXT}},o.createElement(aA.U,{svg:pL.A},o.createElement(tw.A,null))),y=o.createElement(pS,{category:e,recordingKey:t,headerButtons:o.createElement(o.Fragment,null,E,a,n)}),_=o.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeader--Ka7aM"},(0,T.tx)("proto.interaction_details.header"),o.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeaderButtons--UqykU"},E,n)),g=o.createElement(o.Fragment,null,(0,T.tx)("proto.interaction_details.header"),o.createElement("div",{className:"prototype_interaction_edit_modal--ui3CollapsedModalHeaderButtons--7yPuD"},E,a,n));return p?_:m?g:y}let pW=e=>e.pickerShown?.id===lE.o$?e.pickerShown:null;var pH=n(803609),p$=n(229831),pX=n(859905),pQ=n(723325),pJ=n(551534),pj=n(448406),pq=n(811529),pZ=n(721910),p0=n(836328),p1=n(155565),p2=n(141123),p4=n(232205),p8=n(186380);function p3({asset:e}){return o.createElement(p5,{item:e},o.createElement("div",{className:"asset_shelf_suggestion--suggestion--j-USs"},o.createElement(p8.M,{className:"asset_shelf_suggestion--image--0iCDa",item:e,shouldGenerateLocalThumbnail:!0,draggable:!1})))}function p5(e){let{onInsertableResourcePointerDown:t,dragState:n}=(0,p4.j)({resource:e.item,isList:!0,sourceForTracking:"SuggestionsShelf",clickToInsert_DEPRECATED:!0,draggingThumbMaxDimensions:void 0});return o.createElement(o.Fragment,null,o.createElement(lG.GG,{onPointerDown:e=>{t(e)}},e.children),o.createElement(p2.q,{dragState:n,isList:!0}))}var p7=(e=>(e.BLACK_BLANK="40002168:784",e.BLACK_WHERE_TO="40000039:913",e.BROWN_REVISE_PROMPT="40000039:918",e.BROWN_TAB_TOGGLER="40000039:921",e))(p7||{}),p6=(e=>(e.MOBILE_DAY_PICKER="474:4773",e.MOBILE_PILL_TIME="474:4831",e.MOBILE_FLIGHT_CARD="469:2787",e.MOBILE_NOTIFICATION="475:6605",e.MOBILE_NOTIFICATION_BOOKS="2440:5914",e.MOBILE_TAB_TOGGLER="380:4294",e.MOBILE_ROME="213:2453",e.MOBILE_HILO="527:7273",e.MOBILE_DAY_VIEW="474:5088",e.MOBILE_SEARCH_INPUT_BLACK="449:9470",e.MOBILE_SEARCH_INPUT_GREEN="281:604",e.MOBILE_MEMORY_TILE_PURPLE="475:6981",e.MOBILE_LABEL_BLACK="475:6504",e.MOBILE_LABEL_GRAY="475:6503",e.MOBILE_BOTTOM_NAV_WHITE="452:10133",e))(p6||{});let p9=["449:9470","474:4773","474:4831","469:2787","475:6605","2440:5914"],me={"40002168:784":["449:9470","380:4294","527:7273","469:2787"],"40000039:913":["380:4294","527:7273","469:2787","474:5088","475:6504"],"40000039:918":["281:604","213:2453","475:6981","475:6503"],"40000039:921":["452:10133","213:2453","469:2787"]};function mt(){let[e,t]=o.useState(!0),[n,a]=o.useState([]),[r,l]=o.useState(!1),[i,s]=o.useState(!1),c=tL.D.getState(),d=(0,sG.MH)(c),[p,m]=(0,p1.d)(),u=(0,rO.uQ)();o.useEffect(()=>{let e=()=>s(!0),t=()=>s(!1);return window.addEventListener("mousedown",e),window.addEventListener("mouseup",t),()=>{window.removeEventListener("mousedown",e),window.removeEventListener("mouseup",t)}},[]),o.useEffect(()=>{if(i||!d)return;if(null===u){a([]);return}let e=me[u]||p9,t=[];e.forEach(e=>{let n=d[e];n&&n.type===pJ.PW.COMPONENT&&t.push(n)}),t.length>0&&(l(!0),setTimeout(()=>{l(!1)},1e3)),a(t)},[u,i,n.length,d]);let E=()=>{t(!e)},y=o.createElement(pX.k,{className:"suggestions_shelf--downChevron--UqYHR"}),_=o.createElement(pX.k,{className:"suggestions_shelf--upChevron--vOfon suggestions_shelf--downChevron--UqYHR"}),g=n.slice(0,5).map((e,t)=>o.createElement(p3,{key:`suggestion:${t}`,asset:e,fileName:"mock",thumbLayout:pj.rp.SMALL,thumbHeight:35,thumbWidth:40,sectionPosition:t,displayType:"list",sourceForTracking:"suggestionsShelf",viewMode:pq.Bk.Grid,keyboardPosition:(0,p0.pg)([pZ.tM.COMPONENTS],t,1)})),h=o.createElement("button",{className:"suggestions_shelf--downChevronContainer--ogqjc",onClick:E},y),f=o.createElement("div",{className:"suggestions_shelf--shelf--F8u-q"},r&&o.createElement(ra.k,null),!r&&(n.length>0?o.createElement("div",{className:"suggestions_shelf--suggestions--0Vvhl"},g):o.createElement("div",{className:"suggestions_shelf--emptyStateText--35oDc"},(0,T.t)("asset_suggestions.suggestion_shelf_empty_state"))),o.createElement("button",{className:"suggestions_shelf--upChevronContainer--u-hlh",onClick:E},_));return o.createElement(pQ.dP,null,o.createElement("div",{className:"suggestions_shelf--wrapper--HTBFs"},o.createElement("div",{className:e?"suggestions_shelf--shelfContainerOpen--MRPK2 suggestions_shelf--shelfContainer--YeoLM":"suggestions_shelf--shelfContainerClosed--nNOl1 suggestions_shelf--shelfContainer--YeoLM",style:{marginLeft:p,marginRight:m}},!e&&h,e&&f)))}function mn(){return(0,s.kc)().anticipation_uxr?o.createElement(mt,null):null}var ma=n(889185),mo=n(304657),mr=n(625693),ml=n(347240),mi=n(509734),ms=n(82963),mc=n(606319),md=n(433861),mp=n(593392);let mm="offscreen_indicators--indicatorGraphicBlue---nYr-",mu="offscreen_indicators--indicatorGraphicPurple--FAz-M",mE=(0,tv.jz)(ax.J4v),my=(0,tv.jz)(ax.v5y),m_=(0,tv.jz)(ax.M$q),mg=(0,tv.jz)(ax.y9S);function mh(){let e=[],t=(0,i$.kl)("selectionRegions"),n=(0,n3.E7)(t);n&&(e=n);let a=(0,r.d4)(e=>e.mirror.appModel.hoveredNode);if(a&&(0,s.kc)().ce_offscreen_indicators_for_hovered_nodes){let t=(0,te.UN)().get(a);if(t){let n=t.absoluteBoundingBox;e=[...e,{bounds:{height:n.h,width:n.w,x:n.x,y:n.y},regionType:t.isPrimaryInstance||t.isInstanceSublayer||t.isSymbolSublayer||t.isSymbolPublishable?l$.fV.SYMBOLS_ONLY:l$.fV.MIXED_OR_NO_SYMBOLS}]}}let l=!!e&&e.length>=1,i=(0,cd._X)({subscribeToUpdates_expensive:l});return i&&e?o.createElement(mf,{viewportInfo:i,regions:e}):null}function mf({viewportInfo:e,regions:t}){let n=(0,o.useContext)(md.kw),a=(0,o.useMemo)(()=>n.getCommentsWrapperOffset(e),[n,e]),l=a.x,i=a.y,s={transform:`translate(${l}px, ${i}px)`},c=(0,em.GS)(),d=(0,nK.b)(),p=c&&!d,m=(0,r.d4)(e=>e.mirror?.appModel.showUi),u=(0,nU.dP)()+(p?m_:mE),E=(0,nU.qw)()+u+(p?m_:my),y=(0,eB.Ye)(),{isPropertiesPanelCollapsed:_}=(0,nX.iT)(),g=(p&&m&&!y?u:0)-3.5,h=(p&&m&&!_?E:0)-7,f=(0,er.J2)((0,nU.UK)().renderRulers)&&m?mg:0,v={x:g+f,y:-3.5+f,width:e.width-h-f,height:e.height- -7-f},b={x:g+f,y:-3.5+f,width:e.width-h-f,height:e.height- -7-f};return o.createElement(o.Fragment,null,o.createElement(mp.p,null,o.createElement("div",{"aria-hidden":!0,"data-forward-events-to-fullscreen":!0,className:"offscreen_indicators--overlay--pNOlw",style:s},!!t?.length&&o.createElement("div",null,t.map((t,n)=>{let a=(0,cd.Z0)(e,{x:t.bounds.x,y:t.bounds.y}),r=(0,cd.Z0)(e,{x:t.bounds.x+t.bounds.width,y:t.bounds.y+t.bounds.height}),l={x:a.x,y:a.y,width:r.x-a.x,height:r.y-a.y};return l.x<v.x+v.width&&l.x+l.width>v.x&&l.y+l.height>v.y&&l.y<v.y+v.height?null:o.createElement(mv,{key:n,viewportBounds:b,viewportInfo:e,indicatorViewportBounds:l,selectionBoundsScaledWidth:function(e,t){let n=Math.max(e.x,t.x);return Math.max(Math.min(e.x+e.width,t.x+t.width)-n,10)}(l,b),selectionBoundsScaledHeight:function(e,t){let n=Math.max(e.y,t.y);return Math.max(Math.min(e.y+e.height,t.y+t.height)-n,10)}(l,b),selectionRegionType:t.regionType})})))))}function mv({viewportBounds:e,viewportInfo:t,indicatorViewportBounds:n,selectionBoundsScaledWidth:a,selectionBoundsScaledHeight:l,selectionRegionType:i}){let s=function(e,t){let n=0-t.x,a=0+e.width-t.x,o=0-t.y,r=0+e.height-t.y,l=Math.abs(n)<a?n:a,i=Math.abs(o)<r?o:r,s=n<0!=a<0,c=o<0!=r<0;return s&&c?Math.abs(l)<Math.abs(i)?{x:t.x+l,y:t.y}:{x:t.x,y:t.y+i}:!s&&c?{x:t.x+l,y:t.y}:s&&!c?{x:t.x,y:t.y+i}:{x:t.x+l,y:t.y+i}}(t,{x:n.x+n.width/2,y:n.y+n.height/2});s.x-=a/2,s.y-=l/2;let c=(0,r.d4)(e=>e.mirror?.appModel.showUi),d=(0,er.J2)((0,nU.UK)().renderRulers)&&c?mg:0,p=(0,em.GS)(),m=(0,nK.b)(),u=p&&!m,E=u?m_:mE,y=u?m_:my,_=(0,nU.dP)()+E,g=(0,nU.qw)()+y,h=(0,eB.Ye)(),{isPropertiesPanelCollapsed:f}=(0,nX.iT)(),v=1+(c&&u&&!h?_+1:0)+d,b=Math.max(v,t.width-1-a-(c&&u&&!f?g+1:0)),S=1+d,T=Math.max(S,t.height-1-l-1),N=tS.Mi.bound(s,{min:{x:v,y:S},max:{x:b,y:T}}),I=n.y+n.height<e.y,P=n.y>e.y+e.height,C=n.x+n.width<e.x,A=n.x>e.x+e.width;N.x+=t.x,N.y+=t.y;let k=Math.min(t.width-2-(c&&u?g+_:0),a),w=Math.min(t.height-2,l);return o.createElement("div",{className:"offscreen_indicators--indicator---T9xk",style:{transform:`translate3D(${N.x}px, ${N.y}px, 0)`}},(I||P)&&o.createElement("div",{style:{position:"absolute",height:1.5,width:k,marginTop:P?w-1.5:0},className:eA()({[mm]:i===l$.fV.MIXED_OR_NO_SYMBOLS,[mu]:i===l$.fV.SYMBOLS_ONLY})}),(C||A)&&o.createElement("div",{style:{position:"absolute",left:0,height:w,width:1.5,marginLeft:A?k-1.5:0},className:eA()({[mm]:i===l$.fV.MIXED_OR_NO_SYMBOLS,[mu]:i===l$.fV.SYMBOLS_ONLY})}))}var mb=n(109176);let mS=o.memo(({shouldShowDragAndDropBorder:e})=>{let t=(0,U.p8)("isReadOnly"),n=(0,r.d4)(e=>e.progressBarState),a=(0,U.p8)("loadingEmbeds"),m=(0,er.ut)(i.Ez5?.uiState().showCanvasSearch,!1),u=(0,el.Lk)(),E=(0,o.useRef)(null),y=(0,r.d4)(e=>e.userFlags),_=!!(0,s.kc)().internal_only_debug_tools||!!y.has_cursor_bot_onboarding_v2,g=(0,r.d4)(e=>e.openFile),h=g?g.key:"",f=(0,r.d4)(e=>e.universalInsertModal),v=(0,r.wA)();(0,q.Gb)(h),(0,eo.W)(),function(){let e=(0,rd.VW)(),t=(0,aa.ZC)(e?.guid),n=(0,U.p8)("activeUserAction"),a=(0,l3.LC)();o.useEffect(()=>{a&&(0,s.kc)().fragment_search_selection_suggest&&[i.QOV.DEFAULT,i.QOV.CLICKING_TO_CHANGE_SELECTION].includes(n)&&e?.guid!==t&&e&&(e.hasEnabledAnimatedPaint||e.isTopLevelFrame()||e.fills.some(e=>"IMAGE"===e.type))?(0,l9.iP)(l5.JT.FIND_INSPIRATION):e?.guid===t&&[i.QOV.DEFAULT,i.QOV.CLICKING_TO_CHANGE_SELECTION].includes(n)||(0,l9.KY)({actionToClear:l5.JT.FIND_INSPIRATION})},[e,n,t,a])}();let b=(0,en.BI)(),S=(0,j.l7)(),T=S?o.createElement(c.tH,{boundaryKey:"DevModeLeftPanel",fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING,sentryTags:{area:l.eBU.DEVELOPER_TOOLS}},o.createElement(p.O,null)):o.createElement(s0,null);return o.createElement(nD,null,o.createElement(Z.ED,null),o.createElement(sg.sk,null,n.mode!==i.Oin.OFF&&o.createElement("div",{className:mb._q}),o.createElement(ty.pO,{initialFilterState:{currentPage:!1}},a.map(e=>o.createElement(nw._,{key:`loading-embed-${e}`,nodeId:e})),o.createElement(sh.qn,null),o.createElement(ms.u,null),m&&o.createElement(s3.n,null),(0,s.kc)().ce_al_experiments_on&&o.createElement(s3.n,null),o.createElement(nk.GR,null),o.createElement(nk.bu,null),o.createElement(p$.J,null),o.createElement(sh.XI,{commentsDetailContainerRef:E}),o.createElement(mh,null),(0,s.kc)().cursor_bot&&_&&o.createElement(s4.S,null),o.createElement(sU,null),o.createElement(nC.J,null),o.createElement(s2.Nz,null),o.createElement("div",{ref:E}),!(0,et.T)()&&T,!t&&o.createElement(pB,null),o.createElement(nA.G,null,S?null:o.createElement(o.Fragment,null,o.createElement(mT,null),!!b?.shouldOptimizeForIpadApp&&o.createElement(ml.K,null),!!b?.shouldOptimizeForIpadApp&&o.createElement(mi.t,null))),e&&o.createElement(s2.X5,null)),o.createElement(ei.A,{isFigjamEditor:!1,isDesignEditor:!0,isSlidesEditor:!1,openFile:g}),o.createElement(pH.l,{defaultViewTabsAvailable:!0,defaultViewAssetsTabVisible:!0}),f.showing&&o.createElement(c.tH,{boundaryKey:"FdBrowseResourceModal",onError:()=>{v(d.F.enqueue({message:"Unable to open inserts menu",type:"react-error"}))},fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING},o.createElement(mo.k,null))),u&&o.createElement(s8.K,{className:mb.PA},o.createElement(mr.s,null)))}),mT=o.memo(function(){let e=(0,r.d4)(e=>e.mirror.appModel),t=(0,U.ax)(),{topLevelMode:n}=e,a=(0,U.dH)();return(0,ea.z)({topLevelMode:i.lyf.PREVIEW,eventName:"Preview Mode Selection Changed",teamFilesOnly:!0}),o.useEffect(()=>{t&&n===i.lyf.PREVIEW&&a!==i.NLJ.COMMENTS&&(0,ee.NT)(i.FAf.INSPECT)},[t,n,a]),o.createElement(o.Fragment,null,o.createElement(s_,null),o.createElement(mN,null))}),mN=o.memo(function(){return o.createElement(o.Fragment,null,o.createElement(es.p,null,o.createElement(ec.L,null)),o.createElement(es.p,{featureFlag:"starting_points_modal"},o.createElement(e2,null)),o.createElement(es.p,null,o.createElement(J,null)),o.createElement(es.p,{featureFlag:"tooltips_no_basics_rollout"},o.createElement(s5.Ay,null)),o.createElement(es.p,null,o.createElement(ma.e,null)),o.createElement(es.p,null,o.createElement(ts,null)),o.createElement(es.p,null,o.createElement(tE,null)),o.createElement(es.p,{featureFlag:"mobile_prompt_sidebar_modal"},o.createElement(cr,null)),o.createElement(es.p,null,o.createElement(ev,null)),o.createElement(es.p,null,o.createElement(m.S,null)),o.createElement(es.p,null,o.createElement(mn,null)),o.createElement(es.p,{featureFlag:"cmty_visual_assets_nux"},o.createElement(e9,null)),o.createElement(es.p,{featureFlag:"aip_flower_garden"},o.createElement(nN,null)))});function mI(){let[e,t]=(0,o.useState)(!1);return o.createElement(nO.c,{loadedCommentsProvider:!1},o.createElement(mc.v,{setShouldShowDragAndDropBorder:t,isDragTarget:!1},o.createElement(mS,{shouldShowDragAndDropBorder:e})))}},511787:(e,t,n)=>{n.d(t,{f:()=>y});var a=n(411855),o=n(153234),r=n(572206),l=n(268537),i=n(163023),s=n(318812),c=n(298543),d=n(184837),p=n(820396),m=n(1715),u=n(590685),E=n(501191);function y({resolvedTypes:e,recordingKey:t}){let{showing:n,toggle:l,hide:p}=(0,s.BK)("expression-builder-create-variable"),m=a.useRef(null),y=o.rf(o.Pt(t,"createVariableDropdown"),"click",a.useCallback(()=>{1===e.length?v(e[0]):l()},[e,l])),[g,h]=a.useState(!1),f=a.useRef(null),v=e=>{let t=m.current?.getBoundingClientRect();t&&(f.current={initialPosition:new r.Mi(t.left,t.top),resolvedType:e},h(!0))},b=()=>{h(!1)};return a.createElement(a.Fragment,null,a.createElement("button",{ref:m,className:u.ZS,onClick:y},a.createElement(i.B,{svg:E.A})),g&&(g&&f.current?a.createElement(d.U,{initialPosition:f.current.initialPosition,initialWidth:d.i,resolvedType:f.current.resolvedType,onCreateVariable:b,onClose:b}):null),n&&m.current&&a.createElement(c.Cf,{arrowOffsetFromRectLeft:14,leanPadding:0,lean:"right",targetRect:m.current.getBoundingClientRect()},e.map(e=>a.createElement(_,{key:e,resolvedType:e,onClose:p,showCreationModal:v,recordingKey:t}))))}function _({resolvedType:e,onClose:t,showCreationModal:n,recordingKey:r}){let i=(0,m.F)(e),s=o.rf(o.Pt(r,"createVariableOption",i.name),"click",a.useCallback(()=>{n(e),t()},[t,e,n]));return a.createElement(l.c$,{className:u.Fs,onClick:s},a.createElement(p.i,{type:e,showTooltip:!1}),i.name)}}}]);

//# debugId=c0a1f735-e1b8-56c9-b285-4cd823a83629

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/bb4c9a08cfa2aba107d93eb3995bc83ccb1c2926/fullscreen_design-a7c872749a442ccf.min.js.map